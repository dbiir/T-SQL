CREATE SCHEMA rpt_tpch;
SET SEARCH_PATH to rpt_tpch;
CREATE TABLE heap_customer (
    c_custkey integer NOT NULL,
    c_name character varying(25) NOT NULL,
    c_address character varying(40) NOT NULL,
    c_nationkey integer NOT NULL,
    c_phone character(15) NOT NULL,
    c_acctbal numeric(15,2) NOT NULL,
    c_mktsegment character(10) NOT NULL,
    c_comment character varying(117) NOT NULL
)
WITH (appendonly=false) DISTRIBUTED REPLICATED;
CREATE TABLE heap_lineitem (
    l_orderkey bigint NOT NULL,
    l_partkey integer NOT NULL,
    l_suppkey integer NOT NULL,
    l_linenumber integer NOT NULL,
    l_quantity numeric(15,2) NOT NULL,
    l_extendedprice numeric(15,2) NOT NULL,
    l_discount numeric(15,2) NOT NULL,
    l_tax numeric(15,2) NOT NULL,
    l_returnflag character(1) NOT NULL,
    l_linestatus character(1) NOT NULL,
    l_shipdate date NOT NULL,
    l_commitdate date NOT NULL,
    l_receiptdate date NOT NULL,
    l_shipinstruct character(25) NOT NULL,
    l_shipmode character(10) NOT NULL,
    l_comment character varying(44) NOT NULL
)
WITH (appendonly=false) DISTRIBUTED BY (l_orderkey);
CREATE TABLE heap_nation (
    n_nationkey integer,
    n_name character(25),
    n_regionkey integer,
    n_comment character varying(152)
)
WITH (appendonly=false) DISTRIBUTED REPLICATED;
CREATE TABLE heap_orders (
    o_orderkey bigint NOT NULL,
    o_custkey integer NOT NULL,
    o_orderstatus character(1) NOT NULL,
    o_totalprice numeric(15,2) NOT NULL,
    o_orderdate date NOT NULL,
    o_orderpriority character(15) NOT NULL,
    o_clerk character(15) NOT NULL,
    o_shippriority integer NOT NULL,
    o_comment character varying(79) NOT NULL
)
WITH (appendonly=false) DISTRIBUTED BY (o_orderkey);
CREATE TABLE heap_part (
    p_partkey integer NOT NULL,
    p_name character varying(55) NOT NULL,
    p_mfgr character(25) NOT NULL,
    p_brand character(10) NOT NULL,
    p_type character varying(25) NOT NULL,
    p_size integer NOT NULL,
    p_container character(10) NOT NULL,
    p_retailprice numeric(15,2) NOT NULL,
    p_comment character varying(23) NOT NULL
)
WITH (appendonly=false) DISTRIBUTED BY (p_partkey);
CREATE TABLE heap_partsupp (
    ps_partkey integer NOT NULL,
    ps_suppkey integer NOT NULL,
    ps_availqty integer NOT NULL,
    ps_supplycost numeric(15,2) NOT NULL,
    ps_comment character varying(199) NOT NULL
)
WITH (appendonly=false) DISTRIBUTED BY (ps_partkey);
CREATE TABLE heap_region (
    r_regionkey integer NOT NULL,
    r_name character(25) NOT NULL,
    r_comment character varying(152)
)
WITH (appendonly=false) DISTRIBUTED REPLICATED;
CREATE TABLE heap_supplier (
    s_suppkey integer NOT NULL,
    s_name character(25) NOT NULL,
    s_address character varying(40) NOT NULL,
    s_nationkey integer NOT NULL,
    s_phone character(15) NOT NULL,
    s_acctbal numeric(15,2) NOT NULL,
    s_comment character varying(101) NOT NULL
)
WITH (appendonly=false) DISTRIBUTED REPLICATED;
\copy heap_customer (C_CUSTKEY,C_NAME,C_ADDRESS,C_NATIONKEY,C_PHONE,C_ACCTBAL,C_MKTSEGMENT,C_COMMENT) from '@abs_srcdir@/data/customer.csv' with delimiter '|';
\copy heap_lineitem ( L_ORDERKEY, L_PARTKEY, L_SUPPKEY,L_LINENUMBER,L_QUANTITY, L_EXTENDEDPRICE,L_DISCOUNT,L_TAX,L_RETURNFLAG,L_LINESTATUS,L_SHIPDATE,L_COMMITDATE,L_RECEIPTDATE,L_SHIPINSTRUCT,L_SHIPMODE,L_COMMENT) from '@abs_srcdir@/data/lineitem_small.csv' with delimiter '|';
\copy heap_lineitem ( L_ORDERKEY, L_PARTKEY, L_SUPPKEY,L_LINENUMBER,L_QUANTITY, L_EXTENDEDPRICE,L_DISCOUNT,L_TAX,L_RETURNFLAG,L_LINESTATUS,L_SHIPDATE,L_COMMITDATE,L_RECEIPTDATE,L_SHIPINSTRUCT,L_SHIPMODE,L_COMMENT) from '@abs_srcdir@/data/lineitem.csv' with delimiter '|'; 
\copy heap_nation (N_NATIONKEY ,N_NAME, N_REGIONKEY,N_COMMENT) from '@abs_srcdir@/data/nation.csv' with delimiter '|';
\copy heap_orders ( O_ORDERKEY,O_CUSTKEY,O_ORDERSTATUS,O_TOTALPRICE,O_ORDERDATE,O_ORDERPRIORITY,O_CLERK,O_SHIPPRIORITY,O_COMMENT) from '@abs_srcdir@/data/order_small.csv' with delimiter '|';
\copy heap_orders ( O_ORDERKEY,O_CUSTKEY,O_ORDERSTATUS,O_TOTALPRICE,O_ORDERDATE,O_ORDERPRIORITY,O_CLERK,O_SHIPPRIORITY,O_COMMENT) from '@abs_srcdir@/data/order.csv' with delimiter '|'; 
\copy heap_part (P_PARTKEY,P_NAME,P_MFGR,P_BRAND,P_TYPE,P_SIZE,P_CONTAINER,P_RETAILPRICE,P_COMMENT)from '@abs_srcdir@/data/part.csv' with delimiter '|'; 
\copy heap_partsupp (PS_PARTKEY,PS_SUPPKEY,PS_AVAILQTY,PS_SUPPLYCOST,PS_COMMENT ) from '@abs_srcdir@/data/partsupp.csv' with delimiter '|';
\copy heap_region ( R_REGIONKEY,R_NAME,R_COMMENT) from '@abs_srcdir@/data/region.csv' with delimiter '|';
\copy heap_supplier (S_SUPPKEY,S_NAME,S_ADDRESS,S_NATIONKEY,S_PHONE,S_ACCTBAL,S_COMMENT) from '@abs_srcdir@/data/supplier.csv' with delimiter '|';
CREATE TABLE ao_customer (
    c_custkey integer NOT NULL,
    c_name character varying(25) NOT NULL,
    c_address character varying(40) NOT NULL,
    c_nationkey integer NOT NULL,
    c_phone character(15) NOT NULL,
    c_acctbal numeric(15,2) NOT NULL,
    c_mktsegment character(10) NOT NULL,
    c_comment character varying(117) NOT NULL
)
WITH (appendonly=true) DISTRIBUTED REPLICATED;
CREATE TABLE ao_lineitem (
    l_orderkey bigint NOT NULL,
    l_partkey integer NOT NULL,
    l_suppkey integer NOT NULL,
    l_linenumber integer NOT NULL,
    l_quantity numeric(15,2) NOT NULL,
    l_extendedprice numeric(15,2) NOT NULL,
    l_discount numeric(15,2) NOT NULL,
    l_tax numeric(15,2) NOT NULL,
    l_returnflag character(1) NOT NULL,
    l_linestatus character(1) NOT NULL,
    l_shipdate date NOT NULL,
    l_commitdate date NOT NULL,
    l_receiptdate date NOT NULL,
    l_shipinstruct character(25) NOT NULL,
    l_shipmode character(10) NOT NULL,
    l_comment character varying(44) NOT NULL
)
WITH (appendonly=true) DISTRIBUTED BY (l_orderkey);
CREATE TABLE ao_nation (
    n_nationkey integer,
    n_name character(25),
    n_regionkey integer,
    n_comment character varying(152)
)
WITH (appendonly=false) DISTRIBUTED REPLICATED;
CREATE TABLE ao_orders (
    o_orderkey bigint NOT NULL,
    o_custkey integer NOT NULL,
    o_orderstatus character(1) NOT NULL,
    o_totalprice numeric(15,2) NOT NULL,
    o_orderdate date NOT NULL,
    o_orderpriority character(15) NOT NULL,
    o_clerk character(15) NOT NULL,
    o_shippriority integer NOT NULL,
    o_comment character varying(79) NOT NULL
)
WITH (appendonly=true) DISTRIBUTED BY (o_orderkey);
CREATE TABLE ao_part (
    p_partkey integer NOT NULL,
    p_name character varying(55) NOT NULL,
    p_mfgr character(25) NOT NULL,
    p_brand character(10) NOT NULL,
    p_type character varying(25) NOT NULL,
    p_size integer NOT NULL,
    p_container character(10) NOT NULL,
    p_retailprice numeric(15,2) NOT NULL,
    p_comment character varying(23) NOT NULL
)
WITH (appendonly=true) DISTRIBUTED BY (p_partkey);
CREATE TABLE ao_partsupp (
    ps_partkey integer NOT NULL,
    ps_suppkey integer NOT NULL,
    ps_availqty integer NOT NULL,
    ps_supplycost numeric(15,2) NOT NULL,
    ps_comment character varying(199) NOT NULL
)
WITH (appendonly=true) DISTRIBUTED REPLICATED;
CREATE TABLE ao_region (
    r_regionkey integer NOT NULL,
    r_name character(25) NOT NULL,
    r_comment character varying(152)
)
WITH (appendonly=true) DISTRIBUTED REPLICATED;
CREATE TABLE ao_supplier (
    s_suppkey integer NOT NULL,
    s_name character(25) NOT NULL,
    s_address character varying(40) NOT NULL,
    s_nationkey integer NOT NULL,
    s_phone character(15) NOT NULL,
    s_acctbal numeric(15,2) NOT NULL,
    s_comment character varying(101) NOT NULL
)
WITH (appendonly=true) DISTRIBUTED REPLICATED;
\copy ao_customer (C_CUSTKEY,C_NAME,C_ADDRESS,C_NATIONKEY,C_PHONE,C_ACCTBAL,C_MKTSEGMENT,C_COMMENT) from '@abs_srcdir@/data/customer.csv' with delimiter '|';
\copy ao_lineitem ( L_ORDERKEY, L_PARTKEY, L_SUPPKEY,L_LINENUMBER,L_QUANTITY, L_EXTENDEDPRICE,L_DISCOUNT,L_TAX,L_RETURNFLAG,L_LINESTATUS,L_SHIPDATE,L_COMMITDATE,L_RECEIPTDATE,L_SHIPINSTRUCT,L_SHIPMODE,L_COMMENT) from '@abs_srcdir@/data/lineitem_small.csv' with delimiter '|';
\copy ao_lineitem ( L_ORDERKEY, L_PARTKEY, L_SUPPKEY,L_LINENUMBER,L_QUANTITY, L_EXTENDEDPRICE,L_DISCOUNT,L_TAX,L_RETURNFLAG,L_LINESTATUS,L_SHIPDATE,L_COMMITDATE,L_RECEIPTDATE,L_SHIPINSTRUCT,L_SHIPMODE,L_COMMENT) from '@abs_srcdir@/data/lineitem.csv' with delimiter '|';
\copy ao_nation (N_NATIONKEY ,N_NAME, N_REGIONKEY,N_COMMENT) from '@abs_srcdir@/data/nation.csv' with delimiter '|';
\copy ao_orders ( O_ORDERKEY,O_CUSTKEY,O_ORDERSTATUS,O_TOTALPRICE,O_ORDERDATE,O_ORDERPRIORITY,O_CLERK,O_SHIPPRIORITY,O_COMMENT) from '@abs_srcdir@/data/order_small.csv' with delimiter '|';
\copy ao_orders ( O_ORDERKEY,O_CUSTKEY,O_ORDERSTATUS,O_TOTALPRICE,O_ORDERDATE,O_ORDERPRIORITY,O_CLERK,O_SHIPPRIORITY,O_COMMENT) from '@abs_srcdir@/data/order.csv' with delimiter '|';
\copy ao_part (P_PARTKEY,P_NAME,P_MFGR,P_BRAND,P_TYPE,P_SIZE,P_CONTAINER,P_RETAILPRICE,P_COMMENT)from '@abs_srcdir@/data/part.csv' with delimiter '|';
\copy ao_partsupp (PS_PARTKEY,PS_SUPPKEY,PS_AVAILQTY,PS_SUPPLYCOST,PS_COMMENT ) from '@abs_srcdir@/data/partsupp.csv' with delimiter '|';
\copy ao_region ( R_REGIONKEY,R_NAME,R_COMMENT) from '@abs_srcdir@/data/region.csv' with delimiter '|';
\copy ao_supplier (S_SUPPKEY,S_NAME,S_ADDRESS,S_NATIONKEY,S_PHONE,S_ACCTBAL,S_COMMENT) from '@abs_srcdir@/data/supplier.csv' with delimiter '|';
CREATE TABLE co_customer (
    c_custkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    c_name character varying(25) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    c_address character varying(40) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    c_nationkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    c_phone character(15) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    c_acctbal numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    c_mktsegment character(10) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    c_comment character varying(117) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0)
)
WITH (appendonly=true, orientation=column) DISTRIBUTED BY (c_custkey);
CREATE TABLE co_lineitem (
    l_orderkey bigint NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_partkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_suppkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_linenumber integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_quantity numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_extendedprice numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_discount numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_tax numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_returnflag character(1) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_linestatus character(1) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_shipdate date NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_commitdate date NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_receiptdate date NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_shipinstruct character(25) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_shipmode character(10) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    l_comment character varying(44) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0)
)
WITH (appendonly=true, orientation=column) DISTRIBUTED BY (l_orderkey);
CREATE TABLE co_nation (
    n_nationkey integer ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    n_name character(25) ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    n_regionkey integer ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    n_comment character varying(152) ENCODING (compresstype=none,blocksize=32768,compresslevel=0)
)
WITH (appendonly=true, orientation=column) DISTRIBUTED BY (n_nationkey);
CREATE TABLE co_orders (
    o_orderkey bigint NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    o_custkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    o_orderstatus character(1) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    o_totalprice numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    o_orderdate date NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    o_orderpriority character(15) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    o_clerk character(15) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    o_shippriority integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    o_comment character varying(79) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0)
)
WITH (appendonly=true, orientation=column) DISTRIBUTED BY (o_orderkey);
CREATE TABLE co_part (
    p_partkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    p_name character varying(55) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    p_mfgr character(25) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    p_brand character(10) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    p_type character varying(25) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    p_size integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    p_container character(10) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    p_retailprice numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    p_comment character varying(23) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0)
)
WITH (appendonly=true, orientation=column) DISTRIBUTED REPLICATED;
CREATE TABLE co_partsupp (
    ps_partkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    ps_suppkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    ps_availqty integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    ps_supplycost numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    ps_comment character varying(199) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0)
)
WITH (appendonly=true, orientation=column) DISTRIBUTED REPLICATED;
CREATE TABLE co_region (
    r_regionkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    r_name character(25) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    r_comment character varying(152) ENCODING (compresstype=none,blocksize=32768,compresslevel=0)
)
WITH (appendonly=true, orientation=column) DISTRIBUTED BY (r_regionkey);
CREATE TABLE co_supplier (
    s_suppkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    s_name character(25) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    s_address character varying(40) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    s_nationkey integer NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    s_phone character(15) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    s_acctbal numeric(15,2) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0),
    s_comment character varying(101) NOT NULL ENCODING (compresstype=none,blocksize=32768,compresslevel=0)
)
WITH (appendonly=true, orientation=column) DISTRIBUTED BY (s_suppkey);
\copy co_customer (C_CUSTKEY,C_NAME,C_ADDRESS,C_NATIONKEY,C_PHONE,C_ACCTBAL,C_MKTSEGMENT,C_COMMENT) from '@abs_srcdir@/data/customer.csv' with delimiter '|';
\copy co_lineitem ( L_ORDERKEY, L_PARTKEY, L_SUPPKEY,L_LINENUMBER,L_QUANTITY, L_EXTENDEDPRICE,L_DISCOUNT,L_TAX,L_RETURNFLAG,L_LINESTATUS,L_SHIPDATE,L_COMMITDATE,L_RECEIPTDATE,L_SHIPINSTRUCT,L_SHIPMODE,L_COMMENT) from '@abs_srcdir@/data/lineitem_small.csv' with delimiter '|';
\copy co_lineitem ( L_ORDERKEY, L_PARTKEY, L_SUPPKEY,L_LINENUMBER,L_QUANTITY, L_EXTENDEDPRICE,L_DISCOUNT,L_TAX,L_RETURNFLAG,L_LINESTATUS,L_SHIPDATE,L_COMMITDATE,L_RECEIPTDATE,L_SHIPINSTRUCT,L_SHIPMODE,L_COMMENT) from '@abs_srcdir@/data/lineitem.csv' with delimiter '|'; 
\copy co_nation (N_NATIONKEY ,N_NAME, N_REGIONKEY,N_COMMENT) from '@abs_srcdir@/data/nation.csv' with delimiter '|';
\copy co_orders ( O_ORDERKEY,O_CUSTKEY,O_ORDERSTATUS,O_TOTALPRICE,O_ORDERDATE,O_ORDERPRIORITY,O_CLERK,O_SHIPPRIORITY,O_COMMENT) from '@abs_srcdir@/data/order_small.csv' with delimiter '|';
\copy co_orders ( O_ORDERKEY,O_CUSTKEY,O_ORDERSTATUS,O_TOTALPRICE,O_ORDERDATE,O_ORDERPRIORITY,O_CLERK,O_SHIPPRIORITY,O_COMMENT) from '@abs_srcdir@/data/order.csv' with delimiter '|'; 
\copy co_part (P_PARTKEY,P_NAME,P_MFGR,P_BRAND,P_TYPE,P_SIZE,P_CONTAINER,P_RETAILPRICE,P_COMMENT) from '@abs_srcdir@/data/part.csv' with delimiter '|'; 
\copy co_partsupp (PS_PARTKEY,PS_SUPPKEY,PS_AVAILQTY,PS_SUPPLYCOST,PS_COMMENT ) from '@abs_srcdir@/data/partsupp.csv' with delimiter '|';
\copy co_region ( R_REGIONKEY,R_NAME,R_COMMENT) from '@abs_srcdir@/data/region.csv' with delimiter '|';
\copy co_supplier (S_SUPPKEY,S_NAME,S_ADDRESS,S_NATIONKEY,S_PHONE,S_ACCTBAL,S_COMMENT) from '@abs_srcdir@/data/supplier.csv' with delimiter '|';
select  'mpph1',
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	heap_lineitem
where
	l_shipdate <= date '1998-12-01' - interval '108 day'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
 ?column? | l_returnflag | l_linestatus |  sum_qty  | sum_base_price | sum_disc_price |    sum_charge     |       avg_qty       |     avg_price      |        avg_disc        | count_order 
----------+--------------+--------------+-----------+----------------+----------------+-------------------+---------------------+--------------------+------------------------+-------------
 mpph1    | A            | F            | 380456.00 |   532348211.65 | 505822441.4861 |  526165934.000839 | 25.5751546114546921 | 35785.709306937349 | 0.05008133906964237698 |       14876
 mpph1    | N            | F            |   8971.00 |    12384801.37 |  11798257.2080 |   12282485.056933 | 25.7787356321839080 | 35588.509683908046 | 0.04775862068965517241 |         348
 mpph1    | N            | O            | 733323.00 |  1028186527.78 | 977118238.4241 | 1016280268.835844 | 25.4466999791796794 | 35678.621964744257 | 0.04991255465334166146 |       28818
 mpph1    | R            | F            | 381449.00 |   534594445.35 | 507996454.4067 |  528524219.358903 | 25.5971681653469333 | 35874.006532680177 | 0.04982753992752650651 |       14902
(4 rows)

select  'mpph2',
	s.s_acctbal,
	s.s_name,
	n.n_name,
	p.p_partkey,
	p.p_mfgr,
	s.s_address,
	s.s_phone,
	s.s_comment 
from 
	heap_supplier s, 
	heap_partsupp ps, 
	heap_nation n, 
	heap_region r, 
	heap_part p, 
	(select p_partkey, min(ps_supplycost) as min_ps_cost 
		from 
			heap_part, 
			heap_partsupp , 	
			heap_supplier,
			heap_nation, 
			heap_region 
		where 
			p_partkey=ps_partkey 
			and s_suppkey = ps_suppkey 
			and s_nationkey = n_nationkey 
			and n_regionkey = r_regionkey 
			and r_name = 'EUROPE' 
		group by p_partkey ) g 
where 
	p.p_partkey = ps.ps_partkey 
	and g.p_partkey = p.p_partkey 
	and g. min_ps_cost = ps.ps_supplycost 
	and s.s_suppkey = ps.ps_suppkey 
	and p.p_size = 45 
	and p.p_type like '%NICKEL' 
	and s.s_nationkey = n.n_nationkey 
	and n.n_regionkey = r.r_regionkey 
	and r.r_name = 'EUROPE' 
order by 
	s.s_acctbal desc,
	n.n_name,
	s.s_name,
	p.p_partkey
LIMIT 100;
 ?column? | s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
----------+-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
 mpph2    |   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
 mpph2    |   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
 mpph2    |   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	heap_part,
	heap_supplier,
	heap_partsupp,
	heap_nation,
	heap_region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 45
	and p_type like '%NICKEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			heap_partsupp,
			heap_supplier,
			heap_nation,
			heap_region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
 s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select  'mpph3',
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	heap_customer,
	heap_orders,
	heap_lineitem
where
	c_mktsegment = 'MACHINERY'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < date '1995-03-15'
	and l_shipdate > date '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
 ?column? | l_orderkey |   revenue   | o_orderdate | o_shippriority 
----------+------------+-------------+-------------+----------------
 mpph3    |      12641 | 222127.6271 | 02-23-1995  |              0
 mpph3    |      39878 | 219714.3069 | 03-06-1995  |              0
 mpph3    |      34243 | 214308.7196 | 02-12-1995  |              0
 mpph3    |       7171 | 202398.1900 | 02-14-1995  |              0
 mpph3    |      55271 | 195237.8000 | 03-12-1995  |              0
 mpph3    |      50145 | 189500.1602 | 02-27-1995  |              0
 mpph3    |      12867 | 185769.1004 | 03-12-1995  |              0
 mpph3    |      12066 | 180776.3231 | 02-07-1995  |              0
 mpph3    |      41926 | 180459.9518 | 02-06-1995  |              0
 mpph3    |      46307 | 180383.2464 | 02-07-1995  |              0
(10 rows)

select  'mpph4',
        o_orderpriority,
        count(*) as order_count
from
        heap_orders
where
        o_orderdate >= date '1994-05-01'
        and o_orderdate < date '1994-05-01' + interval '3 month'
        and exists (
                select
                        *
                from
                        heap_lineitem
                where
                        l_orderkey = o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority;
 ?column? | o_orderpriority | order_count 
----------+-----------------+-------------
 mpph4    | 1-URGENT        |         108
 mpph4    | 2-HIGH          |         117
 mpph4    | 3-MEDIUM        |          95
 mpph4    | 4-NOT SPECIFIED |         111
 mpph4    | 5-LOW           |         116
(5 rows)

select  'mpph5',
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	heap_customer,
	heap_orders,
	heap_lineitem,
	heap_supplier,
	heap_nation,
	heap_region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and o_orderdate >= date '1997-01-01'
	and o_orderdate < date '1997-01-01' + interval '1 year'
group by
	n_name
order by
	revenue desc;
 ?column? |          n_name           |   revenue   
----------+---------------------------+-------------
 mpph5    | UNITED STATES             | 721432.9139
 mpph5    | CANADA                    | 451731.0802
 mpph5    | PERU                      | 317553.7203
 mpph5    | BRAZIL                    | 275951.7747
 mpph5    | ARGENTINA                 | 225713.4702
(5 rows)

select  'mpph6',
	sum(l_extendedprice * l_discount) as revenue
from
	heap_lineitem
where
	l_shipdate >= date '1996-01-01'
	and l_shipdate < date '1996-01-01' + interval '1 year'
	and l_discount between 0.04 - 0.01 and 0.04 + 0.01
	and l_quantity < 24;
 ?column? |   revenue   
----------+-------------
 mpph6    | 740117.7050
(1 row)

select  'mpph7',
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			heap_supplier,
			heap_lineitem,
			heap_orders,
			heap_customer,
			heap_nation n1,
			heap_nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'GERMANY')
				or (n1.n_name = 'GERMANY' and n2.n_name = 'MOZAMBIQUE')
			)
			and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
 ?column? |        supp_nation        |        cust_nation        | l_year |   revenue    
----------+---------------------------+---------------------------+--------+--------------
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1995 |  749611.6213
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1996 |  838743.2524
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1995 |  669933.3036
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1996 | 1084686.2375
(4 rows)

select  'mpph8',
	o_year,
	sum(case
		when nation = 'PERU' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			heap_part,
			heap_supplier,
			heap_lineitem,
			heap_orders,
			heap_customer,
			heap_nation n1,
			heap_nation n2,
			heap_region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'MEDIUM POLISHED TIN'
	) as all_nations
group by
	o_year
order by
	o_year;
 ?column? | o_year |         mkt_share          
----------+--------+----------------------------
 mpph8    |   1995 | 0.000000000000000000000000
 mpph8    |   1996 |     0.17380660267693394854
(2 rows)

select  'mpph9',
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			heap_part,
			heap_supplier,
			heap_lineitem,
			heap_partsupp,
			heap_orders,
			heap_nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%tan%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
 ?column? |          nation           | o_year | sum_profit  
----------+---------------------------+--------+-------------
 mpph9    | ALGERIA                   |   1998 | 203717.6183
 mpph9    | ALGERIA                   |   1997 | 277895.7940
 mpph9    | ALGERIA                   |   1996 | 285313.9627
 mpph9    | ALGERIA                   |   1995 | 309375.7934
 mpph9    | ALGERIA                   |   1994 | 288152.6449
 mpph9    | ALGERIA                   |   1993 | 321222.9401
 mpph9    | ALGERIA                   |   1992 | 436020.6807
 mpph9    | ARGENTINA                 |   1998 | 217919.0097
 mpph9    | ARGENTINA                 |   1997 |  47720.1989
 mpph9    | ARGENTINA                 |   1996 | 373086.6814
 mpph9    | ARGENTINA                 |   1995 | 256403.9057
 mpph9    | ARGENTINA                 |   1994 | 172411.8182
 mpph9    | ARGENTINA                 |   1993 | 414051.7103
 mpph9    | ARGENTINA                 |   1992 | 497745.7196
 mpph9    | BRAZIL                    |   1998 |   9402.1360
 mpph9    | BRAZIL                    |   1996 | 130680.4872
 mpph9    | BRAZIL                    |   1995 |  47629.8480
 mpph9    | BRAZIL                    |   1994 |  22440.1440
 mpph9    | BRAZIL                    |   1993 | 106237.4759
 mpph9    | BRAZIL                    |   1992 | 116994.4770
 mpph9    | CANADA                    |   1998 |  67660.5389
 mpph9    | CANADA                    |   1997 | 167179.5520
 mpph9    | CANADA                    |   1996 | 147802.3006
 mpph9    | CANADA                    |   1995 |  84817.9292
 mpph9    | CANADA                    |   1994 |  49027.1082
 mpph9    | CANADA                    |   1993 | 157886.0056
 mpph9    | CANADA                    |   1992 | 191231.3590
 mpph9    | CHINA                     |   1998 | 382876.9927
 mpph9    | CHINA                     |   1997 | 787527.2369
 mpph9    | CHINA                     |   1996 | 605901.5293
 mpph9    | CHINA                     |   1995 | 587705.6412
 mpph9    | CHINA                     |   1994 | 917527.5948
 mpph9    | CHINA                     |   1993 | 839365.4133
 mpph9    | CHINA                     |   1992 | 748324.7469
 mpph9    | EGYPT                     |   1998 | 220523.2078
 mpph9    | EGYPT                     |   1997 | 554962.2792
 mpph9    | EGYPT                     |   1996 | 526118.5876
 mpph9    | EGYPT                     |   1995 | 406448.9115
 mpph9    | EGYPT                     |   1994 | 404925.7193
 mpph9    | EGYPT                     |   1993 | 296691.1725
 mpph9    | EGYPT                     |   1992 | 449161.6055
 mpph9    | ETHIOPIA                  |   1998 | 178828.6942
 mpph9    | ETHIOPIA                  |   1997 | 322949.1543
 mpph9    | ETHIOPIA                  |   1996 | 179589.0062
 mpph9    | ETHIOPIA                  |   1995 | 215017.5362
 mpph9    | ETHIOPIA                  |   1994 | 509710.4645
 mpph9    | ETHIOPIA                  |   1993 | 251330.1758
 mpph9    | ETHIOPIA                  |   1992 | 225397.2384
 mpph9    | FRANCE                    |   1998 | 210901.9632
 mpph9    | FRANCE                    |   1997 | 234428.9324
 mpph9    | FRANCE                    |   1996 | 283026.6644
 mpph9    | FRANCE                    |   1995 | 428615.5897
 mpph9    | FRANCE                    |   1994 | 233410.4344
 mpph9    | FRANCE                    |   1993 | 420330.4447
 mpph9    | FRANCE                    |   1992 | 359496.0042
 mpph9    | GERMANY                   |   1998 | 229863.3768
 mpph9    | GERMANY                   |   1997 | 519160.2856
 mpph9    | GERMANY                   |   1996 | 533764.1221
 mpph9    | GERMANY                   |   1995 | 621744.7373
 mpph9    | GERMANY                   |   1994 | 340785.3795
 mpph9    | GERMANY                   |   1993 | 673651.1393
 mpph9    | GERMANY                   |   1992 | 524002.5977
 mpph9    | INDIA                     |   1998 | 334403.8655
 mpph9    | INDIA                     |   1997 | 156434.8865
 mpph9    | INDIA                     |   1996 | 265093.2063
 mpph9    | INDIA                     |   1995 | 137842.0462
 mpph9    | INDIA                     |   1994 | 262710.5074
 mpph9    | INDIA                     |   1993 | 328441.1285
 mpph9    | INDIA                     |   1992 | 199589.6727
 mpph9    | INDONESIA                 |   1998 | 155973.1013
 mpph9    | INDONESIA                 |   1997 | 316792.0784
 mpph9    | INDONESIA                 |   1996 | 422245.5263
 mpph9    | INDONESIA                 |   1995 | 235242.8814
 mpph9    | INDONESIA                 |   1994 | 326775.3396
 mpph9    | INDONESIA                 |   1993 | 327711.7699
 mpph9    | INDONESIA                 |   1992 | 243688.5923
 mpph9    | IRAN                      |   1998 |  27198.8568
 mpph9    | IRAN                      |   1997 | 174737.8001
 mpph9    | IRAN                      |   1996 |  50121.8822
 mpph9    | IRAN                      |   1995 |  70977.8022
 mpph9    | IRAN                      |   1994 | 104593.0442
 mpph9    | IRAN                      |   1993 |  25867.0544
 mpph9    | IRAN                      |   1992 |  82988.9337
 mpph9    | IRAQ                      |   1998 | 157348.1240
 mpph9    | IRAQ                      |   1997 | 227619.0410
 mpph9    | IRAQ                      |   1996 | 114431.2136
 mpph9    | IRAQ                      |   1995 |  83702.7028
 mpph9    | IRAQ                      |   1994 | 189246.3076
 mpph9    | IRAQ                      |   1993 | 172977.0040
 mpph9    | IRAQ                      |   1992 | 165679.6544
 mpph9    | JAPAN                     |   1998 | 301448.7416
 mpph9    | JAPAN                     |   1997 | 274224.7673
 mpph9    | JAPAN                     |   1996 | 365055.9942
 mpph9    | JAPAN                     |   1995 | 273486.9553
 mpph9    | JAPAN                     |   1994 | 306480.9939
 mpph9    | JAPAN                     |   1993 | 309841.9310
 mpph9    | JAPAN                     |   1992 | 257133.6723
 mpph9    | JORDAN                    |   1998 |  51101.6440
 mpph9    | JORDAN                    |   1996 |   6016.6285
 mpph9    | JORDAN                    |   1995 |  58278.1892
 mpph9    | JORDAN                    |   1994 |  59604.3204
 mpph9    | JORDAN                    |   1993 | 110544.8190
 mpph9    | KENYA                     |   1998 | 239097.5320
 mpph9    | KENYA                     |   1997 | 177292.9690
 mpph9    | KENYA                     |   1996 | 597636.7126
 mpph9    | KENYA                     |   1995 | 434837.8428
 mpph9    | KENYA                     |   1994 | 511118.7047
 mpph9    | KENYA                     |   1993 | 181482.4886
 mpph9    | KENYA                     |   1992 | 442814.6201
 mpph9    | MOROCCO                   |   1998 |  94153.7562
 mpph9    | MOROCCO                   |   1997 |   1952.7200
 mpph9    | MOROCCO                   |   1996 | 184609.4769
 mpph9    | MOROCCO                   |   1995 | 138773.7720
 mpph9    | MOROCCO                   |   1994 | 141735.9952
 mpph9    | MOROCCO                   |   1993 | 240971.4009
 mpph9    | MOROCCO                   |   1992 |  76485.6974
 mpph9    | MOZAMBIQUE                |   1998 | 315271.5330
 mpph9    | MOZAMBIQUE                |   1997 | 593511.8009
 mpph9    | MOZAMBIQUE                |   1996 | 463830.0035
 mpph9    | MOZAMBIQUE                |   1995 | 463982.1278
 mpph9    | MOZAMBIQUE                |   1994 | 402790.4493
 mpph9    | MOZAMBIQUE                |   1993 | 765203.5080
 mpph9    | MOZAMBIQUE                |   1992 | 552780.7126
 mpph9    | PERU                      |   1998 | 291043.9094
 mpph9    | PERU                      |   1997 | 332386.6526
 mpph9    | PERU                      |   1996 | 271308.8627
 mpph9    | PERU                      |   1995 | 136468.6570
 mpph9    | PERU                      |   1994 | 231696.8464
 mpph9    | PERU                      |   1993 | 319175.9000
 mpph9    | PERU                      |   1992 | 296178.1348
 mpph9    | ROMANIA                   |   1998 | 366693.1531
 mpph9    | ROMANIA                   |   1997 | 313915.6675
 mpph9    | ROMANIA                   |   1996 | 257449.7931
 mpph9    | ROMANIA                   |   1995 | 613689.1994
 mpph9    | ROMANIA                   |   1994 | 514683.8323
 mpph9    | ROMANIA                   |   1993 | 301818.9752
 mpph9    | ROMANIA                   |   1992 | 445559.9618
 mpph9    | RUSSIA                    |   1998 | 215635.7552
 mpph9    | RUSSIA                    |   1997 | 263377.9773
 mpph9    | RUSSIA                    |   1996 | 292798.2473
 mpph9    | RUSSIA                    |   1995 | 202559.9044
 mpph9    | RUSSIA                    |   1994 | 287175.8782
 mpph9    | RUSSIA                    |   1993 | 163995.8157
 mpph9    | RUSSIA                    |   1992 | 356477.2999
 mpph9    | SAUDI ARABIA              |   1998 |  22338.7375
 mpph9    | SAUDI ARABIA              |   1997 |  89352.2847
 mpph9    | SAUDI ARABIA              |   1996 | 172227.1252
 mpph9    | SAUDI ARABIA              |   1995 | 104670.1059
 mpph9    | SAUDI ARABIA              |   1994 |  39327.6690
 mpph9    | SAUDI ARABIA              |   1993 |  76176.8010
 mpph9    | SAUDI ARABIA              |   1992 |  71000.2760
 mpph9    | UNITED KINGDOM            |   1998 |  57011.9084
 mpph9    | UNITED KINGDOM            |   1997 |  86313.0141
 mpph9    | UNITED KINGDOM            |   1996 |  93430.0955
 mpph9    | UNITED KINGDOM            |   1995 | 105005.8744
 mpph9    | UNITED KINGDOM            |   1994 | 111953.2358
 mpph9    | UNITED KINGDOM            |   1993 | 161721.5622
 mpph9    | UNITED KINGDOM            |   1992 | 173519.0108
 mpph9    | UNITED STATES             |   1998 | 382856.8948
 mpph9    | UNITED STATES             |   1997 | 494438.3396
 mpph9    | UNITED STATES             |   1996 | 548337.7007
 mpph9    | UNITED STATES             |   1995 | 720764.4099
 mpph9    | UNITED STATES             |   1994 | 695834.7785
 mpph9    | UNITED STATES             |   1993 | 593012.3919
 mpph9    | UNITED STATES             |   1992 | 801814.0301
 mpph9    | VIETNAM                   |   1998 | 253199.9819
 mpph9    | VIETNAM                   |   1997 | 551578.3779
 mpph9    | VIETNAM                   |   1996 | 309940.0530
 mpph9    | VIETNAM                   |   1995 | 491467.2046
 mpph9    | VIETNAM                   |   1994 | 510626.2215
 mpph9    | VIETNAM                   |   1993 | 786734.2542
 mpph9    | VIETNAM                   |   1992 | 511062.6378
(172 rows)

select  'mpph10',
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	heap_customer,
	heap_orders,
	heap_lineitem,
	heap_nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1994-10-01'
	and o_orderdate < date '1994-10-01' + interval '3 month'
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
 ?column? | c_custkey |       c_name       |   revenue   | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                      c_comment                                                      
----------+-----------+--------------------+-------------+-----------+---------------------------+------------------------------------------+-----------------+---------------------------------------------------------------------------------------------------------------------
 mpph10   |       643 | Customer#000000643 | 379216.9236 |   5184.70 | ALGERIA                   | 9T 2avhfyF PQ                            | 10-978-597-2747 | fily along the quickly ironic ideas. final, final
 mpph10   |      1255 | Customer#000001255 | 348227.6139 |   6487.71 | KENYA                     | UC6I32JjBU62t4WgDe e2pDYbuM3VAt4MPM      | 24-359-633-2713 | s deposits sleep. blithely ironic dependencies wake. blithely even theodolites sleep. blithely 
 mpph10   |      1144 | Customer#000001144 | 344762.9152 |   4189.04 | ARGENTINA                 | DGLUWG9evYLNbYhOXVzqZ LdfIMVfBjDf        | 11-336-453-4489 |  ideas. even, regular excuses after the ironic requests cajole blithe
 mpph10   |       871 | Customer#000000871 | 336419.8098 |   -395.89 | SAUDI ARABIA              | KcLmBKitbx7NvU7bpu9clIyccxWG             | 30-933-714-8982 | ts. blithely silent courts doze. regular atta
 mpph10   |       421 | Customer#000000421 | 335198.8566 |   7073.17 | JORDAN                    | it3mUlkZAe9J8gmy                         | 23-918-228-2560 | lithely final deposits haggle furiously above the
 mpph10   |        61 | Customer#000000061 | 332777.6898 |   1536.24 | PERU                      | 9kndve4EAJxhg3veF BfXr7AqOsT39o gtqjaYE  | 27-626-559-8599 | egular packages shall have to impress along the 
 mpph10   |      1121 | Customer#000001121 | 320274.8995 |   3942.11 | SAUDI ARABIA              | o2uc3AHYz,m 3vYg8YxBwI0XuG               | 30-197-936-4724 | usly? final theodolites are carefully 
 mpph10   |       532 | Customer#000000532 | 296758.8028 |   1725.68 | MOROCCO                   | xwWO3lWjgVJTZwhnltyH6zj5ddkzgH8RbF       | 25-875-978-2232 | usly regular deposits kindle. quickly even depos
 mpph10   |       584 | Customer#000000584 | 286297.8180 |   8825.71 | MOROCCO                   | jebKvptmHtS9,YE1qOjl2AOw38P,8skngJZh     | 25-352-778-1041 | ages boost regular deposits. blithely stealthy depo
 mpph10   |       892 | Customer#000000892 | 284479.7745 |   4799.98 | INDONESIA                 | N KwiRAwIk6KL9WJ6vt0G                    | 19-589-784-1249 | ses are carefully. quickly regular theodolites cajole. carefully express accounts wake sly
 mpph10   |       169 | Customer#000000169 | 277234.4946 |   4483.83 | CHINA                     | NjhmHa7xrcjE                             | 28-362-499-3728 | fully unusual pinto beans. blithely express asymptotes lose carefully regular instructions? accounts b
 mpph10   |      1036 | Customer#000001036 | 270725.2873 |   1766.23 | INDIA                     | fxujgj8DOFO6oKrH                         | 18-791-577-7691 | ins sleep. slyly express platelets cajol
 mpph10   |       608 | Customer#000000608 | 268304.6758 |   2256.36 | MOZAMBIQUE                | luMI1JpfrrILCEeTgz8k98z                  | 26-767-193-8671 | ld packages. special requests along the accounts are after the carefully unusual deposits. blithely quiet excuses c
 mpph10   |       635 | Customer#000000635 | 261889.3542 |   8216.79 | BRAZIL                    | Ftqi0UYvzz56Ov,J6,ySp5WE4vJ2rtY          | 12-399-186-7550 | efully bold deposits doubt above the clos
 mpph10   |      1279 | Customer#000001279 | 261726.8460 |   7915.06 | KENYA                     | fkrzLacsqCnwUwgjjttKmY                   | 24-742-587-6985 | tes are. ideas above the carefully ironic d
 mpph10   |      1483 | Customer#000001483 | 256807.2933 |   4409.70 | GERMANY                   | ZjY1C b6cOnY3                            | 17-202-113-4814 | nts sleep around the carefully express theodolites. requests nag 
 mpph10   |        71 | Customer#000000071 | 251773.7061 |   -611.19 | GERMANY                   | TlGalgdXWBmMV,6agLyWYDyIz9MKzcY8gl,w6t1B | 17-710-812-5403 | g courts across the regular, final pinto beans are blithely pending ac
 mpph10   |       664 | Customer#000000664 | 244482.6132 |   8878.22 | MOROCCO                   | viRe1P6HiyL4LXpU7HPwu                    | 25-329-655-5068 | yly ironic requests cajole pending pla
 mpph10   |       883 | Customer#000000883 | 238622.1581 |    479.96 | CANADA                    | qVQ8rWNU5KZYDcS                          | 13-526-239-6950 | uctions are carefully across the regular, regular asymptote
 mpph10   |      1288 | Customer#000001288 | 236676.5999 |   6603.43 | CANADA                    | wQDTTCkSGxic2d66                         | 13-533-256-9320 | equests detect atop the ironic deposits. final requests according to the blithely sp
(20 rows)

select  'mpph11',
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	heap_partsupp,
	heap_supplier,
	heap_nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'ROMANIA'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				heap_partsupp,
				heap_supplier,
				heap_nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'ROMANIA'
		)
order by
	value desc;
 ?column? | ps_partkey |    value    
----------+------------+-------------
 mpph11   |        917 | 12344895.22
 mpph11   |        685 | 11950940.60
 mpph11   |       1081 | 10580686.59
 mpph11   |       1011 |  9608892.80
 mpph11   |        623 |  9343081.80
 mpph11   |        787 |  8569925.48
 mpph11   |       1185 |  8073895.00
 mpph11   |        367 |  7883443.69
 mpph11   |        109 |  7657641.60
 mpph11   |       1451 |  7613526.60
 mpph11   |       1899 |  7550881.80
 mpph11   |       1842 |  7505106.20
 mpph11   |        213 |  7479470.28
 mpph11   |        161 |  7398630.95
 mpph11   |       1416 |  7287490.02
 mpph11   |       1309 |  7213260.60
 mpph11   |        949 |  7197510.84
 mpph11   |       1323 |  7140115.71
 mpph11   |       1046 |  7046743.50
 mpph11   |         69 |  6970845.15
 mpph11   |       1581 |  6760133.10
 mpph11   |        862 |  6658234.84
 mpph11   |       1283 |  6609824.32
 mpph11   |       1277 |  6599037.12
 mpph11   |        828 |  6565785.62
 mpph11   |       1536 |  6561151.80
 mpph11   |        207 |  6537250.98
 mpph11   |       1085 |  6537104.27
 mpph11   |        751 |  6531660.40
 mpph11   |        360 |  6530297.41
 mpph11   |       1984 |  6495512.50
 mpph11   |        765 |  6460546.80
 mpph11   |       1917 |  6227301.68
 mpph11   |       1716 |  6116013.75
 mpph11   |        730 |  6100067.88
 mpph11   |        994 |  6032702.08
 mpph11   |       1144 |  6012205.92
 mpph11   |       1108 |  5914872.72
 mpph11   |       1950 |  5912352.20
 mpph11   |       1963 |  5873329.44
 mpph11   |         26 |  5867999.40
 mpph11   |        983 |  5846645.17
 mpph11   |       1808 |  5835183.38
 mpph11   |        504 |  5770344.51
 mpph11   |       1016 |  5718859.87
 mpph11   |       1494 |  5687809.60
 mpph11   |       1551 |  5668132.44
 mpph11   |        262 |  5625893.82
 mpph11   |        465 |  5537420.64
 mpph11   |        125 |  5533747.40
 mpph11   |       1972 |  5526059.28
 mpph11   |       1125 |  5514223.46
 mpph11   |        601 |  5513532.30
 mpph11   |        886 |  5450951.91
 mpph11   |        173 |  5409250.08
 mpph11   |       1752 |  5389034.04
 mpph11   |       1644 |  5387317.60
 mpph11   |        526 |  5350481.57
 mpph11   |        895 |  5346555.18
 mpph11   |       1576 |  5301661.68
 mpph11   |        692 |  5269557.57
 mpph11   |        951 |  5264770.02
 mpph11   |        861 |  5214617.22
 mpph11   |       1545 |  5196334.26
 mpph11   |       1356 |  5192649.28
 mpph11   |        789 |  5162645.80
 mpph11   |       1516 |  5107050.00
 mpph11   |       1616 |  5091834.00
 mpph11   |       1116 |  4992110.70
 mpph11   |        551 |  4982558.21
 mpph11   |       1887 |  4934262.24
 mpph11   |        885 |  4876658.57
 mpph11   |        116 |  4852263.60
 mpph11   |        251 |  4747015.56
 mpph11   |        394 |  4624460.10
 mpph11   |       1091 |  4589240.04
 mpph11   |        329 |  4558084.80
 mpph11   |        632 |  4494879.28
 mpph11   |       1485 |  4482428.50
 mpph11   |       1725 |  4340873.16
 mpph11   |        816 |  4326623.61
 mpph11   |        699 |  4310431.00
 mpph11   |        403 |  4283221.60
 mpph11   |       1768 |  4251602.98
 mpph11   |       1158 |  4229896.16
 mpph11   |        591 |  4216726.24
 mpph11   |       1248 |  4157093.60
 mpph11   |       1679 |  4156156.64
 mpph11   |        663 |  4142402.22
 mpph11   |       1719 |  4101486.48
 mpph11   |        395 |  4052997.76
 mpph11   |       1351 |  4045565.12
 mpph11   |        531 |  4042060.39
 mpph11   |       1951 |  4023967.36
 mpph11   |       1294 |  4009307.81
 mpph11   |        616 |  4004057.26
 mpph11   |        316 |  3986943.88
 mpph11   |       1928 |  3964898.76
 mpph11   |       1337 |  3951488.10
 mpph11   |       1851 |  3918641.34
 mpph11   |        521 |  3913058.16
 mpph11   |        883 |  3908087.82
 mpph11   |        961 |  3814756.38
 mpph11   |        366 |  3812257.88
 mpph11   |       1875 |  3800216.84
 mpph11   |        668 |  3772880.16
 mpph11   |        107 |  3756380.24
 mpph11   |       1061 |  3747377.84
 mpph11   |         16 |  3745783.12
 mpph11   |        294 |  3744033.70
 mpph11   |       1561 |  3711744.00
 mpph11   |       1574 |  3702071.64
 mpph11   |       1732 |  3695765.58
 mpph11   |        564 |  3680200.80
 mpph11   |       1371 |  3677874.16
 mpph11   |        516 |  3664770.45
 mpph11   |       1585 |  3641002.20
 mpph11   |        755 |  3635116.80
 mpph11   |        959 |  3620453.76
 mpph11   |        190 |  3559078.95
 mpph11   |       1194 |  3479709.09
 mpph11   |        416 |  3452131.59
 mpph11   |        333 |  3446486.38
 mpph11   |        377 |  3359789.30
 mpph11   |       1455 |  3342304.35
 mpph11   |        289 |  3270429.10
 mpph11   |        689 |  3260147.55
 mpph11   |       1919 |  3239067.00
 mpph11   |       1603 |  3194711.46
 mpph11   |       1438 |  3163393.12
 mpph11   |       1777 |  3107373.72
 mpph11   |         11 |  3035887.92
 mpph11   |       1340 |  3030301.09
 mpph11   |       1287 |  2985392.48
 mpph11   |       1347 |  2983078.12
 mpph11   |       1205 |  2971470.28
 mpph11   |        285 |  2967973.75
 mpph11   |        357 |  2967100.97
 mpph11   |        429 |  2962631.88
 mpph11   |         91 |  2951493.40
 mpph11   |       1161 |  2928475.76
 mpph11   |        914 |  2927894.16
 mpph11   |       1962 |  2925555.12
 mpph11   |       1483 |  2918425.86
 mpph11   |        561 |  2904720.39
 mpph11   |        258 |  2895651.20
 mpph11   |        194 |  2840047.13
 mpph11   |       1671 |  2818290.28
 mpph11   |       1477 |  2777362.76
 mpph11   |       1505 |  2766157.98
 mpph11   |        332 |  2741984.16
 mpph11   |        301 |  2737431.90
 mpph11   |        729 |  2706503.68
 mpph11   |        654 |  2662180.27
 mpph11   |        142 |  2647051.80
 mpph11   |        164 |  2643604.15
 mpph11   |       1662 |  2642551.92
 mpph11   |       1554 |  2639338.38
 mpph11   |        280 |  2631317.56
 mpph11   |       1541 |  2603175.96
 mpph11   |       1610 |  2463001.95
 mpph11   |        407 |  2460304.47
 mpph11   |        199 |  2442107.46
 mpph11   |        534 |  2420752.38
 mpph11   |       1313 |  2408870.75
 mpph11   |       1759 |  2387379.32
 mpph11   |       1115 |  2321227.26
 mpph11   |       1251 |  2311454.53
 mpph11   |       1285 |  2260852.77
 mpph11   |        159 |  2256004.65
 mpph11   |       1973 |  2243745.69
 mpph11   |       1638 |  2232762.96
 mpph11   |       1774 |  2217104.85
 mpph11   |        556 |  2195013.90
 mpph11   |       1694 |  2163305.16
 mpph11   |        819 |  2152055.50
 mpph11   |        992 |  2121582.28
 mpph11   |        785 |  2121133.75
 mpph11   |       1985 |  2069183.28
 mpph11   |        794 |  2059945.54
 mpph11   |        498 |  2055444.32
 mpph11   |       1385 |  2051890.11
 mpph11   |       1916 |  2032768.96
 mpph11   |        361 |  2017055.81
 mpph11   |         76 |  2012711.58
 mpph11   |       1873 |  2000792.40
 mpph11   |         94 |  1986087.48
 mpph11   |       1651 |  1980440.40
 mpph11   |       1059 |  1959087.04
 mpph11   |       1122 |  1942108.90
 mpph11   |        261 |  1928153.10
 mpph11   |       1861 |  1928114.84
 mpph11   |        461 |  1877992.32
 mpph11   |        224 |  1863852.24
 mpph11   |       1242 |  1851493.60
 mpph11   |       1634 |  1743866.22
 mpph11   |        761 |  1741958.65
 mpph11   |       1080 |  1741751.34
 mpph11   |        338 |  1724805.12
 mpph11   |        661 |  1709946.82
 mpph11   |        388 |  1696006.86
 mpph11   |        231 |  1655972.00
 mpph11   |        525 |  1633729.79
 mpph11   |       1906 |  1626282.30
 mpph11   |         85 |  1599847.56
 mpph11   |         60 |  1579401.77
 mpph11   |        926 |  1570368.78
 mpph11   |       1511 |  1569870.02
 mpph11   |       1113 |  1516263.20
 mpph11   |       1089 |  1477486.65
 mpph11   |       1422 |  1435904.00
 mpph11   |        458 |  1433040.45
 mpph11   |       1907 |  1421100.55
 mpph11   |        323 |  1419854.80
 mpph11   |        851 |  1400193.30
 mpph11   |         44 |  1353557.34
 mpph11   |        595 |  1350125.70
 mpph11   |       1822 |  1337990.67
 mpph11   |          1 |  1333528.04
 mpph11   |       1710 |  1331788.48
 mpph11   |         61 |  1322305.60
 mpph11   |        798 |  1313571.96
 mpph11   |        784 |  1309867.02
 mpph11   |        651 |  1307083.56
 mpph11   |       1468 |  1302397.20
 mpph11   |       1149 |  1289607.35
 mpph11   |       1179 |  1242058.40
 mpph11   |        818 |  1225981.68
 mpph11   |       1189 |  1204828.08
 mpph11   |        797 |  1181263.32
 mpph11   |       1375 |  1178128.60
 mpph11   |       1015 |  1164198.48
 mpph11   |       1994 |  1149222.96
 mpph11   |         66 |  1148101.44
 mpph11   |       1929 |  1131697.92
 mpph11   |        240 |  1126682.48
 mpph11   |       1378 |  1121941.05
 mpph11   |        762 |  1109467.26
 mpph11   |        586 |  1108200.58
 mpph11   |        716 |  1107627.42
 mpph11   |        752 |  1102384.63
 mpph11   |       1220 |  1083540.00
 mpph11   |       1675 |  1064600.76
 mpph11   |       1380 |  1020105.06
 mpph11   |        204 |  1014095.32
 mpph11   |       1214 |  1013602.86
 mpph11   |       1186 |  1006354.08
 mpph11   |        927 |  1003227.51
 mpph11   |       1473 |   997508.48
 mpph11   |       1701 |   994231.40
 mpph11   |        168 |   988803.90
 mpph11   |        852 |   977609.14
 mpph11   |        235 |   977200.14
 mpph11   |        501 |   961161.66
 mpph11   |       1620 |   950561.25
 mpph11   |       1709 |   927244.00
 mpph11   |       1565 |   921078.22
 mpph11   |        960 |   913060.80
 mpph11   |        385 |   910892.90
 mpph11   |       1434 |   905713.25
 mpph11   |        658 |   894649.92
 mpph11   |       1865 |   886024.01
 mpph11   |        487 |   883607.88
 mpph11   |       1279 |   877210.28
 mpph11   |       1211 |   875261.76
 mpph11   |        555 |   869246.77
 mpph11   |       1521 |   866284.81
 mpph11   |        427 |   839771.02
 mpph11   |       1628 |   832363.52
 mpph11   |        297 |   832286.88
 mpph11   |       1051 |   824164.90
 mpph11   |        185 |   794405.50
 mpph11   |       1412 |   793718.80
 mpph11   |        432 |   782403.82
 mpph11   |        216 |   776184.13
 mpph11   |       1056 |   772092.44
 mpph11   |        494 |   768524.43
 mpph11   |       1446 |   746482.32
 mpph11   |       1661 |   733795.56
 mpph11   |       1274 |   711073.48
 mpph11   |        451 |   676703.28
 mpph11   |       1685 |   661635.90
 mpph11   |       1143 |   660014.26
 mpph11   |       1318 |   655995.66
 mpph11   |       1531 |   649589.40
 mpph11   |       1514 |   627482.08
 mpph11   |       1612 |   626730.56
 mpph11   |        948 |   622068.66
 mpph11   |        571 |   619871.04
 mpph11   |       1767 |   614422.00
 mpph11   |        351 |   601983.45
 mpph11   |       1499 |   594599.22
 mpph11   |       1941 |   594211.48
 mpph11   |       1153 |   584114.56
 mpph11   |       1257 |   580110.85
 mpph11   |       1461 |   576845.88
 mpph11   |       1361 |   570409.02
 mpph11   |       1250 |   567963.36
 mpph11   |        422 |   530847.10
 mpph11   |       1653 |   525077.35
 mpph11   |       1669 |   513932.46
 mpph11   |       1596 |   505225.82
 mpph11   |        850 |   483358.05
 mpph11   |       1151 |   481433.04
 mpph11   |         86 |   471697.70
 mpph11   |        894 |   465151.80
 mpph11   |         19 |   464872.80
 mpph11   |        474 |   455889.28
 mpph11   |        493 |   455628.44
 mpph11   |        267 |   453340.80
 mpph11   |       1856 |   450086.28
 mpph11   |       1830 |   446553.54
 mpph11   |        456 |   439968.00
 mpph11   |        305 |   421891.68
 mpph11   |       1594 |   417994.09
 mpph11   |       1894 |   414577.35
 mpph11   |       1240 |   413718.76
 mpph11   |         35 |   398837.24
 mpph11   |       1180 |   391898.15
 mpph11   |       1794 |   355474.42
 mpph11   |       1024 |   319659.12
 mpph11   |        594 |   315583.24
 mpph11   |         10 |   314550.82
 mpph11   |       1953 |   314372.14
 mpph11   |       1261 |   312283.65
 mpph11   |       1832 |   308459.25
 mpph11   |       1785 |   300945.33
 mpph11   |        138 |   298832.01
 mpph11   |        753 |   297884.88
 mpph11   |       1790 |   277454.80
 mpph11   |        133 |   262568.64
 mpph11   |         51 |   260089.38
 mpph11   |        620 |   246511.60
 mpph11   |       1961 |   232870.27
 mpph11   |       1224 |   227429.47
 mpph11   |        183 |   225827.28
 mpph11   |       1735 |   219074.20
 mpph11   |       1816 |   218339.50
 mpph11   |       1743 |   217085.97
 mpph11   |        985 |   182239.20
 mpph11   |       1761 |   182100.00
 mpph11   |        464 |   179639.88
 mpph11   |        817 |   170795.52
 mpph11   |        485 |   170664.12
 mpph11   |       1818 |   161250.35
 mpph11   |        630 |   158427.72
 mpph11   |       1571 |   156406.05
 mpph11   |       1094 |   155577.60
 mpph11   |        436 |   147283.92
 mpph11   |        916 |   146788.80
 mpph11   |        310 |   145905.18
 mpph11   |       1751 |   140193.69
 mpph11   |        993 |   136907.25
 mpph11   |       1050 |   136152.30
 mpph11   |       1394 |   120166.11
 mpph11   |       1177 |   115967.72
 mpph11   |        151 |   110222.90
(357 rows)

select  'mpph12',
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	heap_orders,
	heap_lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('RAIL', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= date '1993-01-01'
	and l_receiptdate < date '1993-01-01' + interval '1 year'
group by
	l_shipmode
order by
	l_shipmode;
 ?column? | l_shipmode | high_line_count | low_line_count 
----------+------------+-----------------+----------------
 mpph12   | MAIL       |              41 |             99
 mpph12   | RAIL       |              54 |            102
(2 rows)

select  'mpph13',
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			heap_customer left outer join heap_orders on
				c_custkey = o_custkey
				and o_comment not like '%express%deposits%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;
 ?column? | c_count | custdist 
----------+---------+----------
 mpph13   |       0 |      500
 mpph13   |      11 |       66
 mpph13   |      10 |       64
 mpph13   |       8 |       63
 mpph13   |      12 |       61
 mpph13   |       9 |       60
 mpph13   |      20 |       58
 mpph13   |      13 |       58
 mpph13   |      14 |       53
 mpph13   |      15 |       48
 mpph13   |       7 |       47
 mpph13   |      18 |       43
 mpph13   |      17 |       40
 mpph13   |      21 |       38
 mpph13   |      16 |       38
 mpph13   |      19 |       36
 mpph13   |       6 |       35
 mpph13   |      22 |       34
 mpph13   |      24 |       32
 mpph13   |      23 |       30
 mpph13   |      25 |       22
 mpph13   |      26 |       19
 mpph13   |       5 |       13
 mpph13   |      27 |       10
 mpph13   |      28 |        9
 mpph13   |       4 |        7
 mpph13   |      32 |        4
 mpph13   |      30 |        4
 mpph13   |      29 |        3
 mpph13   |       3 |        2
 mpph13   |       2 |        2
 mpph13   |      31 |        1
(32 rows)

select  'mpph14',
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	heap_lineitem,
	heap_part
where
	l_partkey = p_partkey
	and l_shipdate >= date '1993-01-01'
	and l_shipdate < date '1993-01-01' + interval '1 month';
 ?column? |    promo_revenue    
----------+---------------------
 mpph14   | 11.5452471385458443
(1 row)

create view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		heap_lineitem
	where
		l_shipdate >= date '1993-01-01'
		and l_shipdate < date '1993-01-01' + interval '3 month'
	group by
		l_suppkey;
select  'mpph15',
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	heap_supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;
 ?column? | s_suppkey |          s_name           |          s_address          |     s_phone     | total_revenue 
----------+-----------+---------------------------+-----------------------------+-----------------+---------------
 mpph15   |        84 | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx | 34-869-118-7803 |  1134618.0543
(1 row)

drop view revenue0;
select 'mpph16',
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	heap_part, 
	heap_partsupp left join heap_supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
 ?column? |  p_brand   |          p_type           | p_size | supplier_cnt 
----------+------------+---------------------------+--------+--------------
 mpph16   | Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 mpph16   | Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 mpph16   | Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 mpph16   | Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 mpph16   | Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 mpph16   | Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 mpph16   | Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 mpph16   | Brand#11   | SMALL PLATED COPPER       |     46 |            4
 mpph16   | Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 mpph16   | Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 mpph16   | Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 mpph16   | Brand#11   | STANDARD PLATED TIN       |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 mpph16   | Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 mpph16   | Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 mpph16   | Brand#12   | LARGE PLATED COPPER       |     46 |            4
 mpph16   | Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 mpph16   | Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 mpph16   | Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 mpph16   | Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 mpph16   | Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 mpph16   | Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 mpph16   | Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 mpph16   | Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 mpph16   | Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 mpph16   | Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 mpph16   | Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 mpph16   | Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 mpph16   | Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 mpph16   | Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 mpph16   | Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 mpph16   | Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 mpph16   | Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 mpph16   | Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 mpph16   | Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 mpph16   | Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 mpph16   | Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 mpph16   | Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 mpph16   | Brand#15   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 mpph16   | Brand#15   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 mpph16   | Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 mpph16   | Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 mpph16   | Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 mpph16   | Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 mpph16   | Brand#21   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 mpph16   | Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 mpph16   | Brand#21   | PROMO PLATED COPPER       |     20 |            4
 mpph16   | Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 mpph16   | Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 mpph16   | Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 mpph16   | Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 mpph16   | Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 mpph16   | Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 mpph16   | Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 mpph16   | Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 mpph16   | Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 mpph16   | Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 mpph16   | Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 mpph16   | Brand#23   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 mpph16   | Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 mpph16   | Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 mpph16   | Brand#23   | SMALL PLATED TIN          |     42 |            4
 mpph16   | Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 mpph16   | Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 mpph16   | Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 mpph16   | Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 mpph16   | Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 mpph16   | Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 mpph16   | Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 mpph16   | Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 mpph16   | Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 mpph16   | Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 mpph16   | Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 mpph16   | Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 mpph16   | Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 mpph16   | Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 mpph16   | Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 mpph16   | Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 mpph16   | Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 mpph16   | Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 mpph16   | Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 mpph16   | Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 mpph16   | Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 mpph16   | Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 mpph16   | Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 mpph16   | Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 mpph16   | Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#32   | SMALL PLATED BRASS        |     31 |            4
 mpph16   | Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 mpph16   | Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 mpph16   | Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 mpph16   | Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 mpph16   | Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 mpph16   | Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 mpph16   | Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 mpph16   | Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 mpph16   | Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 mpph16   | Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 mpph16   | Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 mpph16   | Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 mpph16   | Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 mpph16   | Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 mpph16   | Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 mpph16   | Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 mpph16   | Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 mpph16   | Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 mpph16   | Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 mpph16   | Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 mpph16   | Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 mpph16   | Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 mpph16   | Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 mpph16   | Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#42   | PROMO POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     24 |            4
 mpph16   | Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 mpph16   | Brand#43   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#43   | LARGE PLATED TIN          |     24 |            4
 mpph16   | Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 mpph16   | Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 mpph16   | Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 mpph16   | Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 mpph16   | Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 mpph16   | Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 mpph16   | Brand#45   | LARGE PLATED STEEL        |     22 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#45   | SMALL PLATED COPPER       |     15 |            4
 mpph16   | Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 mpph16   | Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 mpph16   | Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 mpph16   | Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 mpph16   | Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 mpph16   | Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 mpph16   | Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 mpph16   | Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 mpph16   | Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 mpph16   | Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 mpph16   | Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 mpph16   | Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 mpph16   | Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 mpph16   | Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 mpph16   | Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#52   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 mpph16   | Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 mpph16   | Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 mpph16   | Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 mpph16   | Brand#53   | SMALL PLATED STEEL        |     31 |            4
 mpph16   | Brand#53   | SMALL POLISHED TIN        |     42 |            4
 mpph16   | Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 mpph16   | Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 mpph16   | Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 mpph16   | Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 mpph16   | Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 mpph16   | Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 mpph16   | Brand#54   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 mpph16   | Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 mpph16   | Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 mpph16   | Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 mpph16   | Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 mpph16   | Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 mpph16   | Brand#55   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 mpph16   | Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 mpph16   | Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 mpph16   | Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	heap_partsupp,
	heap_part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			heap_supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select 'mpph17',
      sum(l_extendedprice) / 7.0 as avg_yearly
from
      heap_lineitem,
      (
          select
              p_partkey as x_partkey,
              0.2 * avg(l_quantity) as x_avg_20
          from
              heap_part,
              heap_lineitem
          where
              p_partkey = l_partkey
              and p_brand = 'Brand#32'
              and p_container = 'JUMBO PACK'
          group by
              p_partkey
      ) x
where
      x_partkey = l_partkey
and l_quantity < x_avg_20;
 ?column? |      avg_yearly       
----------+-----------------------
 mpph17   | 1278.3700000000000000
(1 row)

select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	heap_lineitem,
	heap_part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#32'
	and p_container = 'JUMBO PACK'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			heap_lineitem
		where
			l_partkey = p_partkey
	);
      avg_yearly       
-----------------------
 1278.3700000000000000
(1 row)

select  'mpph18',
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	heap_customer,
	heap_orders,
	heap_lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			heap_lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 300
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
 ?column? |       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice |  sum   
----------+--------------------+-----------+------------+-------------+--------------+--------
 mpph18   | Customer#000000667 |       667 |      29158 | 10-21-1995  |    439687.23 | 305.00
 mpph18   | Customer#000000178 |       178 |       6882 | 04-09-1997  |    422359.65 | 303.00
(2 rows)

select  'mpph19',
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	heap_lineitem,
	heap_part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#53'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#21'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
 ?column? |  revenue   
----------+------------
 mpph19   | 10604.0448
(1 row)

select  'mpph20',
	s_name,
	s_address 
from 
	heap_supplier, 
	heap_nation 
where 
	s_suppkey in( 
		select 
			ps_suppkey 
		from 
			heap_partsupp, 
			( 
				select 
					sum(l_quantity) as qty_sum, l_partkey, l_suppkey 
				from 
					heap_lineitem 
				where 
					l_shipdate >= date '1996-01-01' 
					and l_shipdate < date '1996-01-01' + interval '1 year' 
				group by l_partkey, l_suppkey ) g 
		where 
			g.l_partkey = ps_partkey 
			and g.l_suppkey = ps_suppkey 
			and ps_availqty > 0.5 * g.qty_sum 
			and ps_partkey in ( select p_partkey from heap_part where p_name like 'medium%' ) 
		) 
	and s_nationkey = n_nationkey 
	and n_name = 'UNITED STATES'
order by 
	s_name;
 ?column? |          s_name           |                s_address                 
----------+---------------------------+------------------------------------------
 mpph20   | Supplier#000000010        | Saygah3gYWMp72i PY
 mpph20   | Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 mpph20   | Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 mpph20   | Supplier#000000049        | Nvq 6macF4GtJvz
 mpph20   | Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 mpph20   | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select
	s_name,
	s_address
from
	heap_supplier,
	heap_nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			heap_partsupp
		where
			ps_partkey in (
				select
					p_partkey
				from
					heap_part
				where
					p_name like 'medium%'
			)
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					heap_lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= date '1996-01-01'
					and l_shipdate < date '1996-01-01' + interval '1 year'
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
order by
	s_name;
          s_name           |                s_address                 
---------------------------+------------------------------------------
 Supplier#000000010        | Saygah3gYWMp72i PY
 Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 Supplier#000000049        | Nvq 6macF4GtJvz
 Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select  'mpph21',
	s_name, 
	count(distinct(l1.l_orderkey::text||l1.l_linenumber::text)) as numwait 
from 
	heap_supplier, 
	heap_orders, 
	heap_nation, 
	heap_lineitem l1 
		left join heap_lineitem l2 
			on (l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) 
		left join (
			select 
				l3.l_orderkey,
				l3.l_suppkey 
			from 
				heap_lineitem l3 
			where 
				l3.l_receiptdate > l3.l_commitdate) l4 
			on (l4.l_orderkey = l1.l_orderkey and l4.l_suppkey <> l1.l_suppkey) 
where 
	s_suppkey = l1.l_suppkey 
	and o_orderkey = l1.l_orderkey 
	and o_orderstatus = 'F' 
	and l1.l_receiptdate > l1.l_commitdate 
	and l2.l_orderkey is not null 
	and l4.l_orderkey is null 
	and s_nationkey = n_nationkey 
	and n_name = 'MOZAMBIQUE' 
group by 
	s_name 
order by 
	numwait desc, 
	s_name
LIMIT 100;
 ?column? |          s_name           | numwait 
----------+---------------------------+---------
 mpph21   | Supplier#000000056        |      18
 mpph21   | Supplier#000000073        |      13
 mpph21   | Supplier#000000018        |      12
 mpph21   | Supplier#000000058        |      10
 mpph21   | Supplier#000000030        |       9
 mpph21   | Supplier#000000093        |       9
 mpph21   | Supplier#000000031        |       6
(7 rows)

select  'mpph22',
	cntrycode, 
	count(*) as numcust, 
	sum(c_acctbal) as totacctbal 
from 
	( 
		select 
			substring(c_phone from 1 for 2) as cntrycode, 
			c_acctbal 
		from 
			heap_customer left join heap_orders 
				on c_custkey = o_custkey 
		where 
			substring(c_phone from 1 for 2) in 
				('11', '28', '21', '26', '19', '13', '22') 
			and c_acctbal > ( 
				select 
					avg(c_acctbal) 
				from 
					heap_customer 
				where 
					c_acctbal > 0.00 
					and substring(c_phone from 1 for 2) in 
						('11', '28', '21', '26', '19', '13', '22') 
			) 
			and o_custkey is null 
	) as custsale 
group by 
	cntrycode 
order by 
	cntrycode;
 ?column? | cntrycode | numcust | totacctbal 
----------+-----------+---------+------------
 mpph22   | 11        |      11 |   82845.34
 mpph22   | 13        |      10 |   75359.29
 mpph22   | 19        |      17 |  132118.07
 mpph22   | 21        |       9 |   73087.05
 mpph22   | 22        |       9 |   65544.55
 mpph22   | 26        |       6 |   47747.11
 mpph22   | 28        |      10 |   79310.33
(7 rows)

select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			heap_customer
		where
			substring(c_phone from 1 for 2) in
				('11', '28', '21', '26', '19', '13', '22')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					heap_customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('11', '28', '21', '26', '19', '13', '22')
			)
			and not exists (
				select
					*
				from
					heap_orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;
 cntrycode | numcust | totacctbal 
-----------+---------+------------
 11        |      11 |   82845.34
 13        |      10 |   75359.29
 19        |      17 |  132118.07
 21        |       9 |   73087.05
 22        |       9 |   65544.55
 26        |       6 |   47747.11
 28        |      10 |   79310.33
(7 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	heap_partsupp,
	heap_part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			heap_supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	heap_part, 
	heap_partsupp left join heap_supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select  'mpph1',
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	ao_lineitem
where
	l_shipdate <= date '1998-12-01' - interval '108 day'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
 ?column? | l_returnflag | l_linestatus |  sum_qty  | sum_base_price | sum_disc_price |    sum_charge     |       avg_qty       |     avg_price      |        avg_disc        | count_order 
----------+--------------+--------------+-----------+----------------+----------------+-------------------+---------------------+--------------------+------------------------+-------------
 mpph1    | A            | F            | 380456.00 |   532348211.65 | 505822441.4861 |  526165934.000839 | 25.5751546114546921 | 35785.709306937349 | 0.05008133906964237698 |       14876
 mpph1    | N            | F            |   8971.00 |    12384801.37 |  11798257.2080 |   12282485.056933 | 25.7787356321839080 | 35588.509683908046 | 0.04775862068965517241 |         348
 mpph1    | N            | O            | 733323.00 |  1028186527.78 | 977118238.4241 | 1016280268.835844 | 25.4466999791796794 | 35678.621964744257 | 0.04991255465334166146 |       28818
 mpph1    | R            | F            | 381449.00 |   534594445.35 | 507996454.4067 |  528524219.358903 | 25.5971681653469333 | 35874.006532680177 | 0.04982753992752650651 |       14902
(4 rows)

select  'mpph2',
	s.s_acctbal,
	s.s_name,
	n.n_name,
	p.p_partkey,
	p.p_mfgr,
	s.s_address,
	s.s_phone,
	s.s_comment 
from 
	ao_supplier s, 
	ao_partsupp ps, 
	ao_nation n, 
	ao_region r, 
	ao_part p, 
	(select p_partkey, min(ps_supplycost) as min_ps_cost 
		from 
			ao_part, 
			ao_partsupp , 	
			ao_supplier,
			ao_nation, 
			ao_region 
		where 
			p_partkey=ps_partkey 
			and s_suppkey = ps_suppkey 
			and s_nationkey = n_nationkey 
			and n_regionkey = r_regionkey 
			and r_name = 'EUROPE' 
		group by p_partkey ) g 
where 
	p.p_partkey = ps.ps_partkey 
	and g.p_partkey = p.p_partkey 
	and g. min_ps_cost = ps.ps_supplycost 
	and s.s_suppkey = ps.ps_suppkey 
	and p.p_size = 45 
	and p.p_type like '%NICKEL' 
	and s.s_nationkey = n.n_nationkey 
	and n.n_regionkey = r.r_regionkey 
	and r.r_name = 'EUROPE' 
order by 
	s.s_acctbal desc,
	n.n_name,
	s.s_name,
	p.p_partkey
LIMIT 100;
 ?column? | s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
----------+-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
 mpph2    |   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
 mpph2    |   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
 mpph2    |   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	ao_part,
	ao_supplier,
	ao_partsupp,
	ao_nation,
	ao_region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 45
	and p_type like '%NICKEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			ao_partsupp,
			ao_supplier,
			ao_nation,
			ao_region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
 s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select  'mpph3',
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	ao_customer,
	ao_orders,
	ao_lineitem
where
	c_mktsegment = 'MACHINERY'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < date '1995-03-15'
	and l_shipdate > date '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
 ?column? | l_orderkey |   revenue   | o_orderdate | o_shippriority 
----------+------------+-------------+-------------+----------------
 mpph3    |      12641 | 222127.6271 | 02-23-1995  |              0
 mpph3    |      39878 | 219714.3069 | 03-06-1995  |              0
 mpph3    |      34243 | 214308.7196 | 02-12-1995  |              0
 mpph3    |       7171 | 202398.1900 | 02-14-1995  |              0
 mpph3    |      55271 | 195237.8000 | 03-12-1995  |              0
 mpph3    |      50145 | 189500.1602 | 02-27-1995  |              0
 mpph3    |      12867 | 185769.1004 | 03-12-1995  |              0
 mpph3    |      12066 | 180776.3231 | 02-07-1995  |              0
 mpph3    |      41926 | 180459.9518 | 02-06-1995  |              0
 mpph3    |      46307 | 180383.2464 | 02-07-1995  |              0
(10 rows)

select  'mpph4',
        o_orderpriority,
        count(*) as order_count
from
        ao_orders
where
        o_orderdate >= date '1994-05-01'
        and o_orderdate < date '1994-05-01' + interval '3 month'
        and exists (
                select
                        *
                from
                        ao_lineitem
                where
                        l_orderkey = o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority;
 ?column? | o_orderpriority | order_count 
----------+-----------------+-------------
 mpph4    | 1-URGENT        |         108
 mpph4    | 2-HIGH          |         117
 mpph4    | 3-MEDIUM        |          95
 mpph4    | 4-NOT SPECIFIED |         111
 mpph4    | 5-LOW           |         116
(5 rows)

select  'mpph5',
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	ao_customer,
	ao_orders,
	ao_lineitem,
	ao_supplier,
	ao_nation,
	ao_region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and o_orderdate >= date '1997-01-01'
	and o_orderdate < date '1997-01-01' + interval '1 year'
group by
	n_name
order by
	revenue desc;
 ?column? |          n_name           |   revenue   
----------+---------------------------+-------------
 mpph5    | UNITED STATES             | 721432.9139
 mpph5    | CANADA                    | 451731.0802
 mpph5    | PERU                      | 317553.7203
 mpph5    | BRAZIL                    | 275951.7747
 mpph5    | ARGENTINA                 | 225713.4702
(5 rows)

select  'mpph6',
	sum(l_extendedprice * l_discount) as revenue
from
	ao_lineitem
where
	l_shipdate >= date '1996-01-01'
	and l_shipdate < date '1996-01-01' + interval '1 year'
	and l_discount between 0.04 - 0.01 and 0.04 + 0.01
	and l_quantity < 24;
 ?column? |   revenue   
----------+-------------
 mpph6    | 740117.7050
(1 row)

select  'mpph7',
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			ao_supplier,
			ao_lineitem,
			ao_orders,
			ao_customer,
			ao_nation n1,
			ao_nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'GERMANY')
				or (n1.n_name = 'GERMANY' and n2.n_name = 'MOZAMBIQUE')
			)
			and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
 ?column? |        supp_nation        |        cust_nation        | l_year |   revenue    
----------+---------------------------+---------------------------+--------+--------------
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1995 |  749611.6213
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1996 |  838743.2524
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1995 |  669933.3036
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1996 | 1084686.2375
(4 rows)

select  'mpph8',
	o_year,
	sum(case
		when nation = 'PERU' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			ao_part,
			ao_supplier,
			ao_lineitem,
			ao_orders,
			ao_customer,
			ao_nation n1,
			ao_nation n2,
			ao_region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'MEDIUM POLISHED TIN'
	) as all_nations
group by
	o_year
order by
	o_year;
 ?column? | o_year |         mkt_share          
----------+--------+----------------------------
 mpph8    |   1995 | 0.000000000000000000000000
 mpph8    |   1996 |     0.17380660267693394854
(2 rows)

select  'mpph9',
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			ao_part,
			ao_supplier,
			ao_lineitem,
			ao_partsupp,
			ao_orders,
			ao_nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%tan%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
 ?column? |          nation           | o_year | sum_profit  
----------+---------------------------+--------+-------------
 mpph9    | ALGERIA                   |   1998 | 203717.6183
 mpph9    | ALGERIA                   |   1997 | 277895.7940
 mpph9    | ALGERIA                   |   1996 | 285313.9627
 mpph9    | ALGERIA                   |   1995 | 309375.7934
 mpph9    | ALGERIA                   |   1994 | 288152.6449
 mpph9    | ALGERIA                   |   1993 | 321222.9401
 mpph9    | ALGERIA                   |   1992 | 436020.6807
 mpph9    | ARGENTINA                 |   1998 | 217919.0097
 mpph9    | ARGENTINA                 |   1997 |  47720.1989
 mpph9    | ARGENTINA                 |   1996 | 373086.6814
 mpph9    | ARGENTINA                 |   1995 | 256403.9057
 mpph9    | ARGENTINA                 |   1994 | 172411.8182
 mpph9    | ARGENTINA                 |   1993 | 414051.7103
 mpph9    | ARGENTINA                 |   1992 | 497745.7196
 mpph9    | BRAZIL                    |   1998 |   9402.1360
 mpph9    | BRAZIL                    |   1996 | 130680.4872
 mpph9    | BRAZIL                    |   1995 |  47629.8480
 mpph9    | BRAZIL                    |   1994 |  22440.1440
 mpph9    | BRAZIL                    |   1993 | 106237.4759
 mpph9    | BRAZIL                    |   1992 | 116994.4770
 mpph9    | CANADA                    |   1998 |  67660.5389
 mpph9    | CANADA                    |   1997 | 167179.5520
 mpph9    | CANADA                    |   1996 | 147802.3006
 mpph9    | CANADA                    |   1995 |  84817.9292
 mpph9    | CANADA                    |   1994 |  49027.1082
 mpph9    | CANADA                    |   1993 | 157886.0056
 mpph9    | CANADA                    |   1992 | 191231.3590
 mpph9    | CHINA                     |   1998 | 382876.9927
 mpph9    | CHINA                     |   1997 | 787527.2369
 mpph9    | CHINA                     |   1996 | 605901.5293
 mpph9    | CHINA                     |   1995 | 587705.6412
 mpph9    | CHINA                     |   1994 | 917527.5948
 mpph9    | CHINA                     |   1993 | 839365.4133
 mpph9    | CHINA                     |   1992 | 748324.7469
 mpph9    | EGYPT                     |   1998 | 220523.2078
 mpph9    | EGYPT                     |   1997 | 554962.2792
 mpph9    | EGYPT                     |   1996 | 526118.5876
 mpph9    | EGYPT                     |   1995 | 406448.9115
 mpph9    | EGYPT                     |   1994 | 404925.7193
 mpph9    | EGYPT                     |   1993 | 296691.1725
 mpph9    | EGYPT                     |   1992 | 449161.6055
 mpph9    | ETHIOPIA                  |   1998 | 178828.6942
 mpph9    | ETHIOPIA                  |   1997 | 322949.1543
 mpph9    | ETHIOPIA                  |   1996 | 179589.0062
 mpph9    | ETHIOPIA                  |   1995 | 215017.5362
 mpph9    | ETHIOPIA                  |   1994 | 509710.4645
 mpph9    | ETHIOPIA                  |   1993 | 251330.1758
 mpph9    | ETHIOPIA                  |   1992 | 225397.2384
 mpph9    | FRANCE                    |   1998 | 210901.9632
 mpph9    | FRANCE                    |   1997 | 234428.9324
 mpph9    | FRANCE                    |   1996 | 283026.6644
 mpph9    | FRANCE                    |   1995 | 428615.5897
 mpph9    | FRANCE                    |   1994 | 233410.4344
 mpph9    | FRANCE                    |   1993 | 420330.4447
 mpph9    | FRANCE                    |   1992 | 359496.0042
 mpph9    | GERMANY                   |   1998 | 229863.3768
 mpph9    | GERMANY                   |   1997 | 519160.2856
 mpph9    | GERMANY                   |   1996 | 533764.1221
 mpph9    | GERMANY                   |   1995 | 621744.7373
 mpph9    | GERMANY                   |   1994 | 340785.3795
 mpph9    | GERMANY                   |   1993 | 673651.1393
 mpph9    | GERMANY                   |   1992 | 524002.5977
 mpph9    | INDIA                     |   1998 | 334403.8655
 mpph9    | INDIA                     |   1997 | 156434.8865
 mpph9    | INDIA                     |   1996 | 265093.2063
 mpph9    | INDIA                     |   1995 | 137842.0462
 mpph9    | INDIA                     |   1994 | 262710.5074
 mpph9    | INDIA                     |   1993 | 328441.1285
 mpph9    | INDIA                     |   1992 | 199589.6727
 mpph9    | INDONESIA                 |   1998 | 155973.1013
 mpph9    | INDONESIA                 |   1997 | 316792.0784
 mpph9    | INDONESIA                 |   1996 | 422245.5263
 mpph9    | INDONESIA                 |   1995 | 235242.8814
 mpph9    | INDONESIA                 |   1994 | 326775.3396
 mpph9    | INDONESIA                 |   1993 | 327711.7699
 mpph9    | INDONESIA                 |   1992 | 243688.5923
 mpph9    | IRAN                      |   1998 |  27198.8568
 mpph9    | IRAN                      |   1997 | 174737.8001
 mpph9    | IRAN                      |   1996 |  50121.8822
 mpph9    | IRAN                      |   1995 |  70977.8022
 mpph9    | IRAN                      |   1994 | 104593.0442
 mpph9    | IRAN                      |   1993 |  25867.0544
 mpph9    | IRAN                      |   1992 |  82988.9337
 mpph9    | IRAQ                      |   1998 | 157348.1240
 mpph9    | IRAQ                      |   1997 | 227619.0410
 mpph9    | IRAQ                      |   1996 | 114431.2136
 mpph9    | IRAQ                      |   1995 |  83702.7028
 mpph9    | IRAQ                      |   1994 | 189246.3076
 mpph9    | IRAQ                      |   1993 | 172977.0040
 mpph9    | IRAQ                      |   1992 | 165679.6544
 mpph9    | JAPAN                     |   1998 | 301448.7416
 mpph9    | JAPAN                     |   1997 | 274224.7673
 mpph9    | JAPAN                     |   1996 | 365055.9942
 mpph9    | JAPAN                     |   1995 | 273486.9553
 mpph9    | JAPAN                     |   1994 | 306480.9939
 mpph9    | JAPAN                     |   1993 | 309841.9310
 mpph9    | JAPAN                     |   1992 | 257133.6723
 mpph9    | JORDAN                    |   1998 |  51101.6440
 mpph9    | JORDAN                    |   1996 |   6016.6285
 mpph9    | JORDAN                    |   1995 |  58278.1892
 mpph9    | JORDAN                    |   1994 |  59604.3204
 mpph9    | JORDAN                    |   1993 | 110544.8190
 mpph9    | KENYA                     |   1998 | 239097.5320
 mpph9    | KENYA                     |   1997 | 177292.9690
 mpph9    | KENYA                     |   1996 | 597636.7126
 mpph9    | KENYA                     |   1995 | 434837.8428
 mpph9    | KENYA                     |   1994 | 511118.7047
 mpph9    | KENYA                     |   1993 | 181482.4886
 mpph9    | KENYA                     |   1992 | 442814.6201
 mpph9    | MOROCCO                   |   1998 |  94153.7562
 mpph9    | MOROCCO                   |   1997 |   1952.7200
 mpph9    | MOROCCO                   |   1996 | 184609.4769
 mpph9    | MOROCCO                   |   1995 | 138773.7720
 mpph9    | MOROCCO                   |   1994 | 141735.9952
 mpph9    | MOROCCO                   |   1993 | 240971.4009
 mpph9    | MOROCCO                   |   1992 |  76485.6974
 mpph9    | MOZAMBIQUE                |   1998 | 315271.5330
 mpph9    | MOZAMBIQUE                |   1997 | 593511.8009
 mpph9    | MOZAMBIQUE                |   1996 | 463830.0035
 mpph9    | MOZAMBIQUE                |   1995 | 463982.1278
 mpph9    | MOZAMBIQUE                |   1994 | 402790.4493
 mpph9    | MOZAMBIQUE                |   1993 | 765203.5080
 mpph9    | MOZAMBIQUE                |   1992 | 552780.7126
 mpph9    | PERU                      |   1998 | 291043.9094
 mpph9    | PERU                      |   1997 | 332386.6526
 mpph9    | PERU                      |   1996 | 271308.8627
 mpph9    | PERU                      |   1995 | 136468.6570
 mpph9    | PERU                      |   1994 | 231696.8464
 mpph9    | PERU                      |   1993 | 319175.9000
 mpph9    | PERU                      |   1992 | 296178.1348
 mpph9    | ROMANIA                   |   1998 | 366693.1531
 mpph9    | ROMANIA                   |   1997 | 313915.6675
 mpph9    | ROMANIA                   |   1996 | 257449.7931
 mpph9    | ROMANIA                   |   1995 | 613689.1994
 mpph9    | ROMANIA                   |   1994 | 514683.8323
 mpph9    | ROMANIA                   |   1993 | 301818.9752
 mpph9    | ROMANIA                   |   1992 | 445559.9618
 mpph9    | RUSSIA                    |   1998 | 215635.7552
 mpph9    | RUSSIA                    |   1997 | 263377.9773
 mpph9    | RUSSIA                    |   1996 | 292798.2473
 mpph9    | RUSSIA                    |   1995 | 202559.9044
 mpph9    | RUSSIA                    |   1994 | 287175.8782
 mpph9    | RUSSIA                    |   1993 | 163995.8157
 mpph9    | RUSSIA                    |   1992 | 356477.2999
 mpph9    | SAUDI ARABIA              |   1998 |  22338.7375
 mpph9    | SAUDI ARABIA              |   1997 |  89352.2847
 mpph9    | SAUDI ARABIA              |   1996 | 172227.1252
 mpph9    | SAUDI ARABIA              |   1995 | 104670.1059
 mpph9    | SAUDI ARABIA              |   1994 |  39327.6690
 mpph9    | SAUDI ARABIA              |   1993 |  76176.8010
 mpph9    | SAUDI ARABIA              |   1992 |  71000.2760
 mpph9    | UNITED KINGDOM            |   1998 |  57011.9084
 mpph9    | UNITED KINGDOM            |   1997 |  86313.0141
 mpph9    | UNITED KINGDOM            |   1996 |  93430.0955
 mpph9    | UNITED KINGDOM            |   1995 | 105005.8744
 mpph9    | UNITED KINGDOM            |   1994 | 111953.2358
 mpph9    | UNITED KINGDOM            |   1993 | 161721.5622
 mpph9    | UNITED KINGDOM            |   1992 | 173519.0108
 mpph9    | UNITED STATES             |   1998 | 382856.8948
 mpph9    | UNITED STATES             |   1997 | 494438.3396
 mpph9    | UNITED STATES             |   1996 | 548337.7007
 mpph9    | UNITED STATES             |   1995 | 720764.4099
 mpph9    | UNITED STATES             |   1994 | 695834.7785
 mpph9    | UNITED STATES             |   1993 | 593012.3919
 mpph9    | UNITED STATES             |   1992 | 801814.0301
 mpph9    | VIETNAM                   |   1998 | 253199.9819
 mpph9    | VIETNAM                   |   1997 | 551578.3779
 mpph9    | VIETNAM                   |   1996 | 309940.0530
 mpph9    | VIETNAM                   |   1995 | 491467.2046
 mpph9    | VIETNAM                   |   1994 | 510626.2215
 mpph9    | VIETNAM                   |   1993 | 786734.2542
 mpph9    | VIETNAM                   |   1992 | 511062.6378
(172 rows)

select  'mpph10',
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	ao_customer,
	ao_orders,
	ao_lineitem,
	ao_nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1994-10-01'
	and o_orderdate < date '1994-10-01' + interval '3 month'
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
 ?column? | c_custkey |       c_name       |   revenue   | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                      c_comment                                                      
----------+-----------+--------------------+-------------+-----------+---------------------------+------------------------------------------+-----------------+---------------------------------------------------------------------------------------------------------------------
 mpph10   |       643 | Customer#000000643 | 379216.9236 |   5184.70 | ALGERIA                   | 9T 2avhfyF PQ                            | 10-978-597-2747 | fily along the quickly ironic ideas. final, final
 mpph10   |      1255 | Customer#000001255 | 348227.6139 |   6487.71 | KENYA                     | UC6I32JjBU62t4WgDe e2pDYbuM3VAt4MPM      | 24-359-633-2713 | s deposits sleep. blithely ironic dependencies wake. blithely even theodolites sleep. blithely 
 mpph10   |      1144 | Customer#000001144 | 344762.9152 |   4189.04 | ARGENTINA                 | DGLUWG9evYLNbYhOXVzqZ LdfIMVfBjDf        | 11-336-453-4489 |  ideas. even, regular excuses after the ironic requests cajole blithe
 mpph10   |       871 | Customer#000000871 | 336419.8098 |   -395.89 | SAUDI ARABIA              | KcLmBKitbx7NvU7bpu9clIyccxWG             | 30-933-714-8982 | ts. blithely silent courts doze. regular atta
 mpph10   |       421 | Customer#000000421 | 335198.8566 |   7073.17 | JORDAN                    | it3mUlkZAe9J8gmy                         | 23-918-228-2560 | lithely final deposits haggle furiously above the
 mpph10   |        61 | Customer#000000061 | 332777.6898 |   1536.24 | PERU                      | 9kndve4EAJxhg3veF BfXr7AqOsT39o gtqjaYE  | 27-626-559-8599 | egular packages shall have to impress along the 
 mpph10   |      1121 | Customer#000001121 | 320274.8995 |   3942.11 | SAUDI ARABIA              | o2uc3AHYz,m 3vYg8YxBwI0XuG               | 30-197-936-4724 | usly? final theodolites are carefully 
 mpph10   |       532 | Customer#000000532 | 296758.8028 |   1725.68 | MOROCCO                   | xwWO3lWjgVJTZwhnltyH6zj5ddkzgH8RbF       | 25-875-978-2232 | usly regular deposits kindle. quickly even depos
 mpph10   |       584 | Customer#000000584 | 286297.8180 |   8825.71 | MOROCCO                   | jebKvptmHtS9,YE1qOjl2AOw38P,8skngJZh     | 25-352-778-1041 | ages boost regular deposits. blithely stealthy depo
 mpph10   |       892 | Customer#000000892 | 284479.7745 |   4799.98 | INDONESIA                 | N KwiRAwIk6KL9WJ6vt0G                    | 19-589-784-1249 | ses are carefully. quickly regular theodolites cajole. carefully express accounts wake sly
 mpph10   |       169 | Customer#000000169 | 277234.4946 |   4483.83 | CHINA                     | NjhmHa7xrcjE                             | 28-362-499-3728 | fully unusual pinto beans. blithely express asymptotes lose carefully regular instructions? accounts b
 mpph10   |      1036 | Customer#000001036 | 270725.2873 |   1766.23 | INDIA                     | fxujgj8DOFO6oKrH                         | 18-791-577-7691 | ins sleep. slyly express platelets cajol
 mpph10   |       608 | Customer#000000608 | 268304.6758 |   2256.36 | MOZAMBIQUE                | luMI1JpfrrILCEeTgz8k98z                  | 26-767-193-8671 | ld packages. special requests along the accounts are after the carefully unusual deposits. blithely quiet excuses c
 mpph10   |       635 | Customer#000000635 | 261889.3542 |   8216.79 | BRAZIL                    | Ftqi0UYvzz56Ov,J6,ySp5WE4vJ2rtY          | 12-399-186-7550 | efully bold deposits doubt above the clos
 mpph10   |      1279 | Customer#000001279 | 261726.8460 |   7915.06 | KENYA                     | fkrzLacsqCnwUwgjjttKmY                   | 24-742-587-6985 | tes are. ideas above the carefully ironic d
 mpph10   |      1483 | Customer#000001483 | 256807.2933 |   4409.70 | GERMANY                   | ZjY1C b6cOnY3                            | 17-202-113-4814 | nts sleep around the carefully express theodolites. requests nag 
 mpph10   |        71 | Customer#000000071 | 251773.7061 |   -611.19 | GERMANY                   | TlGalgdXWBmMV,6agLyWYDyIz9MKzcY8gl,w6t1B | 17-710-812-5403 | g courts across the regular, final pinto beans are blithely pending ac
 mpph10   |       664 | Customer#000000664 | 244482.6132 |   8878.22 | MOROCCO                   | viRe1P6HiyL4LXpU7HPwu                    | 25-329-655-5068 | yly ironic requests cajole pending pla
 mpph10   |       883 | Customer#000000883 | 238622.1581 |    479.96 | CANADA                    | qVQ8rWNU5KZYDcS                          | 13-526-239-6950 | uctions are carefully across the regular, regular asymptote
 mpph10   |      1288 | Customer#000001288 | 236676.5999 |   6603.43 | CANADA                    | wQDTTCkSGxic2d66                         | 13-533-256-9320 | equests detect atop the ironic deposits. final requests according to the blithely sp
(20 rows)

select  'mpph11',
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	ao_partsupp,
	ao_supplier,
	ao_nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'ROMANIA'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				ao_partsupp,
				ao_supplier,
				ao_nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'ROMANIA'
		)
order by
	value desc;
 ?column? | ps_partkey |    value    
----------+------------+-------------
 mpph11   |        917 | 12344895.22
 mpph11   |        685 | 11950940.60
 mpph11   |       1081 | 10580686.59
 mpph11   |       1011 |  9608892.80
 mpph11   |        623 |  9343081.80
 mpph11   |        787 |  8569925.48
 mpph11   |       1185 |  8073895.00
 mpph11   |        367 |  7883443.69
 mpph11   |        109 |  7657641.60
 mpph11   |       1451 |  7613526.60
 mpph11   |       1899 |  7550881.80
 mpph11   |       1842 |  7505106.20
 mpph11   |        213 |  7479470.28
 mpph11   |        161 |  7398630.95
 mpph11   |       1416 |  7287490.02
 mpph11   |       1309 |  7213260.60
 mpph11   |        949 |  7197510.84
 mpph11   |       1323 |  7140115.71
 mpph11   |       1046 |  7046743.50
 mpph11   |         69 |  6970845.15
 mpph11   |       1581 |  6760133.10
 mpph11   |        862 |  6658234.84
 mpph11   |       1283 |  6609824.32
 mpph11   |       1277 |  6599037.12
 mpph11   |        828 |  6565785.62
 mpph11   |       1536 |  6561151.80
 mpph11   |        207 |  6537250.98
 mpph11   |       1085 |  6537104.27
 mpph11   |        751 |  6531660.40
 mpph11   |        360 |  6530297.41
 mpph11   |       1984 |  6495512.50
 mpph11   |        765 |  6460546.80
 mpph11   |       1917 |  6227301.68
 mpph11   |       1716 |  6116013.75
 mpph11   |        730 |  6100067.88
 mpph11   |        994 |  6032702.08
 mpph11   |       1144 |  6012205.92
 mpph11   |       1108 |  5914872.72
 mpph11   |       1950 |  5912352.20
 mpph11   |       1963 |  5873329.44
 mpph11   |         26 |  5867999.40
 mpph11   |        983 |  5846645.17
 mpph11   |       1808 |  5835183.38
 mpph11   |        504 |  5770344.51
 mpph11   |       1016 |  5718859.87
 mpph11   |       1494 |  5687809.60
 mpph11   |       1551 |  5668132.44
 mpph11   |        262 |  5625893.82
 mpph11   |        465 |  5537420.64
 mpph11   |        125 |  5533747.40
 mpph11   |       1972 |  5526059.28
 mpph11   |       1125 |  5514223.46
 mpph11   |        601 |  5513532.30
 mpph11   |        886 |  5450951.91
 mpph11   |        173 |  5409250.08
 mpph11   |       1752 |  5389034.04
 mpph11   |       1644 |  5387317.60
 mpph11   |        526 |  5350481.57
 mpph11   |        895 |  5346555.18
 mpph11   |       1576 |  5301661.68
 mpph11   |        692 |  5269557.57
 mpph11   |        951 |  5264770.02
 mpph11   |        861 |  5214617.22
 mpph11   |       1545 |  5196334.26
 mpph11   |       1356 |  5192649.28
 mpph11   |        789 |  5162645.80
 mpph11   |       1516 |  5107050.00
 mpph11   |       1616 |  5091834.00
 mpph11   |       1116 |  4992110.70
 mpph11   |        551 |  4982558.21
 mpph11   |       1887 |  4934262.24
 mpph11   |        885 |  4876658.57
 mpph11   |        116 |  4852263.60
 mpph11   |        251 |  4747015.56
 mpph11   |        394 |  4624460.10
 mpph11   |       1091 |  4589240.04
 mpph11   |        329 |  4558084.80
 mpph11   |        632 |  4494879.28
 mpph11   |       1485 |  4482428.50
 mpph11   |       1725 |  4340873.16
 mpph11   |        816 |  4326623.61
 mpph11   |        699 |  4310431.00
 mpph11   |        403 |  4283221.60
 mpph11   |       1768 |  4251602.98
 mpph11   |       1158 |  4229896.16
 mpph11   |        591 |  4216726.24
 mpph11   |       1248 |  4157093.60
 mpph11   |       1679 |  4156156.64
 mpph11   |        663 |  4142402.22
 mpph11   |       1719 |  4101486.48
 mpph11   |        395 |  4052997.76
 mpph11   |       1351 |  4045565.12
 mpph11   |        531 |  4042060.39
 mpph11   |       1951 |  4023967.36
 mpph11   |       1294 |  4009307.81
 mpph11   |        616 |  4004057.26
 mpph11   |        316 |  3986943.88
 mpph11   |       1928 |  3964898.76
 mpph11   |       1337 |  3951488.10
 mpph11   |       1851 |  3918641.34
 mpph11   |        521 |  3913058.16
 mpph11   |        883 |  3908087.82
 mpph11   |        961 |  3814756.38
 mpph11   |        366 |  3812257.88
 mpph11   |       1875 |  3800216.84
 mpph11   |        668 |  3772880.16
 mpph11   |        107 |  3756380.24
 mpph11   |       1061 |  3747377.84
 mpph11   |         16 |  3745783.12
 mpph11   |        294 |  3744033.70
 mpph11   |       1561 |  3711744.00
 mpph11   |       1574 |  3702071.64
 mpph11   |       1732 |  3695765.58
 mpph11   |        564 |  3680200.80
 mpph11   |       1371 |  3677874.16
 mpph11   |        516 |  3664770.45
 mpph11   |       1585 |  3641002.20
 mpph11   |        755 |  3635116.80
 mpph11   |        959 |  3620453.76
 mpph11   |        190 |  3559078.95
 mpph11   |       1194 |  3479709.09
 mpph11   |        416 |  3452131.59
 mpph11   |        333 |  3446486.38
 mpph11   |        377 |  3359789.30
 mpph11   |       1455 |  3342304.35
 mpph11   |        289 |  3270429.10
 mpph11   |        689 |  3260147.55
 mpph11   |       1919 |  3239067.00
 mpph11   |       1603 |  3194711.46
 mpph11   |       1438 |  3163393.12
 mpph11   |       1777 |  3107373.72
 mpph11   |         11 |  3035887.92
 mpph11   |       1340 |  3030301.09
 mpph11   |       1287 |  2985392.48
 mpph11   |       1347 |  2983078.12
 mpph11   |       1205 |  2971470.28
 mpph11   |        285 |  2967973.75
 mpph11   |        357 |  2967100.97
 mpph11   |        429 |  2962631.88
 mpph11   |         91 |  2951493.40
 mpph11   |       1161 |  2928475.76
 mpph11   |        914 |  2927894.16
 mpph11   |       1962 |  2925555.12
 mpph11   |       1483 |  2918425.86
 mpph11   |        561 |  2904720.39
 mpph11   |        258 |  2895651.20
 mpph11   |        194 |  2840047.13
 mpph11   |       1671 |  2818290.28
 mpph11   |       1477 |  2777362.76
 mpph11   |       1505 |  2766157.98
 mpph11   |        332 |  2741984.16
 mpph11   |        301 |  2737431.90
 mpph11   |        729 |  2706503.68
 mpph11   |        654 |  2662180.27
 mpph11   |        142 |  2647051.80
 mpph11   |        164 |  2643604.15
 mpph11   |       1662 |  2642551.92
 mpph11   |       1554 |  2639338.38
 mpph11   |        280 |  2631317.56
 mpph11   |       1541 |  2603175.96
 mpph11   |       1610 |  2463001.95
 mpph11   |        407 |  2460304.47
 mpph11   |        199 |  2442107.46
 mpph11   |        534 |  2420752.38
 mpph11   |       1313 |  2408870.75
 mpph11   |       1759 |  2387379.32
 mpph11   |       1115 |  2321227.26
 mpph11   |       1251 |  2311454.53
 mpph11   |       1285 |  2260852.77
 mpph11   |        159 |  2256004.65
 mpph11   |       1973 |  2243745.69
 mpph11   |       1638 |  2232762.96
 mpph11   |       1774 |  2217104.85
 mpph11   |        556 |  2195013.90
 mpph11   |       1694 |  2163305.16
 mpph11   |        819 |  2152055.50
 mpph11   |        992 |  2121582.28
 mpph11   |        785 |  2121133.75
 mpph11   |       1985 |  2069183.28
 mpph11   |        794 |  2059945.54
 mpph11   |        498 |  2055444.32
 mpph11   |       1385 |  2051890.11
 mpph11   |       1916 |  2032768.96
 mpph11   |        361 |  2017055.81
 mpph11   |         76 |  2012711.58
 mpph11   |       1873 |  2000792.40
 mpph11   |         94 |  1986087.48
 mpph11   |       1651 |  1980440.40
 mpph11   |       1059 |  1959087.04
 mpph11   |       1122 |  1942108.90
 mpph11   |        261 |  1928153.10
 mpph11   |       1861 |  1928114.84
 mpph11   |        461 |  1877992.32
 mpph11   |        224 |  1863852.24
 mpph11   |       1242 |  1851493.60
 mpph11   |       1634 |  1743866.22
 mpph11   |        761 |  1741958.65
 mpph11   |       1080 |  1741751.34
 mpph11   |        338 |  1724805.12
 mpph11   |        661 |  1709946.82
 mpph11   |        388 |  1696006.86
 mpph11   |        231 |  1655972.00
 mpph11   |        525 |  1633729.79
 mpph11   |       1906 |  1626282.30
 mpph11   |         85 |  1599847.56
 mpph11   |         60 |  1579401.77
 mpph11   |        926 |  1570368.78
 mpph11   |       1511 |  1569870.02
 mpph11   |       1113 |  1516263.20
 mpph11   |       1089 |  1477486.65
 mpph11   |       1422 |  1435904.00
 mpph11   |        458 |  1433040.45
 mpph11   |       1907 |  1421100.55
 mpph11   |        323 |  1419854.80
 mpph11   |        851 |  1400193.30
 mpph11   |         44 |  1353557.34
 mpph11   |        595 |  1350125.70
 mpph11   |       1822 |  1337990.67
 mpph11   |          1 |  1333528.04
 mpph11   |       1710 |  1331788.48
 mpph11   |         61 |  1322305.60
 mpph11   |        798 |  1313571.96
 mpph11   |        784 |  1309867.02
 mpph11   |        651 |  1307083.56
 mpph11   |       1468 |  1302397.20
 mpph11   |       1149 |  1289607.35
 mpph11   |       1179 |  1242058.40
 mpph11   |        818 |  1225981.68
 mpph11   |       1189 |  1204828.08
 mpph11   |        797 |  1181263.32
 mpph11   |       1375 |  1178128.60
 mpph11   |       1015 |  1164198.48
 mpph11   |       1994 |  1149222.96
 mpph11   |         66 |  1148101.44
 mpph11   |       1929 |  1131697.92
 mpph11   |        240 |  1126682.48
 mpph11   |       1378 |  1121941.05
 mpph11   |        762 |  1109467.26
 mpph11   |        586 |  1108200.58
 mpph11   |        716 |  1107627.42
 mpph11   |        752 |  1102384.63
 mpph11   |       1220 |  1083540.00
 mpph11   |       1675 |  1064600.76
 mpph11   |       1380 |  1020105.06
 mpph11   |        204 |  1014095.32
 mpph11   |       1214 |  1013602.86
 mpph11   |       1186 |  1006354.08
 mpph11   |        927 |  1003227.51
 mpph11   |       1473 |   997508.48
 mpph11   |       1701 |   994231.40
 mpph11   |        168 |   988803.90
 mpph11   |        852 |   977609.14
 mpph11   |        235 |   977200.14
 mpph11   |        501 |   961161.66
 mpph11   |       1620 |   950561.25
 mpph11   |       1709 |   927244.00
 mpph11   |       1565 |   921078.22
 mpph11   |        960 |   913060.80
 mpph11   |        385 |   910892.90
 mpph11   |       1434 |   905713.25
 mpph11   |        658 |   894649.92
 mpph11   |       1865 |   886024.01
 mpph11   |        487 |   883607.88
 mpph11   |       1279 |   877210.28
 mpph11   |       1211 |   875261.76
 mpph11   |        555 |   869246.77
 mpph11   |       1521 |   866284.81
 mpph11   |        427 |   839771.02
 mpph11   |       1628 |   832363.52
 mpph11   |        297 |   832286.88
 mpph11   |       1051 |   824164.90
 mpph11   |        185 |   794405.50
 mpph11   |       1412 |   793718.80
 mpph11   |        432 |   782403.82
 mpph11   |        216 |   776184.13
 mpph11   |       1056 |   772092.44
 mpph11   |        494 |   768524.43
 mpph11   |       1446 |   746482.32
 mpph11   |       1661 |   733795.56
 mpph11   |       1274 |   711073.48
 mpph11   |        451 |   676703.28
 mpph11   |       1685 |   661635.90
 mpph11   |       1143 |   660014.26
 mpph11   |       1318 |   655995.66
 mpph11   |       1531 |   649589.40
 mpph11   |       1514 |   627482.08
 mpph11   |       1612 |   626730.56
 mpph11   |        948 |   622068.66
 mpph11   |        571 |   619871.04
 mpph11   |       1767 |   614422.00
 mpph11   |        351 |   601983.45
 mpph11   |       1499 |   594599.22
 mpph11   |       1941 |   594211.48
 mpph11   |       1153 |   584114.56
 mpph11   |       1257 |   580110.85
 mpph11   |       1461 |   576845.88
 mpph11   |       1361 |   570409.02
 mpph11   |       1250 |   567963.36
 mpph11   |        422 |   530847.10
 mpph11   |       1653 |   525077.35
 mpph11   |       1669 |   513932.46
 mpph11   |       1596 |   505225.82
 mpph11   |        850 |   483358.05
 mpph11   |       1151 |   481433.04
 mpph11   |         86 |   471697.70
 mpph11   |        894 |   465151.80
 mpph11   |         19 |   464872.80
 mpph11   |        474 |   455889.28
 mpph11   |        493 |   455628.44
 mpph11   |        267 |   453340.80
 mpph11   |       1856 |   450086.28
 mpph11   |       1830 |   446553.54
 mpph11   |        456 |   439968.00
 mpph11   |        305 |   421891.68
 mpph11   |       1594 |   417994.09
 mpph11   |       1894 |   414577.35
 mpph11   |       1240 |   413718.76
 mpph11   |         35 |   398837.24
 mpph11   |       1180 |   391898.15
 mpph11   |       1794 |   355474.42
 mpph11   |       1024 |   319659.12
 mpph11   |        594 |   315583.24
 mpph11   |         10 |   314550.82
 mpph11   |       1953 |   314372.14
 mpph11   |       1261 |   312283.65
 mpph11   |       1832 |   308459.25
 mpph11   |       1785 |   300945.33
 mpph11   |        138 |   298832.01
 mpph11   |        753 |   297884.88
 mpph11   |       1790 |   277454.80
 mpph11   |        133 |   262568.64
 mpph11   |         51 |   260089.38
 mpph11   |        620 |   246511.60
 mpph11   |       1961 |   232870.27
 mpph11   |       1224 |   227429.47
 mpph11   |        183 |   225827.28
 mpph11   |       1735 |   219074.20
 mpph11   |       1816 |   218339.50
 mpph11   |       1743 |   217085.97
 mpph11   |        985 |   182239.20
 mpph11   |       1761 |   182100.00
 mpph11   |        464 |   179639.88
 mpph11   |        817 |   170795.52
 mpph11   |        485 |   170664.12
 mpph11   |       1818 |   161250.35
 mpph11   |        630 |   158427.72
 mpph11   |       1571 |   156406.05
 mpph11   |       1094 |   155577.60
 mpph11   |        436 |   147283.92
 mpph11   |        916 |   146788.80
 mpph11   |        310 |   145905.18
 mpph11   |       1751 |   140193.69
 mpph11   |        993 |   136907.25
 mpph11   |       1050 |   136152.30
 mpph11   |       1394 |   120166.11
 mpph11   |       1177 |   115967.72
 mpph11   |        151 |   110222.90
(357 rows)

select  'mpph12',
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	ao_orders,
	ao_lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('RAIL', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= date '1993-01-01'
	and l_receiptdate < date '1993-01-01' + interval '1 year'
group by
	l_shipmode
order by
	l_shipmode;
 ?column? | l_shipmode | high_line_count | low_line_count 
----------+------------+-----------------+----------------
 mpph12   | MAIL       |              41 |             99
 mpph12   | RAIL       |              54 |            102
(2 rows)

select  'mpph13',
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			ao_customer left outer join ao_orders on
				c_custkey = o_custkey
				and o_comment not like '%express%deposits%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;
 ?column? | c_count | custdist 
----------+---------+----------
 mpph13   |       0 |      500
 mpph13   |      11 |       66
 mpph13   |      10 |       64
 mpph13   |       8 |       63
 mpph13   |      12 |       61
 mpph13   |       9 |       60
 mpph13   |      20 |       58
 mpph13   |      13 |       58
 mpph13   |      14 |       53
 mpph13   |      15 |       48
 mpph13   |       7 |       47
 mpph13   |      18 |       43
 mpph13   |      17 |       40
 mpph13   |      21 |       38
 mpph13   |      16 |       38
 mpph13   |      19 |       36
 mpph13   |       6 |       35
 mpph13   |      22 |       34
 mpph13   |      24 |       32
 mpph13   |      23 |       30
 mpph13   |      25 |       22
 mpph13   |      26 |       19
 mpph13   |       5 |       13
 mpph13   |      27 |       10
 mpph13   |      28 |        9
 mpph13   |       4 |        7
 mpph13   |      32 |        4
 mpph13   |      30 |        4
 mpph13   |      29 |        3
 mpph13   |       3 |        2
 mpph13   |       2 |        2
 mpph13   |      31 |        1
(32 rows)

select  'mpph14',
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	ao_lineitem,
	ao_part
where
	l_partkey = p_partkey
	and l_shipdate >= date '1993-01-01'
	and l_shipdate < date '1993-01-01' + interval '1 month';
 ?column? |    promo_revenue    
----------+---------------------
 mpph14   | 11.5452471385458443
(1 row)

create view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		ao_lineitem
	where
		l_shipdate >= date '1993-01-01'
		and l_shipdate < date '1993-01-01' + interval '3 month'
	group by
		l_suppkey;
select  'mpph15',
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	ao_supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;
 ?column? | s_suppkey |          s_name           |          s_address          |     s_phone     | total_revenue 
----------+-----------+---------------------------+-----------------------------+-----------------+---------------
 mpph15   |        84 | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx | 34-869-118-7803 |  1134618.0543
(1 row)

drop view revenue0;
select 'mpph16',
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	ao_part, 
	ao_partsupp left join ao_supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
 ?column? |  p_brand   |          p_type           | p_size | supplier_cnt 
----------+------------+---------------------------+--------+--------------
 mpph16   | Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 mpph16   | Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 mpph16   | Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 mpph16   | Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 mpph16   | Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 mpph16   | Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 mpph16   | Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 mpph16   | Brand#11   | SMALL PLATED COPPER       |     46 |            4
 mpph16   | Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 mpph16   | Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 mpph16   | Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 mpph16   | Brand#11   | STANDARD PLATED TIN       |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 mpph16   | Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 mpph16   | Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 mpph16   | Brand#12   | LARGE PLATED COPPER       |     46 |            4
 mpph16   | Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 mpph16   | Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 mpph16   | Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 mpph16   | Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 mpph16   | Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 mpph16   | Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 mpph16   | Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 mpph16   | Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 mpph16   | Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 mpph16   | Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 mpph16   | Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 mpph16   | Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 mpph16   | Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 mpph16   | Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 mpph16   | Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 mpph16   | Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 mpph16   | Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 mpph16   | Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 mpph16   | Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 mpph16   | Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 mpph16   | Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 mpph16   | Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 mpph16   | Brand#15   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 mpph16   | Brand#15   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 mpph16   | Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 mpph16   | Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 mpph16   | Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 mpph16   | Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 mpph16   | Brand#21   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 mpph16   | Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 mpph16   | Brand#21   | PROMO PLATED COPPER       |     20 |            4
 mpph16   | Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 mpph16   | Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 mpph16   | Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 mpph16   | Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 mpph16   | Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 mpph16   | Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 mpph16   | Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 mpph16   | Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 mpph16   | Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 mpph16   | Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 mpph16   | Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 mpph16   | Brand#23   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 mpph16   | Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 mpph16   | Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 mpph16   | Brand#23   | SMALL PLATED TIN          |     42 |            4
 mpph16   | Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 mpph16   | Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 mpph16   | Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 mpph16   | Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 mpph16   | Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 mpph16   | Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 mpph16   | Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 mpph16   | Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 mpph16   | Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 mpph16   | Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 mpph16   | Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 mpph16   | Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 mpph16   | Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 mpph16   | Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 mpph16   | Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 mpph16   | Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 mpph16   | Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 mpph16   | Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 mpph16   | Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 mpph16   | Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 mpph16   | Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 mpph16   | Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 mpph16   | Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 mpph16   | Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 mpph16   | Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#32   | SMALL PLATED BRASS        |     31 |            4
 mpph16   | Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 mpph16   | Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 mpph16   | Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 mpph16   | Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 mpph16   | Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 mpph16   | Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 mpph16   | Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 mpph16   | Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 mpph16   | Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 mpph16   | Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 mpph16   | Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 mpph16   | Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 mpph16   | Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 mpph16   | Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 mpph16   | Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 mpph16   | Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 mpph16   | Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 mpph16   | Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 mpph16   | Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 mpph16   | Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 mpph16   | Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 mpph16   | Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 mpph16   | Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 mpph16   | Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#42   | PROMO POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     24 |            4
 mpph16   | Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 mpph16   | Brand#43   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#43   | LARGE PLATED TIN          |     24 |            4
 mpph16   | Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 mpph16   | Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 mpph16   | Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 mpph16   | Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 mpph16   | Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 mpph16   | Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 mpph16   | Brand#45   | LARGE PLATED STEEL        |     22 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#45   | SMALL PLATED COPPER       |     15 |            4
 mpph16   | Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 mpph16   | Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 mpph16   | Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 mpph16   | Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 mpph16   | Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 mpph16   | Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 mpph16   | Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 mpph16   | Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 mpph16   | Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 mpph16   | Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 mpph16   | Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 mpph16   | Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 mpph16   | Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 mpph16   | Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 mpph16   | Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#52   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 mpph16   | Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 mpph16   | Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 mpph16   | Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 mpph16   | Brand#53   | SMALL PLATED STEEL        |     31 |            4
 mpph16   | Brand#53   | SMALL POLISHED TIN        |     42 |            4
 mpph16   | Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 mpph16   | Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 mpph16   | Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 mpph16   | Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 mpph16   | Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 mpph16   | Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 mpph16   | Brand#54   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 mpph16   | Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 mpph16   | Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 mpph16   | Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 mpph16   | Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 mpph16   | Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 mpph16   | Brand#55   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 mpph16   | Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 mpph16   | Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 mpph16   | Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	ao_partsupp,
	ao_part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			ao_supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select 'mpph17',
      sum(l_extendedprice) / 7.0 as avg_yearly
from
      ao_lineitem,
      (
          select
              p_partkey as x_partkey,
              0.2 * avg(l_quantity) as x_avg_20
          from
              ao_part,
              ao_lineitem
          where
              p_partkey = l_partkey
              and p_brand = 'Brand#32'
              and p_container = 'JUMBO PACK'
          group by
              p_partkey
      ) x
where
      x_partkey = l_partkey
and l_quantity < x_avg_20;
 ?column? |      avg_yearly       
----------+-----------------------
 mpph17   | 1278.3700000000000000
(1 row)

select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	ao_lineitem,
	ao_part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#32'
	and p_container = 'JUMBO PACK'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			ao_lineitem
		where
			l_partkey = p_partkey
	);
      avg_yearly       
-----------------------
 1278.3700000000000000
(1 row)

select  'mpph18',
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	ao_customer,
	ao_orders,
	ao_lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			ao_lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 300
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
 ?column? |       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice |  sum   
----------+--------------------+-----------+------------+-------------+--------------+--------
 mpph18   | Customer#000000667 |       667 |      29158 | 10-21-1995  |    439687.23 | 305.00
 mpph18   | Customer#000000178 |       178 |       6882 | 04-09-1997  |    422359.65 | 303.00
(2 rows)

select  'mpph19',
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	ao_lineitem,
	ao_part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#53'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#21'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
 ?column? |  revenue   
----------+------------
 mpph19   | 10604.0448
(1 row)

select  'mpph20',
	s_name,
	s_address 
from 
	ao_supplier, 
	ao_nation 
where 
	s_suppkey in( 
		select 
			ps_suppkey 
		from 
			ao_partsupp, 
			( 
				select 
					sum(l_quantity) as qty_sum, l_partkey, l_suppkey 
				from 
					ao_lineitem 
				where 
					l_shipdate >= date '1996-01-01' 
					and l_shipdate < date '1996-01-01' + interval '1 year' 
				group by l_partkey, l_suppkey ) g 
		where 
			g.l_partkey = ps_partkey 
			and g.l_suppkey = ps_suppkey 
			and ps_availqty > 0.5 * g.qty_sum 
			and ps_partkey in ( select p_partkey from ao_part where p_name like 'medium%' ) 
		) 
	and s_nationkey = n_nationkey 
	and n_name = 'UNITED STATES'
order by 
	s_name;
 ?column? |          s_name           |                s_address                 
----------+---------------------------+------------------------------------------
 mpph20   | Supplier#000000010        | Saygah3gYWMp72i PY
 mpph20   | Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 mpph20   | Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 mpph20   | Supplier#000000049        | Nvq 6macF4GtJvz
 mpph20   | Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 mpph20   | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select
	s_name,
	s_address
from
	ao_supplier,
	ao_nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			ao_partsupp
		where
			ps_partkey in (
				select
					p_partkey
				from
					ao_part
				where
					p_name like 'medium%'
			)
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					ao_lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= date '1996-01-01'
					and l_shipdate < date '1996-01-01' + interval '1 year'
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
order by
	s_name;
          s_name           |                s_address                 
---------------------------+------------------------------------------
 Supplier#000000010        | Saygah3gYWMp72i PY
 Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 Supplier#000000049        | Nvq 6macF4GtJvz
 Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select  'mpph21',
	s_name, 
	count(distinct(l1.l_orderkey::text||l1.l_linenumber::text)) as numwait 
from 
	ao_supplier, 
	ao_orders, 
	ao_nation, 
	ao_lineitem l1 
		left join ao_lineitem l2 
			on (l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) 
		left join (
			select 
				l3.l_orderkey,
				l3.l_suppkey 
			from 
				ao_lineitem l3 
			where 
				l3.l_receiptdate > l3.l_commitdate) l4 
			on (l4.l_orderkey = l1.l_orderkey and l4.l_suppkey <> l1.l_suppkey) 
where 
	s_suppkey = l1.l_suppkey 
	and o_orderkey = l1.l_orderkey 
	and o_orderstatus = 'F' 
	and l1.l_receiptdate > l1.l_commitdate 
	and l2.l_orderkey is not null 
	and l4.l_orderkey is null 
	and s_nationkey = n_nationkey 
	and n_name = 'MOZAMBIQUE' 
group by 
	s_name 
order by 
	numwait desc, 
	s_name
LIMIT 100;
 ?column? |          s_name           | numwait 
----------+---------------------------+---------
 mpph21   | Supplier#000000056        |      18
 mpph21   | Supplier#000000073        |      13
 mpph21   | Supplier#000000018        |      12
 mpph21   | Supplier#000000058        |      10
 mpph21   | Supplier#000000030        |       9
 mpph21   | Supplier#000000093        |       9
 mpph21   | Supplier#000000031        |       6
(7 rows)

select  'mpph22',
	cntrycode, 
	count(*) as numcust, 
	sum(c_acctbal) as totacctbal 
from 
	( 
		select 
			substring(c_phone from 1 for 2) as cntrycode, 
			c_acctbal 
		from 
			ao_customer left join ao_orders 
				on c_custkey = o_custkey 
		where 
			substring(c_phone from 1 for 2) in 
				('11', '28', '21', '26', '19', '13', '22') 
			and c_acctbal > ( 
				select 
					avg(c_acctbal) 
				from 
					ao_customer 
				where 
					c_acctbal > 0.00 
					and substring(c_phone from 1 for 2) in 
						('11', '28', '21', '26', '19', '13', '22') 
			) 
			and o_custkey is null 
	) as custsale 
group by 
	cntrycode 
order by 
	cntrycode;
 ?column? | cntrycode | numcust | totacctbal 
----------+-----------+---------+------------
 mpph22   | 11        |      11 |   82845.34
 mpph22   | 13        |      10 |   75359.29
 mpph22   | 19        |      17 |  132118.07
 mpph22   | 21        |       9 |   73087.05
 mpph22   | 22        |       9 |   65544.55
 mpph22   | 26        |       6 |   47747.11
 mpph22   | 28        |      10 |   79310.33
(7 rows)

select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			ao_customer
		where
			substring(c_phone from 1 for 2) in
				('11', '28', '21', '26', '19', '13', '22')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					ao_customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('11', '28', '21', '26', '19', '13', '22')
			)
			and not exists (
				select
					*
				from
					ao_orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;
 cntrycode | numcust | totacctbal 
-----------+---------+------------
 11        |      11 |   82845.34
 13        |      10 |   75359.29
 19        |      17 |  132118.07
 21        |       9 |   73087.05
 22        |       9 |   65544.55
 26        |       6 |   47747.11
 28        |      10 |   79310.33
(7 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	ao_partsupp,
	ao_part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			ao_supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	ao_part, 
	ao_partsupp left join ao_supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select  'mpph1',
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	co_lineitem
where
	l_shipdate <= date '1998-12-01' - interval '108 day'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
 ?column? | l_returnflag | l_linestatus |  sum_qty  | sum_base_price | sum_disc_price |    sum_charge     |       avg_qty       |     avg_price      |        avg_disc        | count_order 
----------+--------------+--------------+-----------+----------------+----------------+-------------------+---------------------+--------------------+------------------------+-------------
 mpph1    | A            | F            | 380456.00 |   532348211.65 | 505822441.4861 |  526165934.000839 | 25.5751546114546921 | 35785.709306937349 | 0.05008133906964237698 |       14876
 mpph1    | N            | F            |   8971.00 |    12384801.37 |  11798257.2080 |   12282485.056933 | 25.7787356321839080 | 35588.509683908046 | 0.04775862068965517241 |         348
 mpph1    | N            | O            | 733323.00 |  1028186527.78 | 977118238.4241 | 1016280268.835844 | 25.4466999791796794 | 35678.621964744257 | 0.04991255465334166146 |       28818
 mpph1    | R            | F            | 381449.00 |   534594445.35 | 507996454.4067 |  528524219.358903 | 25.5971681653469333 | 35874.006532680177 | 0.04982753992752650651 |       14902
(4 rows)

select  'mpph2',
	s.s_acctbal,
	s.s_name,
	n.n_name,
	p.p_partkey,
	p.p_mfgr,
	s.s_address,
	s.s_phone,
	s.s_comment 
from 
	co_supplier s, 
	co_partsupp ps, 
	co_nation n, 
	co_region r, 
	co_part p, 
	(select p_partkey, min(ps_supplycost) as min_ps_cost 
		from 
			co_part, 
			co_partsupp, 	
			co_supplier,
			co_nation, 
			co_region 
		where 
			p_partkey=ps_partkey 
			and s_suppkey = ps_suppkey 
			and s_nationkey = n_nationkey 
			and n_regionkey = r_regionkey 
			and r_name = 'EUROPE' 
		group by p_partkey ) g 
where 
	p.p_partkey = ps.ps_partkey 
	and g.p_partkey = p.p_partkey 
	and g. min_ps_cost = ps.ps_supplycost 
	and s.s_suppkey = ps.ps_suppkey 
	and p.p_size = 45 
	and p.p_type like '%NICKEL' 
	and s.s_nationkey = n.n_nationkey 
	and n.n_regionkey = r.r_regionkey 
	and r.r_name = 'EUROPE' 
order by 
	s.s_acctbal desc,
	n.n_name,
	s.s_name,
	p.p_partkey
LIMIT 100;
 ?column? | s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
----------+-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
 mpph2    |   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
 mpph2    |   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
 mpph2    |   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	co_part,
	co_supplier,
	co_partsupp,
	co_nation,
	co_region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 45
	and p_type like '%NICKEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			co_partsupp,
			co_supplier,
			co_nation,
			co_region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'EUROPE'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
 s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                             s_comment                             
-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-------------------------------------------------------------------
   8564.12 | Supplier#000000033        | GERMANY                   |       532 | Manufacturer#1            | gfeKpYw3400L0SDywXA6Ya1Qmq1w6YB9f3R      | 17-138-897-9374 | n sauternes along the regular asymptotes are regularly along the 
   4186.95 | Supplier#000000077        | GERMANY                   |       645 | Manufacturer#4            | wVtcr0uH3CyrSiWMLsqnB09Syo,UuZxPMeBghlY  | 17-281-345-4863 | the slyly final asymptotes. blithely pending theodoli
   2455.98 | Supplier#000000066        | UNITED KINGDOM            |      1193 | Manufacturer#1            | qYdruFJQJYYiKvnNVmYfCVydVB8bcW,AW,U6SOV3 | 33-300-836-9529 | ar requests. express orbits de
(3 rows)

select  'mpph3',
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	co_customer,
	co_orders,
	co_lineitem
where
	c_mktsegment = 'MACHINERY'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < date '1995-03-15'
	and l_shipdate > date '1995-03-15'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
 ?column? | l_orderkey |   revenue   | o_orderdate | o_shippriority 
----------+------------+-------------+-------------+----------------
 mpph3    |      12641 | 222127.6271 | 02-23-1995  |              0
 mpph3    |      39878 | 219714.3069 | 03-06-1995  |              0
 mpph3    |      34243 | 214308.7196 | 02-12-1995  |              0
 mpph3    |       7171 | 202398.1900 | 02-14-1995  |              0
 mpph3    |      55271 | 195237.8000 | 03-12-1995  |              0
 mpph3    |      50145 | 189500.1602 | 02-27-1995  |              0
 mpph3    |      12867 | 185769.1004 | 03-12-1995  |              0
 mpph3    |      12066 | 180776.3231 | 02-07-1995  |              0
 mpph3    |      41926 | 180459.9518 | 02-06-1995  |              0
 mpph3    |      46307 | 180383.2464 | 02-07-1995  |              0
(10 rows)

select  'mpph4',
        o_orderpriority,
        count(*) as order_count
from
        co_orders
where
        o_orderdate >= date '1994-05-01'
        and o_orderdate < date '1994-05-01' + interval '3 month'
        and exists (
                select
                        *
                from
                        co_lineitem
                where
                        l_orderkey = o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority;
 ?column? | o_orderpriority | order_count 
----------+-----------------+-------------
 mpph4    | 1-URGENT        |         108
 mpph4    | 2-HIGH          |         117
 mpph4    | 3-MEDIUM        |          95
 mpph4    | 4-NOT SPECIFIED |         111
 mpph4    | 5-LOW           |         116
(5 rows)

select  'mpph5',
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	co_customer,
	co_orders,
	co_lineitem,
	co_supplier,
	co_nation,
	co_region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and o_orderdate >= date '1997-01-01'
	and o_orderdate < date '1997-01-01' + interval '1 year'
group by
	n_name
order by
	revenue desc;
 ?column? |          n_name           |   revenue   
----------+---------------------------+-------------
 mpph5    | UNITED STATES             | 721432.9139
 mpph5    | CANADA                    | 451731.0802
 mpph5    | PERU                      | 317553.7203
 mpph5    | BRAZIL                    | 275951.7747
 mpph5    | ARGENTINA                 | 225713.4702
(5 rows)

select  'mpph6',
	sum(l_extendedprice * l_discount) as revenue
from
	co_lineitem
where
	l_shipdate >= date '1996-01-01'
	and l_shipdate < date '1996-01-01' + interval '1 year'
	and l_discount between 0.04 - 0.01 and 0.04 + 0.01
	and l_quantity < 24;
 ?column? |   revenue   
----------+-------------
 mpph6    | 740117.7050
(1 row)

select  'mpph7',
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			co_supplier,
			co_lineitem,
			co_orders,
			co_customer,
			co_nation n1,
			co_nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'MOZAMBIQUE' and n2.n_name = 'GERMANY')
				or (n1.n_name = 'GERMANY' and n2.n_name = 'MOZAMBIQUE')
			)
			and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
 ?column? |        supp_nation        |        cust_nation        | l_year |   revenue    
----------+---------------------------+---------------------------+--------+--------------
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1995 |  749611.6213
 mpph7    | GERMANY                   | MOZAMBIQUE                |   1996 |  838743.2524
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1995 |  669933.3036
 mpph7    | MOZAMBIQUE                | GERMANY                   |   1996 | 1084686.2375
(4 rows)

select  'mpph8',
	o_year,
	sum(case
		when nation = 'PERU' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			co_part,
			co_supplier,
			co_lineitem,
			co_orders,
			co_customer,
			co_nation n1,
			co_nation n2,
			co_region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AMERICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'MEDIUM POLISHED TIN'
	) as all_nations
group by
	o_year
order by
	o_year;
 ?column? | o_year |         mkt_share          
----------+--------+----------------------------
 mpph8    |   1995 | 0.000000000000000000000000
 mpph8    |   1996 |     0.17380660267693394854
(2 rows)

select  'mpph9',
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			co_part,
			co_supplier,
			co_lineitem,
			co_partsupp,
			co_orders,
			co_nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%tan%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
 ?column? |          nation           | o_year | sum_profit  
----------+---------------------------+--------+-------------
 mpph9    | ALGERIA                   |   1998 | 203717.6183
 mpph9    | ALGERIA                   |   1997 | 277895.7940
 mpph9    | ALGERIA                   |   1996 | 285313.9627
 mpph9    | ALGERIA                   |   1995 | 309375.7934
 mpph9    | ALGERIA                   |   1994 | 288152.6449
 mpph9    | ALGERIA                   |   1993 | 321222.9401
 mpph9    | ALGERIA                   |   1992 | 436020.6807
 mpph9    | ARGENTINA                 |   1998 | 217919.0097
 mpph9    | ARGENTINA                 |   1997 |  47720.1989
 mpph9    | ARGENTINA                 |   1996 | 373086.6814
 mpph9    | ARGENTINA                 |   1995 | 256403.9057
 mpph9    | ARGENTINA                 |   1994 | 172411.8182
 mpph9    | ARGENTINA                 |   1993 | 414051.7103
 mpph9    | ARGENTINA                 |   1992 | 497745.7196
 mpph9    | BRAZIL                    |   1998 |   9402.1360
 mpph9    | BRAZIL                    |   1996 | 130680.4872
 mpph9    | BRAZIL                    |   1995 |  47629.8480
 mpph9    | BRAZIL                    |   1994 |  22440.1440
 mpph9    | BRAZIL                    |   1993 | 106237.4759
 mpph9    | BRAZIL                    |   1992 | 116994.4770
 mpph9    | CANADA                    |   1998 |  67660.5389
 mpph9    | CANADA                    |   1997 | 167179.5520
 mpph9    | CANADA                    |   1996 | 147802.3006
 mpph9    | CANADA                    |   1995 |  84817.9292
 mpph9    | CANADA                    |   1994 |  49027.1082
 mpph9    | CANADA                    |   1993 | 157886.0056
 mpph9    | CANADA                    |   1992 | 191231.3590
 mpph9    | CHINA                     |   1998 | 382876.9927
 mpph9    | CHINA                     |   1997 | 787527.2369
 mpph9    | CHINA                     |   1996 | 605901.5293
 mpph9    | CHINA                     |   1995 | 587705.6412
 mpph9    | CHINA                     |   1994 | 917527.5948
 mpph9    | CHINA                     |   1993 | 839365.4133
 mpph9    | CHINA                     |   1992 | 748324.7469
 mpph9    | EGYPT                     |   1998 | 220523.2078
 mpph9    | EGYPT                     |   1997 | 554962.2792
 mpph9    | EGYPT                     |   1996 | 526118.5876
 mpph9    | EGYPT                     |   1995 | 406448.9115
 mpph9    | EGYPT                     |   1994 | 404925.7193
 mpph9    | EGYPT                     |   1993 | 296691.1725
 mpph9    | EGYPT                     |   1992 | 449161.6055
 mpph9    | ETHIOPIA                  |   1998 | 178828.6942
 mpph9    | ETHIOPIA                  |   1997 | 322949.1543
 mpph9    | ETHIOPIA                  |   1996 | 179589.0062
 mpph9    | ETHIOPIA                  |   1995 | 215017.5362
 mpph9    | ETHIOPIA                  |   1994 | 509710.4645
 mpph9    | ETHIOPIA                  |   1993 | 251330.1758
 mpph9    | ETHIOPIA                  |   1992 | 225397.2384
 mpph9    | FRANCE                    |   1998 | 210901.9632
 mpph9    | FRANCE                    |   1997 | 234428.9324
 mpph9    | FRANCE                    |   1996 | 283026.6644
 mpph9    | FRANCE                    |   1995 | 428615.5897
 mpph9    | FRANCE                    |   1994 | 233410.4344
 mpph9    | FRANCE                    |   1993 | 420330.4447
 mpph9    | FRANCE                    |   1992 | 359496.0042
 mpph9    | GERMANY                   |   1998 | 229863.3768
 mpph9    | GERMANY                   |   1997 | 519160.2856
 mpph9    | GERMANY                   |   1996 | 533764.1221
 mpph9    | GERMANY                   |   1995 | 621744.7373
 mpph9    | GERMANY                   |   1994 | 340785.3795
 mpph9    | GERMANY                   |   1993 | 673651.1393
 mpph9    | GERMANY                   |   1992 | 524002.5977
 mpph9    | INDIA                     |   1998 | 334403.8655
 mpph9    | INDIA                     |   1997 | 156434.8865
 mpph9    | INDIA                     |   1996 | 265093.2063
 mpph9    | INDIA                     |   1995 | 137842.0462
 mpph9    | INDIA                     |   1994 | 262710.5074
 mpph9    | INDIA                     |   1993 | 328441.1285
 mpph9    | INDIA                     |   1992 | 199589.6727
 mpph9    | INDONESIA                 |   1998 | 155973.1013
 mpph9    | INDONESIA                 |   1997 | 316792.0784
 mpph9    | INDONESIA                 |   1996 | 422245.5263
 mpph9    | INDONESIA                 |   1995 | 235242.8814
 mpph9    | INDONESIA                 |   1994 | 326775.3396
 mpph9    | INDONESIA                 |   1993 | 327711.7699
 mpph9    | INDONESIA                 |   1992 | 243688.5923
 mpph9    | IRAN                      |   1998 |  27198.8568
 mpph9    | IRAN                      |   1997 | 174737.8001
 mpph9    | IRAN                      |   1996 |  50121.8822
 mpph9    | IRAN                      |   1995 |  70977.8022
 mpph9    | IRAN                      |   1994 | 104593.0442
 mpph9    | IRAN                      |   1993 |  25867.0544
 mpph9    | IRAN                      |   1992 |  82988.9337
 mpph9    | IRAQ                      |   1998 | 157348.1240
 mpph9    | IRAQ                      |   1997 | 227619.0410
 mpph9    | IRAQ                      |   1996 | 114431.2136
 mpph9    | IRAQ                      |   1995 |  83702.7028
 mpph9    | IRAQ                      |   1994 | 189246.3076
 mpph9    | IRAQ                      |   1993 | 172977.0040
 mpph9    | IRAQ                      |   1992 | 165679.6544
 mpph9    | JAPAN                     |   1998 | 301448.7416
 mpph9    | JAPAN                     |   1997 | 274224.7673
 mpph9    | JAPAN                     |   1996 | 365055.9942
 mpph9    | JAPAN                     |   1995 | 273486.9553
 mpph9    | JAPAN                     |   1994 | 306480.9939
 mpph9    | JAPAN                     |   1993 | 309841.9310
 mpph9    | JAPAN                     |   1992 | 257133.6723
 mpph9    | JORDAN                    |   1998 |  51101.6440
 mpph9    | JORDAN                    |   1996 |   6016.6285
 mpph9    | JORDAN                    |   1995 |  58278.1892
 mpph9    | JORDAN                    |   1994 |  59604.3204
 mpph9    | JORDAN                    |   1993 | 110544.8190
 mpph9    | KENYA                     |   1998 | 239097.5320
 mpph9    | KENYA                     |   1997 | 177292.9690
 mpph9    | KENYA                     |   1996 | 597636.7126
 mpph9    | KENYA                     |   1995 | 434837.8428
 mpph9    | KENYA                     |   1994 | 511118.7047
 mpph9    | KENYA                     |   1993 | 181482.4886
 mpph9    | KENYA                     |   1992 | 442814.6201
 mpph9    | MOROCCO                   |   1998 |  94153.7562
 mpph9    | MOROCCO                   |   1997 |   1952.7200
 mpph9    | MOROCCO                   |   1996 | 184609.4769
 mpph9    | MOROCCO                   |   1995 | 138773.7720
 mpph9    | MOROCCO                   |   1994 | 141735.9952
 mpph9    | MOROCCO                   |   1993 | 240971.4009
 mpph9    | MOROCCO                   |   1992 |  76485.6974
 mpph9    | MOZAMBIQUE                |   1998 | 315271.5330
 mpph9    | MOZAMBIQUE                |   1997 | 593511.8009
 mpph9    | MOZAMBIQUE                |   1996 | 463830.0035
 mpph9    | MOZAMBIQUE                |   1995 | 463982.1278
 mpph9    | MOZAMBIQUE                |   1994 | 402790.4493
 mpph9    | MOZAMBIQUE                |   1993 | 765203.5080
 mpph9    | MOZAMBIQUE                |   1992 | 552780.7126
 mpph9    | PERU                      |   1998 | 291043.9094
 mpph9    | PERU                      |   1997 | 332386.6526
 mpph9    | PERU                      |   1996 | 271308.8627
 mpph9    | PERU                      |   1995 | 136468.6570
 mpph9    | PERU                      |   1994 | 231696.8464
 mpph9    | PERU                      |   1993 | 319175.9000
 mpph9    | PERU                      |   1992 | 296178.1348
 mpph9    | ROMANIA                   |   1998 | 366693.1531
 mpph9    | ROMANIA                   |   1997 | 313915.6675
 mpph9    | ROMANIA                   |   1996 | 257449.7931
 mpph9    | ROMANIA                   |   1995 | 613689.1994
 mpph9    | ROMANIA                   |   1994 | 514683.8323
 mpph9    | ROMANIA                   |   1993 | 301818.9752
 mpph9    | ROMANIA                   |   1992 | 445559.9618
 mpph9    | RUSSIA                    |   1998 | 215635.7552
 mpph9    | RUSSIA                    |   1997 | 263377.9773
 mpph9    | RUSSIA                    |   1996 | 292798.2473
 mpph9    | RUSSIA                    |   1995 | 202559.9044
 mpph9    | RUSSIA                    |   1994 | 287175.8782
 mpph9    | RUSSIA                    |   1993 | 163995.8157
 mpph9    | RUSSIA                    |   1992 | 356477.2999
 mpph9    | SAUDI ARABIA              |   1998 |  22338.7375
 mpph9    | SAUDI ARABIA              |   1997 |  89352.2847
 mpph9    | SAUDI ARABIA              |   1996 | 172227.1252
 mpph9    | SAUDI ARABIA              |   1995 | 104670.1059
 mpph9    | SAUDI ARABIA              |   1994 |  39327.6690
 mpph9    | SAUDI ARABIA              |   1993 |  76176.8010
 mpph9    | SAUDI ARABIA              |   1992 |  71000.2760
 mpph9    | UNITED KINGDOM            |   1998 |  57011.9084
 mpph9    | UNITED KINGDOM            |   1997 |  86313.0141
 mpph9    | UNITED KINGDOM            |   1996 |  93430.0955
 mpph9    | UNITED KINGDOM            |   1995 | 105005.8744
 mpph9    | UNITED KINGDOM            |   1994 | 111953.2358
 mpph9    | UNITED KINGDOM            |   1993 | 161721.5622
 mpph9    | UNITED KINGDOM            |   1992 | 173519.0108
 mpph9    | UNITED STATES             |   1998 | 382856.8948
 mpph9    | UNITED STATES             |   1997 | 494438.3396
 mpph9    | UNITED STATES             |   1996 | 548337.7007
 mpph9    | UNITED STATES             |   1995 | 720764.4099
 mpph9    | UNITED STATES             |   1994 | 695834.7785
 mpph9    | UNITED STATES             |   1993 | 593012.3919
 mpph9    | UNITED STATES             |   1992 | 801814.0301
 mpph9    | VIETNAM                   |   1998 | 253199.9819
 mpph9    | VIETNAM                   |   1997 | 551578.3779
 mpph9    | VIETNAM                   |   1996 | 309940.0530
 mpph9    | VIETNAM                   |   1995 | 491467.2046
 mpph9    | VIETNAM                   |   1994 | 510626.2215
 mpph9    | VIETNAM                   |   1993 | 786734.2542
 mpph9    | VIETNAM                   |   1992 | 511062.6378
(172 rows)

select  'mpph10',
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	co_customer,
	co_orders,
	co_lineitem,
	co_nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1994-10-01'
	and o_orderdate < date '1994-10-01' + interval '3 month'
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
 ?column? | c_custkey |       c_name       |   revenue   | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                      c_comment                                                      
----------+-----------+--------------------+-------------+-----------+---------------------------+------------------------------------------+-----------------+---------------------------------------------------------------------------------------------------------------------
 mpph10   |       643 | Customer#000000643 | 379216.9236 |   5184.70 | ALGERIA                   | 9T 2avhfyF PQ                            | 10-978-597-2747 | fily along the quickly ironic ideas. final, final
 mpph10   |      1255 | Customer#000001255 | 348227.6139 |   6487.71 | KENYA                     | UC6I32JjBU62t4WgDe e2pDYbuM3VAt4MPM      | 24-359-633-2713 | s deposits sleep. blithely ironic dependencies wake. blithely even theodolites sleep. blithely 
 mpph10   |      1144 | Customer#000001144 | 344762.9152 |   4189.04 | ARGENTINA                 | DGLUWG9evYLNbYhOXVzqZ LdfIMVfBjDf        | 11-336-453-4489 |  ideas. even, regular excuses after the ironic requests cajole blithe
 mpph10   |       871 | Customer#000000871 | 336419.8098 |   -395.89 | SAUDI ARABIA              | KcLmBKitbx7NvU7bpu9clIyccxWG             | 30-933-714-8982 | ts. blithely silent courts doze. regular atta
 mpph10   |       421 | Customer#000000421 | 335198.8566 |   7073.17 | JORDAN                    | it3mUlkZAe9J8gmy                         | 23-918-228-2560 | lithely final deposits haggle furiously above the
 mpph10   |        61 | Customer#000000061 | 332777.6898 |   1536.24 | PERU                      | 9kndve4EAJxhg3veF BfXr7AqOsT39o gtqjaYE  | 27-626-559-8599 | egular packages shall have to impress along the 
 mpph10   |      1121 | Customer#000001121 | 320274.8995 |   3942.11 | SAUDI ARABIA              | o2uc3AHYz,m 3vYg8YxBwI0XuG               | 30-197-936-4724 | usly? final theodolites are carefully 
 mpph10   |       532 | Customer#000000532 | 296758.8028 |   1725.68 | MOROCCO                   | xwWO3lWjgVJTZwhnltyH6zj5ddkzgH8RbF       | 25-875-978-2232 | usly regular deposits kindle. quickly even depos
 mpph10   |       584 | Customer#000000584 | 286297.8180 |   8825.71 | MOROCCO                   | jebKvptmHtS9,YE1qOjl2AOw38P,8skngJZh     | 25-352-778-1041 | ages boost regular deposits. blithely stealthy depo
 mpph10   |       892 | Customer#000000892 | 284479.7745 |   4799.98 | INDONESIA                 | N KwiRAwIk6KL9WJ6vt0G                    | 19-589-784-1249 | ses are carefully. quickly regular theodolites cajole. carefully express accounts wake sly
 mpph10   |       169 | Customer#000000169 | 277234.4946 |   4483.83 | CHINA                     | NjhmHa7xrcjE                             | 28-362-499-3728 | fully unusual pinto beans. blithely express asymptotes lose carefully regular instructions? accounts b
 mpph10   |      1036 | Customer#000001036 | 270725.2873 |   1766.23 | INDIA                     | fxujgj8DOFO6oKrH                         | 18-791-577-7691 | ins sleep. slyly express platelets cajol
 mpph10   |       608 | Customer#000000608 | 268304.6758 |   2256.36 | MOZAMBIQUE                | luMI1JpfrrILCEeTgz8k98z                  | 26-767-193-8671 | ld packages. special requests along the accounts are after the carefully unusual deposits. blithely quiet excuses c
 mpph10   |       635 | Customer#000000635 | 261889.3542 |   8216.79 | BRAZIL                    | Ftqi0UYvzz56Ov,J6,ySp5WE4vJ2rtY          | 12-399-186-7550 | efully bold deposits doubt above the clos
 mpph10   |      1279 | Customer#000001279 | 261726.8460 |   7915.06 | KENYA                     | fkrzLacsqCnwUwgjjttKmY                   | 24-742-587-6985 | tes are. ideas above the carefully ironic d
 mpph10   |      1483 | Customer#000001483 | 256807.2933 |   4409.70 | GERMANY                   | ZjY1C b6cOnY3                            | 17-202-113-4814 | nts sleep around the carefully express theodolites. requests nag 
 mpph10   |        71 | Customer#000000071 | 251773.7061 |   -611.19 | GERMANY                   | TlGalgdXWBmMV,6agLyWYDyIz9MKzcY8gl,w6t1B | 17-710-812-5403 | g courts across the regular, final pinto beans are blithely pending ac
 mpph10   |       664 | Customer#000000664 | 244482.6132 |   8878.22 | MOROCCO                   | viRe1P6HiyL4LXpU7HPwu                    | 25-329-655-5068 | yly ironic requests cajole pending pla
 mpph10   |       883 | Customer#000000883 | 238622.1581 |    479.96 | CANADA                    | qVQ8rWNU5KZYDcS                          | 13-526-239-6950 | uctions are carefully across the regular, regular asymptote
 mpph10   |      1288 | Customer#000001288 | 236676.5999 |   6603.43 | CANADA                    | wQDTTCkSGxic2d66                         | 13-533-256-9320 | equests detect atop the ironic deposits. final requests according to the blithely sp
(20 rows)

select  'mpph11',
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	co_partsupp,
	co_supplier,
	co_nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'ROMANIA'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				co_partsupp,
				co_supplier,
				co_nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'ROMANIA'
		)
order by
	value desc;
 ?column? | ps_partkey |    value    
----------+------------+-------------
 mpph11   |        917 | 12344895.22
 mpph11   |        685 | 11950940.60
 mpph11   |       1081 | 10580686.59
 mpph11   |       1011 |  9608892.80
 mpph11   |        623 |  9343081.80
 mpph11   |        787 |  8569925.48
 mpph11   |       1185 |  8073895.00
 mpph11   |        367 |  7883443.69
 mpph11   |        109 |  7657641.60
 mpph11   |       1451 |  7613526.60
 mpph11   |       1899 |  7550881.80
 mpph11   |       1842 |  7505106.20
 mpph11   |        213 |  7479470.28
 mpph11   |        161 |  7398630.95
 mpph11   |       1416 |  7287490.02
 mpph11   |       1309 |  7213260.60
 mpph11   |        949 |  7197510.84
 mpph11   |       1323 |  7140115.71
 mpph11   |       1046 |  7046743.50
 mpph11   |         69 |  6970845.15
 mpph11   |       1581 |  6760133.10
 mpph11   |        862 |  6658234.84
 mpph11   |       1283 |  6609824.32
 mpph11   |       1277 |  6599037.12
 mpph11   |        828 |  6565785.62
 mpph11   |       1536 |  6561151.80
 mpph11   |        207 |  6537250.98
 mpph11   |       1085 |  6537104.27
 mpph11   |        751 |  6531660.40
 mpph11   |        360 |  6530297.41
 mpph11   |       1984 |  6495512.50
 mpph11   |        765 |  6460546.80
 mpph11   |       1917 |  6227301.68
 mpph11   |       1716 |  6116013.75
 mpph11   |        730 |  6100067.88
 mpph11   |        994 |  6032702.08
 mpph11   |       1144 |  6012205.92
 mpph11   |       1108 |  5914872.72
 mpph11   |       1950 |  5912352.20
 mpph11   |       1963 |  5873329.44
 mpph11   |         26 |  5867999.40
 mpph11   |        983 |  5846645.17
 mpph11   |       1808 |  5835183.38
 mpph11   |        504 |  5770344.51
 mpph11   |       1016 |  5718859.87
 mpph11   |       1494 |  5687809.60
 mpph11   |       1551 |  5668132.44
 mpph11   |        262 |  5625893.82
 mpph11   |        465 |  5537420.64
 mpph11   |        125 |  5533747.40
 mpph11   |       1972 |  5526059.28
 mpph11   |       1125 |  5514223.46
 mpph11   |        601 |  5513532.30
 mpph11   |        886 |  5450951.91
 mpph11   |        173 |  5409250.08
 mpph11   |       1752 |  5389034.04
 mpph11   |       1644 |  5387317.60
 mpph11   |        526 |  5350481.57
 mpph11   |        895 |  5346555.18
 mpph11   |       1576 |  5301661.68
 mpph11   |        692 |  5269557.57
 mpph11   |        951 |  5264770.02
 mpph11   |        861 |  5214617.22
 mpph11   |       1545 |  5196334.26
 mpph11   |       1356 |  5192649.28
 mpph11   |        789 |  5162645.80
 mpph11   |       1516 |  5107050.00
 mpph11   |       1616 |  5091834.00
 mpph11   |       1116 |  4992110.70
 mpph11   |        551 |  4982558.21
 mpph11   |       1887 |  4934262.24
 mpph11   |        885 |  4876658.57
 mpph11   |        116 |  4852263.60
 mpph11   |        251 |  4747015.56
 mpph11   |        394 |  4624460.10
 mpph11   |       1091 |  4589240.04
 mpph11   |        329 |  4558084.80
 mpph11   |        632 |  4494879.28
 mpph11   |       1485 |  4482428.50
 mpph11   |       1725 |  4340873.16
 mpph11   |        816 |  4326623.61
 mpph11   |        699 |  4310431.00
 mpph11   |        403 |  4283221.60
 mpph11   |       1768 |  4251602.98
 mpph11   |       1158 |  4229896.16
 mpph11   |        591 |  4216726.24
 mpph11   |       1248 |  4157093.60
 mpph11   |       1679 |  4156156.64
 mpph11   |        663 |  4142402.22
 mpph11   |       1719 |  4101486.48
 mpph11   |        395 |  4052997.76
 mpph11   |       1351 |  4045565.12
 mpph11   |        531 |  4042060.39
 mpph11   |       1951 |  4023967.36
 mpph11   |       1294 |  4009307.81
 mpph11   |        616 |  4004057.26
 mpph11   |        316 |  3986943.88
 mpph11   |       1928 |  3964898.76
 mpph11   |       1337 |  3951488.10
 mpph11   |       1851 |  3918641.34
 mpph11   |        521 |  3913058.16
 mpph11   |        883 |  3908087.82
 mpph11   |        961 |  3814756.38
 mpph11   |        366 |  3812257.88
 mpph11   |       1875 |  3800216.84
 mpph11   |        668 |  3772880.16
 mpph11   |        107 |  3756380.24
 mpph11   |       1061 |  3747377.84
 mpph11   |         16 |  3745783.12
 mpph11   |        294 |  3744033.70
 mpph11   |       1561 |  3711744.00
 mpph11   |       1574 |  3702071.64
 mpph11   |       1732 |  3695765.58
 mpph11   |        564 |  3680200.80
 mpph11   |       1371 |  3677874.16
 mpph11   |        516 |  3664770.45
 mpph11   |       1585 |  3641002.20
 mpph11   |        755 |  3635116.80
 mpph11   |        959 |  3620453.76
 mpph11   |        190 |  3559078.95
 mpph11   |       1194 |  3479709.09
 mpph11   |        416 |  3452131.59
 mpph11   |        333 |  3446486.38
 mpph11   |        377 |  3359789.30
 mpph11   |       1455 |  3342304.35
 mpph11   |        289 |  3270429.10
 mpph11   |        689 |  3260147.55
 mpph11   |       1919 |  3239067.00
 mpph11   |       1603 |  3194711.46
 mpph11   |       1438 |  3163393.12
 mpph11   |       1777 |  3107373.72
 mpph11   |         11 |  3035887.92
 mpph11   |       1340 |  3030301.09
 mpph11   |       1287 |  2985392.48
 mpph11   |       1347 |  2983078.12
 mpph11   |       1205 |  2971470.28
 mpph11   |        285 |  2967973.75
 mpph11   |        357 |  2967100.97
 mpph11   |        429 |  2962631.88
 mpph11   |         91 |  2951493.40
 mpph11   |       1161 |  2928475.76
 mpph11   |        914 |  2927894.16
 mpph11   |       1962 |  2925555.12
 mpph11   |       1483 |  2918425.86
 mpph11   |        561 |  2904720.39
 mpph11   |        258 |  2895651.20
 mpph11   |        194 |  2840047.13
 mpph11   |       1671 |  2818290.28
 mpph11   |       1477 |  2777362.76
 mpph11   |       1505 |  2766157.98
 mpph11   |        332 |  2741984.16
 mpph11   |        301 |  2737431.90
 mpph11   |        729 |  2706503.68
 mpph11   |        654 |  2662180.27
 mpph11   |        142 |  2647051.80
 mpph11   |        164 |  2643604.15
 mpph11   |       1662 |  2642551.92
 mpph11   |       1554 |  2639338.38
 mpph11   |        280 |  2631317.56
 mpph11   |       1541 |  2603175.96
 mpph11   |       1610 |  2463001.95
 mpph11   |        407 |  2460304.47
 mpph11   |        199 |  2442107.46
 mpph11   |        534 |  2420752.38
 mpph11   |       1313 |  2408870.75
 mpph11   |       1759 |  2387379.32
 mpph11   |       1115 |  2321227.26
 mpph11   |       1251 |  2311454.53
 mpph11   |       1285 |  2260852.77
 mpph11   |        159 |  2256004.65
 mpph11   |       1973 |  2243745.69
 mpph11   |       1638 |  2232762.96
 mpph11   |       1774 |  2217104.85
 mpph11   |        556 |  2195013.90
 mpph11   |       1694 |  2163305.16
 mpph11   |        819 |  2152055.50
 mpph11   |        992 |  2121582.28
 mpph11   |        785 |  2121133.75
 mpph11   |       1985 |  2069183.28
 mpph11   |        794 |  2059945.54
 mpph11   |        498 |  2055444.32
 mpph11   |       1385 |  2051890.11
 mpph11   |       1916 |  2032768.96
 mpph11   |        361 |  2017055.81
 mpph11   |         76 |  2012711.58
 mpph11   |       1873 |  2000792.40
 mpph11   |         94 |  1986087.48
 mpph11   |       1651 |  1980440.40
 mpph11   |       1059 |  1959087.04
 mpph11   |       1122 |  1942108.90
 mpph11   |        261 |  1928153.10
 mpph11   |       1861 |  1928114.84
 mpph11   |        461 |  1877992.32
 mpph11   |        224 |  1863852.24
 mpph11   |       1242 |  1851493.60
 mpph11   |       1634 |  1743866.22
 mpph11   |        761 |  1741958.65
 mpph11   |       1080 |  1741751.34
 mpph11   |        338 |  1724805.12
 mpph11   |        661 |  1709946.82
 mpph11   |        388 |  1696006.86
 mpph11   |        231 |  1655972.00
 mpph11   |        525 |  1633729.79
 mpph11   |       1906 |  1626282.30
 mpph11   |         85 |  1599847.56
 mpph11   |         60 |  1579401.77
 mpph11   |        926 |  1570368.78
 mpph11   |       1511 |  1569870.02
 mpph11   |       1113 |  1516263.20
 mpph11   |       1089 |  1477486.65
 mpph11   |       1422 |  1435904.00
 mpph11   |        458 |  1433040.45
 mpph11   |       1907 |  1421100.55
 mpph11   |        323 |  1419854.80
 mpph11   |        851 |  1400193.30
 mpph11   |         44 |  1353557.34
 mpph11   |        595 |  1350125.70
 mpph11   |       1822 |  1337990.67
 mpph11   |          1 |  1333528.04
 mpph11   |       1710 |  1331788.48
 mpph11   |         61 |  1322305.60
 mpph11   |        798 |  1313571.96
 mpph11   |        784 |  1309867.02
 mpph11   |        651 |  1307083.56
 mpph11   |       1468 |  1302397.20
 mpph11   |       1149 |  1289607.35
 mpph11   |       1179 |  1242058.40
 mpph11   |        818 |  1225981.68
 mpph11   |       1189 |  1204828.08
 mpph11   |        797 |  1181263.32
 mpph11   |       1375 |  1178128.60
 mpph11   |       1015 |  1164198.48
 mpph11   |       1994 |  1149222.96
 mpph11   |         66 |  1148101.44
 mpph11   |       1929 |  1131697.92
 mpph11   |        240 |  1126682.48
 mpph11   |       1378 |  1121941.05
 mpph11   |        762 |  1109467.26
 mpph11   |        586 |  1108200.58
 mpph11   |        716 |  1107627.42
 mpph11   |        752 |  1102384.63
 mpph11   |       1220 |  1083540.00
 mpph11   |       1675 |  1064600.76
 mpph11   |       1380 |  1020105.06
 mpph11   |        204 |  1014095.32
 mpph11   |       1214 |  1013602.86
 mpph11   |       1186 |  1006354.08
 mpph11   |        927 |  1003227.51
 mpph11   |       1473 |   997508.48
 mpph11   |       1701 |   994231.40
 mpph11   |        168 |   988803.90
 mpph11   |        852 |   977609.14
 mpph11   |        235 |   977200.14
 mpph11   |        501 |   961161.66
 mpph11   |       1620 |   950561.25
 mpph11   |       1709 |   927244.00
 mpph11   |       1565 |   921078.22
 mpph11   |        960 |   913060.80
 mpph11   |        385 |   910892.90
 mpph11   |       1434 |   905713.25
 mpph11   |        658 |   894649.92
 mpph11   |       1865 |   886024.01
 mpph11   |        487 |   883607.88
 mpph11   |       1279 |   877210.28
 mpph11   |       1211 |   875261.76
 mpph11   |        555 |   869246.77
 mpph11   |       1521 |   866284.81
 mpph11   |        427 |   839771.02
 mpph11   |       1628 |   832363.52
 mpph11   |        297 |   832286.88
 mpph11   |       1051 |   824164.90
 mpph11   |        185 |   794405.50
 mpph11   |       1412 |   793718.80
 mpph11   |        432 |   782403.82
 mpph11   |        216 |   776184.13
 mpph11   |       1056 |   772092.44
 mpph11   |        494 |   768524.43
 mpph11   |       1446 |   746482.32
 mpph11   |       1661 |   733795.56
 mpph11   |       1274 |   711073.48
 mpph11   |        451 |   676703.28
 mpph11   |       1685 |   661635.90
 mpph11   |       1143 |   660014.26
 mpph11   |       1318 |   655995.66
 mpph11   |       1531 |   649589.40
 mpph11   |       1514 |   627482.08
 mpph11   |       1612 |   626730.56
 mpph11   |        948 |   622068.66
 mpph11   |        571 |   619871.04
 mpph11   |       1767 |   614422.00
 mpph11   |        351 |   601983.45
 mpph11   |       1499 |   594599.22
 mpph11   |       1941 |   594211.48
 mpph11   |       1153 |   584114.56
 mpph11   |       1257 |   580110.85
 mpph11   |       1461 |   576845.88
 mpph11   |       1361 |   570409.02
 mpph11   |       1250 |   567963.36
 mpph11   |        422 |   530847.10
 mpph11   |       1653 |   525077.35
 mpph11   |       1669 |   513932.46
 mpph11   |       1596 |   505225.82
 mpph11   |        850 |   483358.05
 mpph11   |       1151 |   481433.04
 mpph11   |         86 |   471697.70
 mpph11   |        894 |   465151.80
 mpph11   |         19 |   464872.80
 mpph11   |        474 |   455889.28
 mpph11   |        493 |   455628.44
 mpph11   |        267 |   453340.80
 mpph11   |       1856 |   450086.28
 mpph11   |       1830 |   446553.54
 mpph11   |        456 |   439968.00
 mpph11   |        305 |   421891.68
 mpph11   |       1594 |   417994.09
 mpph11   |       1894 |   414577.35
 mpph11   |       1240 |   413718.76
 mpph11   |         35 |   398837.24
 mpph11   |       1180 |   391898.15
 mpph11   |       1794 |   355474.42
 mpph11   |       1024 |   319659.12
 mpph11   |        594 |   315583.24
 mpph11   |         10 |   314550.82
 mpph11   |       1953 |   314372.14
 mpph11   |       1261 |   312283.65
 mpph11   |       1832 |   308459.25
 mpph11   |       1785 |   300945.33
 mpph11   |        138 |   298832.01
 mpph11   |        753 |   297884.88
 mpph11   |       1790 |   277454.80
 mpph11   |        133 |   262568.64
 mpph11   |         51 |   260089.38
 mpph11   |        620 |   246511.60
 mpph11   |       1961 |   232870.27
 mpph11   |       1224 |   227429.47
 mpph11   |        183 |   225827.28
 mpph11   |       1735 |   219074.20
 mpph11   |       1816 |   218339.50
 mpph11   |       1743 |   217085.97
 mpph11   |        985 |   182239.20
 mpph11   |       1761 |   182100.00
 mpph11   |        464 |   179639.88
 mpph11   |        817 |   170795.52
 mpph11   |        485 |   170664.12
 mpph11   |       1818 |   161250.35
 mpph11   |        630 |   158427.72
 mpph11   |       1571 |   156406.05
 mpph11   |       1094 |   155577.60
 mpph11   |        436 |   147283.92
 mpph11   |        916 |   146788.80
 mpph11   |        310 |   145905.18
 mpph11   |       1751 |   140193.69
 mpph11   |        993 |   136907.25
 mpph11   |       1050 |   136152.30
 mpph11   |       1394 |   120166.11
 mpph11   |       1177 |   115967.72
 mpph11   |        151 |   110222.90
(357 rows)

select  'mpph12',
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	co_orders,
	co_lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('RAIL', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= date '1993-01-01'
	and l_receiptdate < date '1993-01-01' + interval '1 year'
group by
	l_shipmode
order by
	l_shipmode;
 ?column? | l_shipmode | high_line_count | low_line_count 
----------+------------+-----------------+----------------
 mpph12   | MAIL       |              41 |             99
 mpph12   | RAIL       |              54 |            102
(2 rows)

select  'mpph13',
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey)
		from
			co_customer left outer join co_orders on
				c_custkey = o_custkey
				and o_comment not like '%express%deposits%'
		group by
			c_custkey
	) as c_orders (c_custkey, c_count)
group by
	c_count
order by
	custdist desc,
	c_count desc;
 ?column? | c_count | custdist 
----------+---------+----------
 mpph13   |       0 |      500
 mpph13   |      11 |       66
 mpph13   |      10 |       64
 mpph13   |       8 |       63
 mpph13   |      12 |       61
 mpph13   |       9 |       60
 mpph13   |      20 |       58
 mpph13   |      13 |       58
 mpph13   |      14 |       53
 mpph13   |      15 |       48
 mpph13   |       7 |       47
 mpph13   |      18 |       43
 mpph13   |      17 |       40
 mpph13   |      21 |       38
 mpph13   |      16 |       38
 mpph13   |      19 |       36
 mpph13   |       6 |       35
 mpph13   |      22 |       34
 mpph13   |      24 |       32
 mpph13   |      23 |       30
 mpph13   |      25 |       22
 mpph13   |      26 |       19
 mpph13   |       5 |       13
 mpph13   |      27 |       10
 mpph13   |      28 |        9
 mpph13   |       4 |        7
 mpph13   |      32 |        4
 mpph13   |      30 |        4
 mpph13   |      29 |        3
 mpph13   |       3 |        2
 mpph13   |       2 |        2
 mpph13   |      31 |        1
(32 rows)

select  'mpph14',
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	co_lineitem,
	co_part
where
	l_partkey = p_partkey
	and l_shipdate >= date '1993-01-01'
	and l_shipdate < date '1993-01-01' + interval '1 month';
 ?column? |    promo_revenue    
----------+---------------------
 mpph14   | 11.5452471385458443
(1 row)

create view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		co_lineitem
	where
		l_shipdate >= date '1993-01-01'
		and l_shipdate < date '1993-01-01' + interval '3 month'
	group by
		l_suppkey;
select  'mpph15',
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	co_supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;
 ?column? | s_suppkey |          s_name           |          s_address          |     s_phone     | total_revenue 
----------+-----------+---------------------------+-----------------------------+-----------------+---------------
 mpph15   |        84 | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx | 34-869-118-7803 |  1134618.0543
(1 row)

drop view revenue0;
select 'mpph16',
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	co_part, 
	co_partsupp left join co_supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
 ?column? |  p_brand   |          p_type           | p_size | supplier_cnt 
----------+------------+---------------------------+--------+--------------
 mpph16   | Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 mpph16   | Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 mpph16   | Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 mpph16   | Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 mpph16   | Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 mpph16   | Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 mpph16   | Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 mpph16   | Brand#11   | SMALL PLATED COPPER       |     46 |            4
 mpph16   | Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 mpph16   | Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 mpph16   | Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 mpph16   | Brand#11   | STANDARD PLATED TIN       |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 mpph16   | Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 mpph16   | Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 mpph16   | Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 mpph16   | Brand#12   | LARGE PLATED COPPER       |     46 |            4
 mpph16   | Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 mpph16   | Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 mpph16   | Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 mpph16   | Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 mpph16   | Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 mpph16   | Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 mpph16   | Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 mpph16   | Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 mpph16   | Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 mpph16   | Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 mpph16   | Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 mpph16   | Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 mpph16   | Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 mpph16   | Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 mpph16   | Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 mpph16   | Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 mpph16   | Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 mpph16   | Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 mpph16   | Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 mpph16   | Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 mpph16   | Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 mpph16   | Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 mpph16   | Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 mpph16   | Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 mpph16   | Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 mpph16   | Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 mpph16   | Brand#15   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 mpph16   | Brand#15   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 mpph16   | Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 mpph16   | Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 mpph16   | Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 mpph16   | Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 mpph16   | Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 mpph16   | Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 mpph16   | Brand#21   | LARGE POLISHED TIN        |     20 |            4
 mpph16   | Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 mpph16   | Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 mpph16   | Brand#21   | PROMO PLATED COPPER       |     20 |            4
 mpph16   | Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 mpph16   | Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 mpph16   | Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 mpph16   | Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 mpph16   | Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 mpph16   | Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 mpph16   | Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 mpph16   | Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 mpph16   | Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 mpph16   | Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 mpph16   | Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 mpph16   | Brand#23   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 mpph16   | Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 mpph16   | Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 mpph16   | Brand#23   | SMALL PLATED TIN          |     42 |            4
 mpph16   | Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 mpph16   | Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 mpph16   | Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 mpph16   | Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 mpph16   | Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 mpph16   | Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 mpph16   | Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 mpph16   | Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 mpph16   | Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 mpph16   | Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 mpph16   | Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 mpph16   | Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 mpph16   | Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 mpph16   | Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 mpph16   | Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 mpph16   | Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 mpph16   | Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 mpph16   | Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 mpph16   | Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 mpph16   | Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 mpph16   | Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 mpph16   | Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 mpph16   | Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 mpph16   | Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 mpph16   | Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 mpph16   | Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 mpph16   | Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 mpph16   | Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 mpph16   | Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 mpph16   | Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 mpph16   | Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 mpph16   | Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#32   | SMALL PLATED BRASS        |     31 |            4
 mpph16   | Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 mpph16   | Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 mpph16   | Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 mpph16   | Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 mpph16   | Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 mpph16   | Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 mpph16   | Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 mpph16   | Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 mpph16   | Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 mpph16   | Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 mpph16   | Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 mpph16   | Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 mpph16   | Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 mpph16   | Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 mpph16   | Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 mpph16   | Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 mpph16   | Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 mpph16   | Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 mpph16   | Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 mpph16   | Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 mpph16   | Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 mpph16   | Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 mpph16   | Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 mpph16   | Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 mpph16   | Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 mpph16   | Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 mpph16   | Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 mpph16   | Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 mpph16   | Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 mpph16   | Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 mpph16   | Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 mpph16   | Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 mpph16   | Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 mpph16   | Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 mpph16   | Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 mpph16   | Brand#42   | PROMO POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     15 |            4
 mpph16   | Brand#42   | SMALL POLISHED TIN        |     24 |            4
 mpph16   | Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 mpph16   | Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 mpph16   | Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 mpph16   | Brand#43   | LARGE PLATED COPPER       |     22 |            4
 mpph16   | Brand#43   | LARGE PLATED TIN          |     24 |            4
 mpph16   | Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 mpph16   | Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 mpph16   | Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 mpph16   | Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 mpph16   | Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 mpph16   | Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 mpph16   | Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 mpph16   | Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 mpph16   | Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 mpph16   | Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 mpph16   | Brand#45   | LARGE PLATED STEEL        |     22 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 mpph16   | Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 mpph16   | Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 mpph16   | Brand#45   | SMALL PLATED COPPER       |     15 |            4
 mpph16   | Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 mpph16   | Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 mpph16   | Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 mpph16   | Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 mpph16   | Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 mpph16   | Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 mpph16   | Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 mpph16   | Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 mpph16   | Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 mpph16   | Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 mpph16   | Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 mpph16   | Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 mpph16   | Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 mpph16   | Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 mpph16   | Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 mpph16   | Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 mpph16   | Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 mpph16   | Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 mpph16   | Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 mpph16   | Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 mpph16   | Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 mpph16   | Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 mpph16   | Brand#52   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 mpph16   | Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 mpph16   | Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 mpph16   | Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 mpph16   | Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 mpph16   | Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 mpph16   | Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 mpph16   | Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 mpph16   | Brand#53   | SMALL PLATED STEEL        |     31 |            4
 mpph16   | Brand#53   | SMALL POLISHED TIN        |     42 |            4
 mpph16   | Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 mpph16   | Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 mpph16   | Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 mpph16   | Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 mpph16   | Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 mpph16   | Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 mpph16   | Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 mpph16   | Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 mpph16   | Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 mpph16   | Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 mpph16   | Brand#54   | SMALL POLISHED TIN        |     46 |            4
 mpph16   | Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 mpph16   | Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 mpph16   | Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 mpph16   | Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 mpph16   | Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 mpph16   | Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 mpph16   | Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 mpph16   | Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 mpph16   | Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 mpph16   | Brand#55   | LARGE POLISHED TIN        |     42 |            4
 mpph16   | Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 mpph16   | Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 mpph16   | Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 mpph16   | Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	co_partsupp,
	co_part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			co_supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select 'mpph17',
      sum(l_extendedprice) / 7.0 as avg_yearly
from
      co_lineitem,
      (
          select
              p_partkey as x_partkey,
              0.2 * avg(l_quantity) as x_avg_20
          from
              co_part,
              co_lineitem
          where
              p_partkey = l_partkey
              and p_brand = 'Brand#32'
              and p_container = 'JUMBO PACK'
          group by
              p_partkey
      ) x
where
      x_partkey = l_partkey
and l_quantity < x_avg_20;
 ?column? |      avg_yearly       
----------+-----------------------
 mpph17   | 1278.3700000000000000
(1 row)

select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	co_lineitem,
	co_part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#32'
	and p_container = 'JUMBO PACK'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			co_lineitem
		where
			l_partkey = p_partkey
	);
      avg_yearly       
-----------------------
 1278.3700000000000000
(1 row)

select  'mpph18',
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	co_customer,
	co_orders,
	co_lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			co_lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 300
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
 ?column? |       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice |  sum   
----------+--------------------+-----------+------------+-------------+--------------+--------
 mpph18   | Customer#000000667 |       667 |      29158 | 10-21-1995  |    439687.23 | 305.00
 mpph18   | Customer#000000178 |       178 |       6882 | 04-09-1997  |    422359.65 | 303.00
(2 rows)

select  'mpph19',
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	co_lineitem,
	co_part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#23'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 1 and l_quantity <= 1 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#53'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 10 and l_quantity <= 10 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#21'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
 ?column? |  revenue   
----------+------------
 mpph19   | 10604.0448
(1 row)

select  'mpph20',
	s_name,
	s_address 
from 
	co_supplier, 
	co_nation 
where 
	s_suppkey in( 
		select 
			ps_suppkey 
		from 
			co_partsupp, 
			( 
				select 
					sum(l_quantity) as qty_sum, l_partkey, l_suppkey 
				from 
					co_lineitem 
				where 
					l_shipdate >= date '1996-01-01' 
					and l_shipdate < date '1996-01-01' + interval '1 year' 
				group by l_partkey, l_suppkey ) g 
		where 
			g.l_partkey = ps_partkey 
			and g.l_suppkey = ps_suppkey 
			and ps_availqty > 0.5 * g.qty_sum 
			and ps_partkey in ( select p_partkey from co_part where p_name like 'medium%' ) 
		) 
	and s_nationkey = n_nationkey 
	and n_name = 'UNITED STATES'
order by 
	s_name;
 ?column? |          s_name           |                s_address                 
----------+---------------------------+------------------------------------------
 mpph20   | Supplier#000000010        | Saygah3gYWMp72i PY
 mpph20   | Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 mpph20   | Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 mpph20   | Supplier#000000049        | Nvq 6macF4GtJvz
 mpph20   | Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 mpph20   | Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select
	s_name,
	s_address
from
	co_supplier,
	co_nation
where
	s_suppkey in (
		select
			ps_suppkey
		from
			co_partsupp
		where
			ps_partkey in (
				select
					p_partkey
				from
					co_part
				where
					p_name like 'medium%'
			)
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					co_lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= date '1996-01-01'
					and l_shipdate < date '1996-01-01' + interval '1 year'
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
order by
	s_name;
          s_name           |                s_address                 
---------------------------+------------------------------------------
 Supplier#000000010        | Saygah3gYWMp72i PY
 Supplier#000000019        | edZT3es,nBFD8lBXTGeTl
 Supplier#000000046        | e0URUXfDOYMdKe16Z5h5StMRbzGmTs,D2cjap
 Supplier#000000049        | Nvq 6macF4GtJvz
 Supplier#000000064        | w80JjnIP lGoLdUjRutbv81gGlqqpW4PQBeOtSYU
 Supplier#000000084        | DcYjWMiZGQqEKOJi4wAmIV08ikx
(6 rows)

select  'mpph21',
	s_name, 
	count(distinct(l1.l_orderkey::text||l1.l_linenumber::text)) as numwait 
from 
	co_supplier, 
	co_orders, 
	co_nation, 
	co_lineitem l1 
		left join co_lineitem l2 
			on (l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) 
		left join (
			select 
				l3.l_orderkey,
				l3.l_suppkey 
			from 
				co_lineitem l3 
			where 
				l3.l_receiptdate > l3.l_commitdate) l4 
			on (l4.l_orderkey = l1.l_orderkey and l4.l_suppkey <> l1.l_suppkey) 
where 
	s_suppkey = l1.l_suppkey 
	and o_orderkey = l1.l_orderkey 
	and o_orderstatus = 'F' 
	and l1.l_receiptdate > l1.l_commitdate 
	and l2.l_orderkey is not null 
	and l4.l_orderkey is null 
	and s_nationkey = n_nationkey 
	and n_name = 'MOZAMBIQUE' 
group by 
	s_name 
order by 
	numwait desc, 
	s_name
LIMIT 100;
 ?column? |          s_name           | numwait 
----------+---------------------------+---------
 mpph21   | Supplier#000000056        |      18
 mpph21   | Supplier#000000073        |      13
 mpph21   | Supplier#000000018        |      12
 mpph21   | Supplier#000000058        |      10
 mpph21   | Supplier#000000030        |       9
 mpph21   | Supplier#000000093        |       9
 mpph21   | Supplier#000000031        |       6
(7 rows)

select  'mpph22',
	cntrycode, 
	count(*) as numcust, 
	sum(c_acctbal) as totacctbal 
from 
	( 
		select 
			substring(c_phone from 1 for 2) as cntrycode, 
			c_acctbal 
		from 
			co_customer left join co_orders 
				on c_custkey = o_custkey 
		where 
			substring(c_phone from 1 for 2) in 
				('11', '28', '21', '26', '19', '13', '22') 
			and c_acctbal > ( 
				select 
					avg(c_acctbal) 
				from 
					co_customer 
				where 
					c_acctbal > 0.00 
					and substring(c_phone from 1 for 2) in 
						('11', '28', '21', '26', '19', '13', '22') 
			) 
			and o_custkey is null 
	) as custsale 
group by 
	cntrycode 
order by 
	cntrycode;
 ?column? | cntrycode | numcust | totacctbal 
----------+-----------+---------+------------
 mpph22   | 11        |      11 |   82845.34
 mpph22   | 13        |      10 |   75359.29
 mpph22   | 19        |      17 |  132118.07
 mpph22   | 21        |       9 |   73087.05
 mpph22   | 22        |       9 |   65544.55
 mpph22   | 26        |       6 |   47747.11
 mpph22   | 28        |      10 |   79310.33
(7 rows)

select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			co_customer
		where
			substring(c_phone from 1 for 2) in
				('11', '28', '21', '26', '19', '13', '22')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					co_customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('11', '28', '21', '26', '19', '13', '22')
			)
			and not exists (
				select
					*
				from
					co_orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;
 cntrycode | numcust | totacctbal 
-----------+---------+------------
 11        |      11 |   82845.34
 13        |      10 |   75359.29
 19        |      17 |  132118.07
 21        |       9 |   73087.05
 22        |       9 |   65544.55
 26        |       6 |   47747.11
 28        |      10 |   79310.33
(7 rows)

select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	co_partsupp,
	co_part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#35'
	and p_type not like 'MEDIUM ANODIZED%'
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			co_supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

select
	p_brand, 
	p_type, 
	p_size, 
	count(distinct ps_suppkey) as supplier_cnt 
from 
	co_part, 
	co_partsupp left join co_supplier on (ps_suppkey=s_suppkey and s_comment like '%Customer%Complaints%' ) 
where 
	p_partkey = ps_partkey 
	and p_brand <> 'Brand#35' 
	and p_type not like 'MEDIUM ANODIZED%' 
	and p_size in (39, 31, 24, 22, 46, 20, 42, 15)
	and s_suppkey is null 
group by 
	p_brand, 
	p_type, 
	p_size 
order by 
	supplier_cnt desc, 
	p_brand, 
	p_type, 
	p_size;
  p_brand   |          p_type           | p_size | supplier_cnt 
------------+---------------------------+--------+--------------
 Brand#41   | MEDIUM BRUSHED BRASS      |     15 |            8
 Brand#51   | STANDARD ANODIZED BRASS   |     22 |            8
 Brand#55   | STANDARD ANODIZED STEEL   |     42 |            8
 Brand#11   | ECONOMY BRUSHED STEEL     |     24 |            4
 Brand#11   | ECONOMY PLATED COPPER     |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     20 |            4
 Brand#11   | LARGE BURNISHED NICKEL    |     39 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     22 |            4
 Brand#11   | PROMO BRUSHED NICKEL      |     24 |            4
 Brand#11   | PROMO BURNISHED TIN       |     42 |            4
 Brand#11   | PROMO PLATED NICKEL       |     22 |            4
 Brand#11   | SMALL BURNISHED COPPER    |     39 |            4
 Brand#11   | SMALL BURNISHED STEEL     |     42 |            4
 Brand#11   | SMALL PLATED COPPER       |     46 |            4
 Brand#11   | STANDARD ANODIZED TIN     |     24 |            4
 Brand#11   | STANDARD BRUSHED STEEL    |     42 |            4
 Brand#11   | STANDARD BURNISHED STEEL  |     20 |            4
 Brand#11   | STANDARD PLATED TIN       |     20 |            4
 Brand#11   | STANDARD POLISHED STEEL   |     20 |            4
 Brand#11   | STANDARD POLISHED TIN     |     39 |            4
 Brand#12   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#12   | ECONOMY PLATED TIN        |     31 |            4
 Brand#12   | LARGE BRUSHED TIN         |     39 |            4
 Brand#12   | LARGE PLATED COPPER       |     46 |            4
 Brand#12   | MEDIUM BRUSHED TIN        |     20 |            4
 Brand#12   | MEDIUM PLATED NICKEL      |     24 |            4
 Brand#12   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#12   | PROMO ANODIZED STEEL      |     46 |            4
 Brand#12   | PROMO BRUSHED STEEL       |     20 |            4
 Brand#12   | PROMO BURNISHED NICKEL    |     20 |            4
 Brand#12   | SMALL ANODIZED BRASS      |     39 |            4
 Brand#12   | SMALL BURNISHED TIN       |     31 |            4
 Brand#12   | SMALL POLISHED COPPER     |     42 |            4
 Brand#12   | STANDARD ANODIZED TIN     |     20 |            4
 Brand#13   | ECONOMY BURNISHED COPPER  |     42 |            4
 Brand#13   | ECONOMY BURNISHED NICKEL  |     20 |            4
 Brand#13   | ECONOMY PLATED STEEL      |     22 |            4
 Brand#13   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#13   | MEDIUM POLISHED BRASS     |     24 |            4
 Brand#13   | PROMO ANODIZED NICKEL     |     39 |            4
 Brand#13   | PROMO POLISHED BRASS      |     31 |            4
 Brand#13   | PROMO POLISHED COPPER     |     15 |            4
 Brand#13   | SMALL BRUSHED COPPER      |     20 |            4
 Brand#13   | STANDARD ANODIZED STEEL   |     20 |            4
 Brand#13   | STANDARD POLISHED COPPER  |     22 |            4
 Brand#13   | STANDARD POLISHED NICKEL  |     46 |            4
 Brand#14   | ECONOMY BRUSHED NICKEL    |     24 |            4
 Brand#14   | ECONOMY BURNISHED COPPER  |     46 |            4
 Brand#14   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#14   | LARGE ANODIZED NICKEL     |     20 |            4
 Brand#14   | LARGE ANODIZED TIN        |     20 |            4
 Brand#14   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#14   | MEDIUM PLATED TIN         |     31 |            4
 Brand#14   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#14   | STANDARD ANODIZED TIN     |     42 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#14   | STANDARD BRUSHED NICKEL   |     46 |            4
 Brand#15   | ECONOMY BRUSHED NICKEL    |     15 |            4
 Brand#15   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#15   | ECONOMY POLISHED COPPER   |     22 |            4
 Brand#15   | ECONOMY POLISHED STEEL    |     24 |            4
 Brand#15   | LARGE BURNISHED BRASS     |     22 |            4
 Brand#15   | LARGE BURNISHED TIN       |     31 |            4
 Brand#15   | LARGE PLATED COPPER       |     22 |            4
 Brand#15   | LARGE POLISHED COPPER     |     24 |            4
 Brand#15   | LARGE POLISHED TIN        |     20 |            4
 Brand#15   | SMALL BRUSHED STEEL       |     20 |            4
 Brand#15   | SMALL BURNISHED STEEL     |     22 |            4
 Brand#15   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#15   | STANDARD PLATED STEEL     |     24 |            4
 Brand#21   | ECONOMY BRUSHED NICKEL    |     39 |            4
 Brand#21   | ECONOMY PLATED BRASS      |     15 |            4
 Brand#21   | ECONOMY PLATED COPPER     |     24 |            4
 Brand#21   | LARGE ANODIZED NICKEL     |     24 |            4
 Brand#21   | LARGE POLISHED TIN        |     20 |            4
 Brand#21   | MEDIUM BRUSHED STEEL      |     42 |            4
 Brand#21   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#21   | PROMO BRUSHED TIN         |     42 |            4
 Brand#21   | PROMO PLATED COPPER       |     20 |            4
 Brand#21   | SMALL BRUSHED BRASS       |     24 |            4
 Brand#21   | SMALL BRUSHED TIN         |     31 |            4
 Brand#21   | STANDARD BRUSHED STEEL    |     20 |            4
 Brand#21   | STANDARD BURNISHED STEEL  |     31 |            4
 Brand#22   | LARGE ANODIZED BRASS      |     31 |            4
 Brand#22   | LARGE BRUSHED NICKEL      |     42 |            4
 Brand#22   | MEDIUM POLISHED COPPER    |     20 |            4
 Brand#22   | SMALL ANODIZED BRASS      |     31 |            4
 Brand#22   | SMALL ANODIZED STEEL      |     22 |            4
 Brand#22   | SMALL BURNISHED NICKEL    |     42 |            4
 Brand#22   | STANDARD ANODIZED STEEL   |     42 |            4
 Brand#22   | STANDARD BRUSHED COPPER   |     22 |            4
 Brand#22   | STANDARD BURNISHED NICKEL |     42 |            4
 Brand#22   | STANDARD PLATED COPPER    |     20 |            4
 Brand#23   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#23   | ECONOMY BRUSHED TIN       |     15 |            4
 Brand#23   | LARGE ANODIZED BRASS      |     20 |            4
 Brand#23   | LARGE POLISHED COPPER     |     42 |            4
 Brand#23   | LARGE POLISHED TIN        |     42 |            4
 Brand#23   | MEDIUM BRUSHED TIN        |     22 |            4
 Brand#23   | MEDIUM POLISHED STEEL     |     46 |            4
 Brand#23   | PROMO BRUSHED TIN         |     15 |            4
 Brand#23   | PROMO BURNISHED BRASS     |     39 |            4
 Brand#23   | SMALL PLATED TIN          |     42 |            4
 Brand#23   | STANDARD BURNISHED BRASS  |     31 |            4
 Brand#23   | STANDARD PLATED NICKEL    |     20 |            4
 Brand#24   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#24   | MEDIUM BURNISHED NICKEL   |     20 |            4
 Brand#24   | MEDIUM POLISHED BRASS     |     42 |            4
 Brand#24   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#24   | SMALL BURNISHED TIN       |     31 |            4
 Brand#24   | STANDARD ANODIZED COPPER  |     24 |            4
 Brand#24   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#25   | ECONOMY POLISHED STEEL    |     39 |            4
 Brand#25   | LARGE ANODIZED TIN        |     42 |            4
 Brand#25   | LARGE BRUSHED TIN         |     31 |            4
 Brand#25   | MEDIUM BRUSHED COPPER     |     39 |            4
 Brand#25   | MEDIUM PLATED BRASS       |     22 |            4
 Brand#25   | MEDIUM PLATED NICKEL      |     20 |            4
 Brand#25   | MEDIUM POLISHED COPPER    |     31 |            4
 Brand#25   | MEDIUM POLISHED NICKEL    |     15 |            4
 Brand#25   | PROMO ANODIZED STEEL      |     22 |            4
 Brand#25   | PROMO ANODIZED TIN        |     31 |            4
 Brand#25   | PROMO POLISHED STEEL      |     20 |            4
 Brand#25   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#25   | SMALL BURNISHED COPPER    |     15 |            4
 Brand#25   | SMALL BURNISHED NICKEL    |     39 |            4
 Brand#25   | STANDARD ANODIZED COPPER  |     22 |            4
 Brand#25   | STANDARD ANODIZED NICKEL  |     42 |            4
 Brand#31   | ECONOMY BRUSHED COPPER    |     24 |            4
 Brand#31   | MEDIUM POLISHED STEEL     |     39 |            4
 Brand#31   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#31   | SMALL BURNISHED COPPER    |     24 |            4
 Brand#31   | SMALL POLISHED BRASS      |     42 |            4
 Brand#31   | STANDARD ANODIZED NICKEL  |     20 |            4
 Brand#31   | STANDARD BURNISHED TIN    |     46 |            4
 Brand#31   | STANDARD PLATED STEEL     |     20 |            4
 Brand#32   | ECONOMY BURNISHED NICKEL  |     42 |            4
 Brand#32   | ECONOMY PLATED COPPER     |     31 |            4
 Brand#32   | ECONOMY POLISHED TIN      |     20 |            4
 Brand#32   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     24 |            4
 Brand#32   | LARGE BRUSHED BRASS       |     31 |            4
 Brand#32   | LARGE BURNISHED STEEL     |     15 |            4
 Brand#32   | MEDIUM POLISHED NICKEL    |     39 |            4
 Brand#32   | PROMO ANODIZED TIN        |     39 |            4
 Brand#32   | PROMO BURNISHED STEEL     |     20 |            4
 Brand#32   | SMALL BRUSHED STEEL       |     39 |            4
 Brand#32   | SMALL PLATED BRASS        |     31 |            4
 Brand#32   | STANDARD BRUSHED NICKEL   |     15 |            4
 Brand#32   | STANDARD BURNISHED NICKEL |     15 |            4
 Brand#32   | STANDARD POLISHED TIN     |     15 |            4
 Brand#33   | ECONOMY BURNISHED STEEL   |     39 |            4
 Brand#33   | ECONOMY POLISHED NICKEL   |     24 |            4
 Brand#33   | PROMO ANODIZED TIN        |     46 |            4
 Brand#33   | SMALL BRUSHED BRASS       |     39 |            4
 Brand#33   | SMALL BRUSHED STEEL       |     42 |            4
 Brand#33   | SMALL BURNISHED TIN       |     31 |            4
 Brand#33   | STANDARD BURNISHED COPPER |     46 |            4
 Brand#33   | STANDARD POLISHED BRASS   |     46 |            4
 Brand#34   | ECONOMY ANODIZED TIN      |     20 |            4
 Brand#34   | ECONOMY BURNISHED BRASS   |     22 |            4
 Brand#34   | ECONOMY PLATED STEEL      |     39 |            4
 Brand#34   | ECONOMY POLISHED STEEL    |     42 |            4
 Brand#34   | LARGE ANODIZED STEEL      |     46 |            4
 Brand#34   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#34   | LARGE BURNISHED TIN       |     20 |            4
 Brand#34   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#34   | MEDIUM BURNISHED TIN      |     20 |            4
 Brand#34   | MEDIUM PLATED STEEL       |     39 |            4
 Brand#34   | PROMO BRUSHED STEEL       |     31 |            4
 Brand#34   | PROMO POLISHED COPPER     |     24 |            4
 Brand#41   | LARGE BURNISHED TIN       |     22 |            4
 Brand#41   | MEDIUM BURNISHED STEEL    |     24 |            4
 Brand#41   | PROMO BURNISHED COPPER    |     20 |            4
 Brand#41   | PROMO BURNISHED TIN       |     24 |            4
 Brand#41   | SMALL BRUSHED NICKEL      |     22 |            4
 Brand#41   | SMALL BRUSHED TIN         |     46 |            4
 Brand#41   | STANDARD ANODIZED BRASS   |     42 |            4
 Brand#41   | STANDARD BRUSHED NICKEL   |     31 |            4
 Brand#41   | STANDARD POLISHED TIN     |     22 |            4
 Brand#42   | ECONOMY BRUSHED STEEL     |     31 |            4
 Brand#42   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     31 |            4
 Brand#42   | ECONOMY PLATED BRASS      |     46 |            4
 Brand#42   | LARGE POLISHED BRASS      |     20 |            4
 Brand#42   | MEDIUM BRUSHED BRASS      |     20 |            4
 Brand#42   | PROMO BRUSHED TIN         |     46 |            4
 Brand#42   | PROMO BURNISHED TIN       |     24 |            4
 Brand#42   | PROMO PLATED NICKEL       |     22 |            4
 Brand#42   | PROMO POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     15 |            4
 Brand#42   | SMALL POLISHED TIN        |     24 |            4
 Brand#42   | STANDARD ANODIZED TIN     |     15 |            4
 Brand#43   | ECONOMY BRUSHED STEEL     |     20 |            4
 Brand#43   | ECONOMY BRUSHED TIN       |     42 |            4
 Brand#43   | ECONOMY POLISHED TIN      |     39 |            4
 Brand#43   | LARGE PLATED COPPER       |     22 |            4
 Brand#43   | LARGE PLATED TIN          |     24 |            4
 Brand#43   | MEDIUM PLATED STEEL       |     42 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     15 |            4
 Brand#43   | PROMO BRUSHED STEEL       |     42 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     20 |            4
 Brand#43   | SMALL ANODIZED BRASS      |     46 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     20 |            4
 Brand#43   | STANDARD BRUSHED COPPER   |     24 |            4
 Brand#44   | ECONOMY ANODIZED BRASS    |     42 |            4
 Brand#44   | ECONOMY BURNISHED BRASS   |     15 |            4
 Brand#44   | LARGE PLATED NICKEL       |     46 |            4
 Brand#44   | PROMO BRUSHED TIN         |     15 |            4
 Brand#45   | ECONOMY BURNISHED BRASS   |     31 |            4
 Brand#45   | ECONOMY BURNISHED NICKEL  |     22 |            4
 Brand#45   | LARGE ANODIZED TIN        |     39 |            4
 Brand#45   | LARGE PLATED STEEL        |     22 |            4
 Brand#45   | MEDIUM POLISHED COPPER    |     15 |            4
 Brand#45   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     22 |            4
 Brand#45   | PROMO ANODIZED BRASS      |     31 |            4
 Brand#45   | SMALL PLATED COPPER       |     15 |            4
 Brand#45   | SMALL POLISHED BRASS      |     31 |            4
 Brand#45   | STANDARD BRUSHED TIN      |     39 |            4
 Brand#45   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#51   | ECONOMY ANODIZED TIN      |     42 |            4
 Brand#51   | ECONOMY BURNISHED COPPER  |     20 |            4
 Brand#51   | ECONOMY PLATED COPPER     |     15 |            4
 Brand#51   | ECONOMY POLISHED STEEL    |     15 |            4
 Brand#51   | LARGE ANODIZED TIN        |     42 |            4
 Brand#51   | LARGE POLISHED NICKEL     |     46 |            4
 Brand#51   | PROMO BURNISHED COPPER    |     39 |            4
 Brand#51   | PROMO BURNISHED STEEL     |     24 |            4
 Brand#51   | SMALL ANODIZED COPPER     |     20 |            4
 Brand#51   | SMALL ANODIZED NICKEL     |     42 |            4
 Brand#51   | SMALL ANODIZED STEEL      |     42 |            4
 Brand#51   | STANDARD PLATED STEEL     |     20 |            4
 Brand#51   | STANDARD POLISHED COPPER  |     20 |            4
 Brand#52   | ECONOMY POLISHED BRASS    |     46 |            4
 Brand#52   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#52   | LARGE POLISHED BRASS      |     39 |            4
 Brand#52   | MEDIUM PLATED NICKEL      |     22 |            4
 Brand#52   | MEDIUM PLATED STEEL       |     20 |            4
 Brand#52   | PROMO BRUSHED STEEL       |     39 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     31 |            4
 Brand#52   | SMALL ANODIZED COPPER     |     42 |            4
 Brand#52   | SMALL BRUSHED TIN         |     31 |            4
 Brand#52   | SMALL POLISHED TIN        |     46 |            4
 Brand#52   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#52   | STANDARD POLISHED BRASS   |     39 |            4
 Brand#52   | STANDARD POLISHED STEEL   |     24 |            4
 Brand#53   | ECONOMY ANODIZED COPPER   |     24 |            4
 Brand#53   | ECONOMY BURNISHED STEEL   |     46 |            4
 Brand#53   | LARGE BRUSHED NICKEL      |     39 |            4
 Brand#53   | LARGE BRUSHED STEEL       |     42 |            4
 Brand#53   | PROMO BRUSHED BRASS       |     42 |            4
 Brand#53   | PROMO BRUSHED COPPER      |     24 |            4
 Brand#53   | PROMO POLISHED BRASS      |     39 |            4
 Brand#53   | SMALL PLATED STEEL        |     31 |            4
 Brand#53   | SMALL POLISHED TIN        |     42 |            4
 Brand#53   | STANDARD ANODIZED NICKEL  |     46 |            4
 Brand#53   | STANDARD BRUSHED STEEL    |     31 |            4
 Brand#53   | STANDARD BURNISHED COPPER |     22 |            4
 Brand#54   | ECONOMY ANODIZED STEEL    |     42 |            4
 Brand#54   | ECONOMY BRUSHED NICKEL    |     42 |            4
 Brand#54   | ECONOMY POLISHED NICKEL   |     22 |            4
 Brand#54   | LARGE BURNISHED COPPER    |     22 |            4
 Brand#54   | LARGE BURNISHED TIN       |     42 |            4
 Brand#54   | MEDIUM POLISHED BRASS     |     22 |            4
 Brand#54   | MEDIUM POLISHED TIN       |     46 |            4
 Brand#54   | PROMO POLISHED NICKEL     |     42 |            4
 Brand#54   | PROMO POLISHED STEEL      |     42 |            4
 Brand#54   | SMALL ANODIZED COPPER     |     24 |            4
 Brand#54   | SMALL POLISHED TIN        |     46 |            4
 Brand#54   | STANDARD ANODIZED BRASS   |     22 |            4
 Brand#54   | STANDARD BRUSHED COPPER   |     15 |            4
 Brand#54   | STANDARD BURNISHED COPPER |     31 |            4
 Brand#55   | ECONOMY ANODIZED STEEL    |     31 |            4
 Brand#55   | ECONOMY BRUSHED BRASS     |     46 |            4
 Brand#55   | ECONOMY PLATED TIN        |     15 |            4
 Brand#55   | ECONOMY POLISHED BRASS    |     24 |            4
 Brand#55   | LARGE BRUSHED COPPER      |     46 |            4
 Brand#55   | LARGE BURNISHED STEEL     |     46 |            4
 Brand#55   | LARGE POLISHED TIN        |     42 |            4
 Brand#55   | SMALL BURNISHED BRASS     |     42 |            4
 Brand#55   | SMALL POLISHED BRASS      |     39 |            4
 Brand#55   | STANDARD ANODIZED NICKEL  |     24 |            4
 Brand#55   | STANDARD PLATED TIN       |     24 |            4
(284 rows)

-- hashagg
set enable_groupagg=off;
set enable_hashagg=on;
select c_nationkey, count(*) from heap_customer group by c_nationkey;
 c_nationkey | count 
-------------+-------
          11 |    58
           9 |    66
          17 |    56
          23 |    56
          21 |    58
          19 |    64
           5 |    57
           3 |    69
           1 |    59
           7 |    57
          13 |    54
          15 |    72
          20 |    67
           2 |    68
          12 |    67
           6 |    36
          24 |    48
           0 |    61
          10 |    72
           4 |    66
          18 |    58
          16 |    62
          14 |    50
          22 |    59
           8 |    60
(25 rows)

set enable_groupagg=off;
set enable_hashagg=on;
select c_nationkey, sum(c_acctbal) from heap_customer group by c_nationkey;
 c_nationkey |    sum    
-------------+-----------
          20 | 368211.36
           2 | 247200.27
          12 | 332485.08
          18 | 291863.05
           6 | 140663.20
          24 | 206281.72
          16 | 284258.05
          14 | 245055.50
          22 | 254970.92
           0 | 248180.19
           8 | 274001.82
          10 | 302886.37
           4 | 272480.14
           3 | 284011.99
          11 | 267563.05
           9 | 328113.13
          17 | 240871.60
           1 | 286203.34
           7 | 243965.66
          23 | 214384.24
          21 | 273301.81
          19 | 252226.32
          13 | 226043.98
           5 | 201760.97
          15 | 394881.83
(25 rows)

set enable_groupagg=off;
set enable_hashagg=on;
select c_mktsegment, bool_and(c_nationkey>10) from heap_customer group by c_mktsegment;
 c_mktsegment | bool_and 
--------------+----------
 AUTOMOBILE   | f
 HOUSEHOLD    | f
 BUILDING     | f
 FURNITURE    | f
 MACHINERY    | f
(5 rows)

set enable_groupagg=off;
set enable_hashagg=on;
select l_returnflag, l_linestatus, variance(l_discount) from heap_lineitem group by l_returnflag, l_linestatus;
 l_returnflag | l_linestatus |        variance        
--------------+--------------+------------------------
 R            | F            | 0.00100441962134177190
 N            | F            | 0.00097536519924475802
 A            | F            | 0.00099926061040172993
 N            | O            | 0.00099711652698710672
(4 rows)

set statement_mem= 10240;
set enable_groupagg=off;
set enable_hashagg=on;
select l_orderkey, l_suppkey, var_pop(l_discount) as var_pop from heap_lineitem group by l_orderkey, l_suppkey order by l_orderkey, l_suppkey, var_pop limit 2000;
 l_orderkey | l_suppkey |          var_pop           
------------+-----------+----------------------------
          1 |        10 |                          0
          1 |        23 |                          0
          1 |        38 |                          0
          1 |        48 |                          0
          1 |        75 |                          0
          1 |        93 |                          0
          2 |        33 |                          0
          3 |        16 |                          0
          3 |        19 |                          0
          3 |        22 |                          0
          3 |        60 |                          0
          3 |        61 |                          0
          3 |        70 |                          0
          4 |        81 |                          0
          5 |         5 |                          0
          5 |        41 |                          0
          5 |        87 |                          0
          6 |        36 |                          0
          7 |        17 |                          0
          7 |        26 |                          0
          7 |        32 |                          0
          7 |        40 |                          0
          7 |        51 |                          0
          7 |        54 |                          0
          7 |        93 |                          0
         32 |        25 |                          0
         32 |        44 |                          0
         32 |        72 |                          0
         32 |        79 |                          0
         32 |        93 |                          0
         32 |        95 |                          0
         33 |         8 |                          0
         33 |        14 |                          0
         33 |        41 |                          0
         33 |        69 |                          0
         34 |        18 |                          0
         34 |        29 |                          0
         34 |        79 |                          0
         35 |        21 |                          0
         35 |        31 |                          0
         35 |        37 |                          0
         35 |        62 |                          0
         35 |        73 |                          0
         35 |        86 |                          0
         36 |        99 |                          0
         37 |        43 |                          0
         37 |        55 |                          0
         37 |        57 |                          0
         38 |        44 |                          0
         39 |         7 |                          0
         39 |        34 |                          0
         39 |        73 |                          0
         39 |        79 |                          0
         39 |        96 |                          0
         39 |       100 |                          0
         64 |        61 |                          0
         65 |         4 |                          0
         65 |        40 |                          0
         65 |        58 |                          0
         66 |        36 |                          0
         66 |        89 |                          0
         67 |        27 |                          0
         67 |        57 |                          0
         67 |        77 |                          0
         67 |        79 |                          0
         67 |        95 |                          0
         67 |        99 |                          0
         68 |        32 |                          0
         68 |        51 |                          0
         68 |        62 | 0.000100000000000000000000
         68 |        79 | 0.000100000000000000000000
         68 |        97 |                          0
         69 |        13 |     0.00022500000000000000
         69 |        33 |                          0
         69 |        88 |                          0
         69 |        90 |     0.00090000000000000000
         70 |         5 |                          0
         70 |        17 |                          0
         70 |        26 |                          0
         70 |        29 |                          0
         70 |        48 |                          0
         70 |        51 |                          0
         71 |         2 |                          0
         71 |        21 |                          0
         71 |        30 |                          0
         71 |        46 |                          0
         71 |        54 |                          0
         71 |        69 |                          0
         96 |        43 |                          0
         96 |        55 |                          0
         97 |        26 |                          0
         97 |        32 |                          0
         97 |        74 |                          0
         98 |         4 |     0.00090000000000000000
         98 |        49 |                          0
         98 |        73 |                          0
         99 |        20 |                          0
         99 |        39 |                          0
         99 |        56 |                          0
         99 |        72 |                          0
        100 |        22 |                          0
        100 |        26 |                          0
        100 |        38 |                          0
        100 |        92 |                          0
        100 |        97 |                          0
        101 |        58 |                          0
        101 |        92 |                          0
        101 |       100 |                          0
        102 |         6 |                          0
        102 |        17 |                          0
        102 |        57 |                          0
        102 |        68 |                          0
        103 |        32 |                          0
        103 |        46 |                          0
        103 |        80 |                          0
        103 |        86 |                          0
        128 |         5 |                          0
        129 |        24 |                          0
        129 |        29 |                          0
        129 |        53 |                          0
        129 |        55 |                          0
        129 |        68 |                          0
        129 |        69 |                          0
        129 |        99 |                          0
        130 |        20 |                          0
        130 |        44 |                          0
        130 |        55 |                          0
        130 |        66 |                          0
        130 |        90 |                          0
        131 |         2 |                          0
        131 |        18 |                          0
        131 |        35 |                          0
        132 |        45 |                          0
        132 |        46 |                          0
        132 |        63 |                          0
        132 |        92 |                          0
        133 |        71 |                          0
        133 |        83 |                          0
        133 |        90 |                          0
        133 |        99 |                          0
        134 |         8 |                          0
        134 |        30 |                          0
        134 |        42 |                          0
        134 |        53 |                          0
        134 |        70 |                          0
        134 |        71 |                          0
        135 |         3 |                          0
        135 |        17 |                          0
        135 |        40 |                          0
        135 |        59 |                          0
        135 |        84 |                          0
        135 |        97 |                          0
        160 |         1 |                          0
        160 |        56 |                          0
        160 |        98 |                          0
        161 |        35 |                          0
        162 |        80 |                          0
        163 |         9 |                          0
        163 |        72 |                          0
        163 |        98 |     0.00040000000000000000
        163 |        99 |                          0
        163 |       100 |                          0
        164 |         3 |                          0
        164 |        38 |                          0
        164 |        49 |                          0
        164 |        55 |                          0
        164 |        57 |                          0
        164 |        68 |                          0
        164 |        90 |                          0
        165 |        41 |                          0
        165 |        69 |                          0
        165 |        77 |                          0
        165 |        89 |                          0
        165 |        92 |                          0
        166 |        12 |                          0
        166 |        32 |                          0
        166 |        65 |                          0
        166 |        81 |                          0
        167 |        13 |                          0
        167 |        59 |                          0
        192 |        38 |                          0
        192 |        40 |                          0
        192 |        51 |                          0
        192 |        76 |                          0
        192 |        97 |     0.00040000000000000000
        193 |        61 |                          0
        193 |        62 |                          0
        193 |        74 |                          0
        194 |        21 |                          0
        194 |        23 |                          0
        194 |        30 |                          0
        194 |        52 |                          0
        194 |        53 |                          0
        194 |        54 |                          0
        194 |        80 |                          0
        195 |        13 |                          0
        195 |        42 |                          0
        195 |        89 | 0.000100000000000000000000
        196 |        25 |                          0
        196 |        28 |                          0
        197 |        15 |                          0
        197 |        20 |                          0
        197 |        30 |                          0
        197 |        33 |                          0
        197 |        45 |                          0
        197 |       100 |                          0
        198 |        21 |                          0
        198 |        31 |                          0
        198 |        60 |                          0
        198 |        62 |                          0
        198 |        80 |                          0
        199 |        36 |                          0
        199 |        41 |                          0
        224 |         3 |                          0
        224 |         8 |                          0
        224 |        23 |                          0
        224 |        30 |                          0
        224 |        47 |                          0
        224 |        92 |                          0
        225 |         1 |                          0
        225 |        21 |     0.00202500000000000000
        225 |        31 |                          0
        225 |        34 |                          0
        225 |        52 |                          0
        225 |        72 |                          0
        226 |         5 |                          0
        226 |        59 |                          0
        226 |        89 | 0.000100000000000000000000
        226 |        94 |                          0
        226 |        95 |                          0
        226 |        97 |                          0
        227 |        69 |                          0
        227 |        78 |                          0
        228 |        67 |                          0
        229 |         3 |                          0
        229 |        33 |                          0
        229 |        55 |                          0
        229 |        87 |                          0
        229 |        90 |                          0
        229 |        91 |                          0
        230 |        18 |                          0
        230 |        25 |                          0
        230 |        46 |                          0
        230 |        50 |                          0
        230 |        69 |                          0
        230 |        95 |                          0
        231 |        27 |                          0
        231 |        34 |                          0
        231 |        69 |                          0
        231 |        85 |                          0
        256 |        17 |                          0
        256 |        57 |                          0
        256 |        67 |                          0
        257 |        64 |                          0
        258 |         5 |                          0
        258 |        19 |                          0
        258 |        68 |                          0
        258 |        69 |                          0
        258 |        89 |                          0
        258 |        95 |                          0
        259 |        12 |                          0
        259 |        37 |                          0
        259 |        62 |                          0
        259 |        87 |                          0
        259 |        89 |                          0
        260 |         1 |                          0
        260 |         5 |                          0
        260 |        22 |                          0
        260 |        29 |                          0
        260 |        60 |                          0
        261 |         5 |                          0
        261 |        22 |                          0
        261 |        25 |                          0
        261 |        58 |                          0
        261 |        65 |                          0
        261 |        99 |                          0
        262 |        13 |                          0
        262 |        78 |                          0
        262 |        95 |                          0
        263 |        13 |                          0
        263 |        47 |                          0
        263 |        68 |                          0
        288 |         1 |                          0
        288 |         2 |                          0
        288 |        86 |                          0
        288 |        90 |                          0
        288 |        98 |                          0
        289 |        23 |                          0
        289 |        24 |                          0
        289 |        27 |                          0
        289 |        60 |                          0
        289 |        93 |                          0
        290 |         5 |                          0
        290 |        28 |                          0
        290 |        45 |                          0
        290 |        76 |                          0
        291 |        38 |                          0
        291 |        72 |                          0
        291 |        75 |                          0
        292 |        37 |                          0
        292 |        94 |                          0
        293 |        66 |     0.00160000000000000000
        293 |        82 |                          0
        294 |        88 |                          0
        295 |        17 |                          0
        295 |        21 |                          0
        295 |        39 |                          0
        295 |        80 |                          0
        320 |        21 |                          0
        320 |        67 |                          0
        321 |        80 |                          0
        321 |        84 |                          0
        322 |         6 |     0.00040000000000000000
        322 |        38 |                          0
        322 |        60 |                          0
        322 |        77 |                          0
        322 |        91 |                          0
        322 |        96 |                          0
        323 |        29 |                          0
        323 |        61 |                          0
        323 |        87 |                          0
        324 |        84 |                          0
        325 |         9 |                          0
        325 |        15 |                          0
        325 |        96 |                          0
        326 |         3 |                          0
        326 |        16 |                          0
        326 |        22 |                          0
        326 |        25 |                          0
        326 |        52 |                          0
        326 |        76 |                          0
        326 |        89 |                          0
        327 |        48 |                          0
        327 |        54 |                          0
        352 |        39 |                          0
        353 |        28 |                          0
        353 |        36 |                          0
        353 |        42 |                          0
        353 |        59 |                          0
        353 |        67 |                          0
        353 |        77 |                          0
        354 |         7 |                          0
        354 |        25 |                          0
        354 |        43 |                          0
        354 |        72 |                          0
        354 |        73 |                          0
        354 |        83 |                          0
        354 |        98 |                          0
        355 |        13 |                          0
        355 |        64 |                          0
        356 |        15 |                          0
        356 |        18 |                          0
        356 |        46 |                          0
        356 |        54 |                          0
        356 |        55 |                          0
        357 |         3 |                          0
        357 |        32 |                          0
        357 |        33 |                          0
        358 |        14 |                          0
        358 |        30 |                          0
        358 |        35 |                          0
        358 |        46 |                          0
        358 |        69 |                          0
        358 |        71 |                          0
        358 |        97 |                          0
        359 |        34 |                          0
        359 |        54 |                          0
        359 |        56 |                          0
        359 |        57 |                          0
        359 |        61 |                          0
        359 |        65 |                          0
        384 |         3 |                          0
        384 |        30 |                          0
        384 |        66 |                          0
        384 |        70 |                          0
        384 |        90 |                          0
        385 |         7 |                          0
        385 |        92 |                          0
        386 |         2 |                          0
        386 |        46 |                          0
        386 |        76 |                          0
        387 |        24 |                          0
        387 |        29 |                          0
        387 |        33 |                          0
        387 |        44 |                          0
        387 |        61 |                          0
        388 |         8 |                          0
        388 |        11 |                          0
        388 |        80 |                          0
        389 |        37 |                          0
        390 |         2 |                          0
        390 |        15 |                          0
        390 |        20 |                          0
        390 |        21 |                          0
        390 |        22 |                          0
        390 |        46 |                          0
        390 |        50 |                          0
        391 |        91 |                          0
        416 |        18 |                          0
        416 |        71 |                          0
        416 |        85 |                          0
        417 |        12 |                          0
        417 |        56 |                          0
        417 |        72 |                          0
        417 |        97 |                          0
        418 |        13 |                          0
        418 |        37 |                          0
        418 |        78 |                          0
        419 |         5 |                          0
        419 |         8 |                          0
        419 |        38 |                          0
        419 |        64 |                          0
        420 |        35 |     0.00040000000000000000
        420 |        49 |                          0
        420 |        50 |                          0
        420 |        61 |                          0
        420 |        80 |                          0
        420 |        95 |                          0
        421 |        32 |                          0
        422 |        41 |                          0
        422 |        50 |                          0
        422 |        60 |                          0
        422 |        87 |                          0
        423 |        96 |                          0
        448 |        24 |                          0
        448 |        51 |                          0
        448 |        53 |                          0
        448 |        74 |                          0
        448 |        92 |                          0
        449 |         1 |     0.00062500000000000000
        449 |        58 |                          0
        449 |        91 |                          0
        450 |         5 |                          0
        450 |        40 |                          0
        450 |        54 |                          0
        450 |        64 |                          0
        450 |        69 |                          0
        450 |        82 |                          0
        451 |        63 |     0.00022500000000000000
        451 |        71 |                          0
        451 |        78 |                          0
        452 |        48 |                          0
        453 |        59 |                          0
        453 |        69 |                          0
        453 |        79 | 0.000025000000000000000000
        453 |        85 |                          0
        453 |        86 |                          0
        454 |        85 |                          0
        455 |        28 |                          0
        455 |        43 |                          0
        455 |        74 |                          0
        455 |        86 |                          0
        480 |        23 |                          0
        481 |         8 |                          0
        481 |        59 |                          0
        481 |        66 |                          0
        481 |        78 |                          0
        481 |        93 |                          0
        482 |        26 |                          0
        482 |        40 |                          0
        482 |        60 |                          0
        482 |        75 |     0.00040000000000000000
        482 |        88 |                          0
        483 |        12 |                          0
        483 |        56 |                          0
        483 |        99 |                          0
        484 |         4 |                          0
        484 |         5 |                          0
        484 |        29 |                          0
        484 |        50 |                          0
        484 |        59 |                          0
        484 |        78 |                          0
        485 |        35 |                          0
        485 |        84 |                          0
        485 |        97 |                          0
        486 |        56 |                          0
        486 |        63 |                          0
        486 |        72 |                          0
        486 |        84 |                          0
        486 |        96 |                          0
        486 |        99 |                          0
        487 |        20 |                          0
        487 |        22 |                          0
        512 |        33 |                          0
        512 |        39 |                          0
        512 |        43 |                          0
        512 |        50 |                          0
        512 |        84 |                          0
        512 |        92 |                          0
        512 |        96 |                          0
        513 |        12 |                          0
        513 |        29 |                          0
        514 |        12 |                          0
        514 |        21 |                          0
        514 |        55 |                          0
        514 |        56 |                          0
        515 |        48 |                          0
        515 |        52 |                          0
        515 |        56 |                          0
        515 |        58 |                          0
        515 |        77 |                          0
        515 |        88 |                          0
        516 |         5 |                          0
        517 |        23 |                          0
        517 |        40 |                          0
        517 |        47 |                          0
        517 |        89 |                          0
        517 |        95 |                          0
        518 |         2 |                          0
        518 |         4 |                          0
        518 |         9 |                          0
        518 |        21 |                          0
        518 |        32 |                          0
        518 |        49 |                          0
        518 |        53 |                          0
        519 |        30 |                          0
        519 |        31 |                          0
        519 |        42 |                          0
        519 |        51 |                          0
        519 |        71 |                          0
        519 |        91 |                          0
        544 |        86 |                          0
        545 |        87 |                          0
        545 |        97 |                          0
        546 |        46 |                          0
        547 |         1 |                          0
        547 |        41 |                          0
        547 |        73 |                          0
        548 |         9 |                          0
        548 |        33 |                          0
        548 |        48 |                          0
        548 |        59 |                          0
        548 |        67 |                          0
        548 |        78 |                          0
        549 |        17 |                          0
        549 |        40 |                          0
        549 |        54 |                          0
        549 |        84 |                          0
        549 |        89 |                          0
        550 |        49 |                          0
        551 |        66 |                          0
        551 |        70 |                          0
        551 |        94 |                          0
        576 |        32 |                          0
        576 |        54 |                          0
        576 |        88 |                          0
        576 |        95 |                          0
        577 |        14 |                          0
        577 |        96 |                          0
        578 |        57 |                          0
        578 |        58 |                          0
        579 |        10 |                          0
        579 |        52 |                          0
        579 |        54 |                          0
        579 |        79 |                          0
        579 |        88 |     0.00040000000000000000
        580 |        35 |                          0
        580 |        50 |                          0
        580 |        89 |                          0
        581 |        15 |                          0
        581 |        61 |                          0
        581 |        73 |                          0
        581 |        97 |                          0
        582 |         4 |                          0
        582 |        56 |                          0
        582 |        79 |                          0
        582 |        83 |                          0
        583 |        16 |                          0
        583 |        31 |                          0
        583 |        33 |                          0
        583 |        34 |                          0
        583 |        45 |                          0
        608 |        57 |                          0
        608 |        63 |                          0
        609 |        88 |                          0
        610 |        59 |                          0
        610 |        73 |                          0
        610 |        78 |                          0
        610 |        79 |                          0
        610 |        80 |                          0
        610 |        81 |                          0
        610 |        97 |                          0
        611 |         8 |                          0
        611 |        33 |                          0
        611 |        48 |                          0
        612 |        12 |                          0
        612 |        13 |                          0
        612 |        19 |                          0
        612 |        25 |                          0
        612 |        37 |                          0
        612 |        94 |                          0
        613 |         4 |                          0
        613 |        81 |                          0
        613 |        85 |                          0
        613 |        95 |                          0
        614 |        13 |                          0
        614 |        31 |                          0
        614 |        40 |                          0
        614 |        88 |                          0
        614 |        94 |                          0
        614 |        99 |                          0
        615 |        47 |                          0
        640 |        16 |                          0
        640 |        22 |                          0
        640 |        31 |                          0
        640 |        33 |                          0
        641 |        30 |                          0
        641 |        64 |                          0
        641 |        66 |                          0
        641 |        79 |                          0
        641 |        89 |                          0
        642 |        38 |                          0
        643 |         2 |                          0
        643 |         3 |                          0
        643 |        36 |                          0
        643 |        67 |                          0
        643 |        82 |                          0
        644 |        11 |                          0
        644 |        34 |                          0
        644 |        50 |                          0
        644 |        71 |                          0
        644 |        72 |                          0
        644 |        94 |                          0
        644 |        95 |                          0
        645 |        24 |                          0
        645 |        38 |                          0
        645 |        56 |                          0
        645 |        72 |                          0
        645 |        74 |                          0
        645 |        94 |                          0
        645 |        96 |                          0
        646 |        18 |                          0
        646 |        53 |                          0
        646 |        57 |                          0
        646 |        59 |                          0
        646 |        69 |                          0
        646 |        96 |                          0
        647 |        10 |                          0
        647 |        91 |                          0
        647 |        95 |                          0
        672 |        23 |                          0
        672 |        42 |                          0
        672 |        98 |                          0
        673 |        70 |                          0
        674 |        44 |                          0
        674 |        50 |                          0
        675 |         2 |                          0
        675 |        73 |                          0
        675 |        82 |                          0
        675 |        86 |                          0
        675 |        96 |                          0
        676 |         1 | 0.000100000000000000000000
        676 |        25 |                          0
        676 |        26 |                          0
        676 |        61 |                          0
        676 |        74 |                          0
        676 |        76 |                          0
        677 |        15 |                          0
        677 |        21 |                          0
        677 |        34 |                          0
        677 |        75 |                          0
        677 |        95 |                          0
        678 |        30 |                          0
        678 |        51 |                          0
        678 |        57 |                          0
        678 |        65 |                          0
        678 |        76 |                          0
        678 |        82 |                          0
        679 |        19 |                          0
        704 |         1 |                          0
        704 |        40 |                          0
        705 |        28 |                          0
        705 |        72 |                          0
        706 |        12 |                          0
        707 |        49 |                          0
        707 |        57 |                          0
        708 |         6 |                          0
        708 |        25 |                          0
        708 |        43 |                          0
        708 |        51 |                          0
        708 |        53 |                          0
        708 |        93 |                          0
        709 |        18 |                          0
        709 |        27 |                          0
        709 |        30 |                          0
        709 |        74 |                          0
        710 |         5 |                          0
        710 |        14 |                          0
        710 |        31 |                          0
        710 |        42 |                          0
        710 |        46 | 0.000100000000000000000000
        710 |        95 |                          0
        711 |        46 |                          0
        711 |        78 |                          0
        711 |        97 |                          0
        711 |        98 |                          0
        736 |        58 |                          0
        736 |        64 |                          0
        736 |        75 |                          0
        736 |        82 |                          0
        736 |        96 |                          0
        737 |        49 |                          0
        738 |        26 |                          0
        738 |        34 |                          0
        738 |        62 |                          0
        738 |        72 |                          0
        738 |        98 |                          0
        739 |         6 |                          0
        739 |        23 |                          0
        739 |        47 |                          0
        739 |        62 |                          0
        739 |        79 |                          0
        740 |        47 |                          0
        740 |        82 |                          0
        740 |        89 |                          0
        741 |        52 |                          0
        741 |        73 |                          0
        742 |        15 |                          0
        742 |        37 |                          0
        742 |        52 |                          0
        742 |        53 |                          0
        742 |        64 |                          0
        742 |        89 |                          0
        743 |         4 |                          0
        768 |        11 |                          0
        768 |        24 |                          0
        768 |        27 |                          0
        768 |        60 |                          0
        768 |        80 |                          0
        768 |        82 |                          0
        768 |        90 |                          0
        769 |        32 |                          0
        769 |        94 |                          0
        770 |        46 |                          0
        770 |        64 |                          0
        771 |        14 |                          0
        771 |        20 |                          0
        771 |        46 |                          0
        771 |        48 |                          0
        771 |        65 |                          0
        771 |        72 |                          0
        772 |        18 |                          0
        772 |        26 |                          0
        772 |        38 |                          0
        772 |        53 |                          0
        772 |        98 |                          0
        773 |        22 |                          0
        773 |        28 |                          0
        773 |        32 |                          0
        773 |        36 |                          0
        773 |        95 |                          0
        773 |        97 |                          0
        774 |        14 |                          0
        774 |        28 |                          0
        774 |        51 |                          0
        774 |        89 |                          0
        774 |        97 |                          0
        774 |       100 |                          0
        775 |        60 |                          0
        775 |        74 |                          0
        775 |        77 |                          0
        800 |        36 |                          0
        800 |        77 |                          0
        800 |        84 |                          0
        801 |        12 |                          0
        801 |        16 |                          0
        801 |        28 |     0.00062500000000000000
        801 |        29 |                          0
        801 |        57 |                          0
        801 |        60 |                          0
        802 |         5 |                          0
        802 |        11 |                          0
        802 |        19 |                          0
        802 |        29 |                          0
        802 |        47 |                          0
        803 |        89 |                          0
        803 |        96 |                          0
        804 |        17 |                          0
        804 |        21 |                          0
        804 |        33 |                          0
        804 |        54 |                          0
        805 |        24 |                          0
        805 |        66 |                          0
        805 |        87 |                          0
        805 |        98 |                          0
        806 |        39 |                          0
        806 |        54 |                          0
        806 |        79 |                          0
        807 |         4 |                          0
        807 |        30 |                          0
        807 |        33 |                          0
        807 |        53 |                          0
        807 |        75 |                          0
        807 |        94 |                          0
        807 |        96 |                          0
        832 |        34 |                          0
        832 |        66 |                          0
        833 |        36 |                          0
        833 |        37 |                          0
        833 |        56 |                          0
        834 |        21 |                          0
        834 |        82 |                          0
        835 |        33 |                          0
        835 |        36 |                          0
        836 |        10 |                          0
        836 |        36 |                          0
        836 |        47 |                          0
        837 |        74 |                          0
        837 |        97 |                          0
        838 |        33 |                          0
        838 |        77 |                          0
        838 |        83 |                          0
        838 |        84 |                          0
        839 |        85 |                          0
        839 |        92 |                          0
        864 |        27 |                          0
        864 |        35 |                          0
        864 |        49 |                          0
        865 |         8 |                          0
        865 |        18 |                          0
        865 |        28 |                          0
        865 |        45 |                          0
        866 |        59 |                          0
        867 |        89 |                          0
        868 |        27 |                          0
        868 |        38 |                          0
        868 |        42 |                          0
        868 |        44 |                          0
        868 |        81 |                          0
        868 |        86 |                          0
        869 |        55 |                          0
        869 |        91 |                          0
        870 |        60 |                          0
        870 |        80 |                          0
        871 |         1 |                          0
        871 |         7 |                          0
        871 |        19 |                          0
        871 |        43 |                          0
        871 |        50 |                          0
        871 |        65 |                          0
        871 |        86 |                          0
        896 |         5 |                          0
        896 |        10 |                          0
        896 |        18 |                          0
        896 |        25 |                          0
        896 |        54 |                          0
        896 |        88 |                          0
        896 |        96 |                          0
        897 |        62 |                          0
        897 |        74 |                          0
        897 |        83 |                          0
        897 |        96 |                          0
        898 |         3 |                          0
        898 |        11 |                          0
        898 |        13 |                          0
        898 |        71 |                          0
        899 |        28 |                          0
        899 |        33 |                          0
        899 |        50 |                          0
        899 |        73 |                          0
        899 |        83 |                          0
        899 |        88 |                          0
        899 |        91 |                          0
        900 |        31 |                          0
        900 |        43 |                          0
        900 |        48 |                          0
        901 |        40 |                          0
        901 |        54 |                          0
        901 |        57 |                          0
        901 |        79 |                          0
        902 |         7 |                          0
        902 |        10 |                          0
        902 |        32 |                          0
        903 |         9 |                          0
        903 |        12 |                          0
        903 |        15 |                          0
        903 |        16 |                          0
        903 |        38 |                          0
        903 |        72 |                          0
        928 |         5 |                          0
        928 |        19 |                          0
        928 |        31 |                          0
        928 |        42 |                          0
        928 |        59 |                          0
        928 |        66 |                          0
        928 |        83 |                          0
        929 |        32 |                          0
        929 |        53 |                          0
        929 |        62 |                          0
        929 |        86 |                          0
        930 |        32 |                          0
        930 |        37 |     0.00022500000000000000
        930 |        45 |                          0
        930 |        52 |                          0
        930 |        57 |                          0
        930 |        64 |                          0
        931 |        47 |                          0
        931 |        79 |                          0
        931 |        81 |                          0
        931 |        99 |                          0
        932 |        68 |                          0
        933 |        23 |                          0
        933 |        27 |                          0
        933 |        71 |                          0
        934 |        52 |                          0
        935 |         3 |                          0
        935 |        33 |                          0
        935 |        40 |                          0
        935 |        49 |                          0
        935 |        74 |                          0
        935 |        80 |                          0
        960 |         6 |                          0
        960 |        72 |                          0
        960 |        75 |                          0
        961 |         6 |                          0
        961 |        53 |                          0
        961 |        54 |                          0
        961 |        64 |                          0
        961 |        71 |     0.00022500000000000000
        962 |         1 |                          0
        962 |        61 |                          0
        962 |        67 |                          0
        962 |        82 |                          0
        962 |        95 |                          0
        962 |        98 |                          0
        963 |        10 |                          0
        963 |        65 |                          0
        964 |        24 |                          0
        964 |        77 |                          0
        964 |        91 |                          0
        964 |        99 |                          0
        965 |         9 |                          0
        965 |        24 |                          0
        966 |        18 |                          0
        966 |        21 |                          0
        966 |        39 |                          0
        966 |        68 |                          0
        967 |        45 |                          0
        967 |        51 |                          0
        967 |        55 |                          0
        967 |        90 |                          0
        967 |        92 |                          0
        967 |        95 |                          0
        967 |        96 |                          0
        992 |         3 |                          0
        992 |        39 |                          0
        992 |        46 |                          0
        992 |        49 |                          0
        992 |        81 |                          0
        992 |        91 |                          0
        993 |        26 |                          0
        993 |        48 |                          0
        993 |        56 |                          0
        993 |        57 |                          0
        993 |        85 |                          0
        993 |        88 |                          0
        993 |        97 |                          0
        994 |        18 |                          0
        994 |        20 |                          0
        994 |        46 |                          0
        994 |        93 |                          0
        995 |        21 |                          0
        995 |        26 |                          0
        995 |        33 |                          0
        995 |        34 |                          0
        995 |        50 |                          0
        996 |         9 |                          0
        997 |        28 |                          0
        997 |        76 |                          0
        998 |        55 |                          0
        998 |        58 |                          0
        998 |        76 |                          0
        998 |        90 |                          0
        998 |        92 |                          0
        999 |        28 |                          0
        999 |        33 |                          0
        999 |        40 |                          0
        999 |        45 |                          0
        999 |        85 |                          0
        999 |        95 |                          0
       1024 |        24 |                          0
       1024 |        29 |                          0
       1024 |        70 |                          0
       1024 |        77 |                          0
       1024 |        91 |                          0
       1025 |        80 |                          0
       1025 |        84 |                          0
       1025 |        95 |                          0
       1026 |        26 |                          0
       1026 |        58 |                          0
       1027 |        41 |                          0
       1027 |        69 |                          0
       1027 |        86 |                          0
       1027 |        94 |                          0
       1027 |        96 |                          0
       1027 |        98 |                          0
       1028 |        17 |                          0
       1028 |        42 |                          0
       1028 |        65 |                          0
       1028 |        67 |                          0
       1028 |        68 |                          0
       1028 |        80 |                          0
       1028 |        92 |                          0
       1029 |         1 |                          0
       1030 |        38 |                          0
       1031 |        35 |                          0
       1031 |        39 |                          0
       1031 |        57 |                          0
       1031 |        90 |                          0
       1031 |       100 |                          0
       1056 |        48 |                          0
       1057 |         6 |                          0
       1057 |         9 |                          0
       1057 |        23 |                          0
       1057 |        68 |     0.00040000000000000000
       1057 |        76 |                          0
       1058 |        11 |                          0
       1058 |        18 |                          0
       1058 |        81 |                          0
       1058 |        94 |                          0
       1059 |         4 |                          0
       1059 |        14 |                          0
       1059 |        20 |                          0
       1059 |        23 |                          0
       1059 |        37 |                          0
       1059 |        71 |                          0
       1059 |        77 |                          0
       1060 |         5 |                          0
       1060 |        47 |                          0
       1060 |        53 |                          0
       1060 |        74 |                          0
       1060 |        77 |                          0
       1060 |        88 |                          0
       1060 |        90 |                          0
       1061 |         2 |                          0
       1061 |        23 |                          0
       1061 |        55 |                          0
       1061 |        75 | 0.000025000000000000000000
       1061 |        82 |                          0
       1062 |        62 |                          0
       1063 |        20 |                          0
       1088 |        41 |                          0
       1088 |        48 |                          0
       1088 |        54 |                          0
       1088 |        70 |                          0
       1089 |        22 |                          0
       1089 |        23 |                          0
       1089 |        30 |                          0
       1089 |        53 |                          0
       1090 |        17 |                          0
       1090 |        98 |                          0
       1091 |        74 |                          0
       1092 |        36 |                          0
       1092 |        48 |                          0
       1092 |        53 |                          0
       1092 |        91 |                          0
       1093 |         6 |                          0
       1093 |        37 |                          0
       1093 |        90 |                          0
       1094 |        46 |                          0
       1095 |        27 |                          0
       1095 |        48 |                          0
       1095 |        59 |                          0
       1095 |        75 |                          0
       1095 |        94 |                          0
       1095 |       100 |                          0
       1120 |        16 |                          0
       1120 |        23 |                          0
       1120 |        26 |                          0
       1120 |        88 |                          0
       1120 |        92 |                          0
       1121 |         2 |                          0
       1121 |        10 |                          0
       1121 |        45 |                          0
       1121 |        53 |                          0
       1121 |        77 |                          0
       1121 |        88 |                          0
       1121 |        96 |                          0
       1122 |         5 |                          0
       1122 |        15 |                          0
       1122 |        43 |                          0
       1122 |        54 |                          0
       1122 |        83 |                          0
       1122 |        93 |                          0
       1123 |        19 |                          0
       1123 |        45 |                          0
       1123 |        91 |                          0
       1124 |         5 |                          0
       1124 |        11 |                          0
       1124 |        23 |                          0
       1124 |        43 |                          0
       1124 |        58 |                          0
       1124 |        82 |                          0
       1124 |        93 |                          0
       1125 |        48 |                          0
       1125 |        49 |                          0
       1125 |        79 |                          0
       1125 |        98 |                          0
       1126 |        33 |                          0
       1126 |        36 |                          0
       1126 |        46 |                          0
       1127 |        45 |                          0
       1127 |        56 |                          0
       1127 |        69 |                          0
       1127 |        98 |                          0
       1152 |        32 |                          0
       1152 |        49 |                          0
       1152 |        88 |                          0
       1153 |        13 |                          0
       1153 |        32 |                          0
       1153 |        35 |                          0
       1153 |        51 |                          0
       1153 |        55 |                          0
       1153 |        64 |                          0
       1153 |        92 |                          0
       1154 |         7 |                          0
       1154 |        65 |                          0
       1154 |        68 |                          0
       1154 |        84 |                          0
       1154 |        93 |                          0
       1154 |        97 |                          0
       1155 |         8 |                          0
       1155 |        20 |                          0
       1155 |        47 |                          0
       1155 |        94 |                          0
       1155 |        95 |                          0
       1156 |        16 |                          0
       1156 |        26 |                          0
       1156 |        34 |                          0
       1156 |        50 |                          0
       1156 |        71 |                          0
       1156 |        74 |                          0
       1156 |        91 |                          0
       1157 |        41 |                          0
       1157 |        68 |                          0
       1157 |        71 |                          0
       1157 |        80 |                          0
       1157 |        88 |                          0
       1158 |        73 |                          0
       1158 |        82 |                          0
       1159 |        10 |                          0
       1159 |        24 |                          0
       1159 |        82 |                          0
       1184 |        41 |                          0
       1184 |        46 |                          0
       1184 |        68 |                          0
       1184 |        98 |                          0
       1185 |         9 |                          0
       1185 |        38 |                          0
       1185 |        85 |                          0
       1186 |         9 |                          0
       1186 |        26 |                          0
       1186 |        61 |                          0
       1186 |        81 |                          0
       1187 |         5 |                          0
       1187 |         6 |                          0
       1187 |        44 |                          0
       1188 |        22 |                          0
       1188 |        87 |                          0
       1188 |        89 |                          0
       1189 |         8 |                          0
       1189 |        55 |                          0
       1189 |        97 |                          0
       1190 |        38 |                          0
       1191 |        13 |                          0
       1216 |        19 |                          0
       1216 |        38 |                          0
       1216 |        73 |                          0
       1217 |        53 |                          0
       1218 |        30 |                          0
       1218 |        44 |                          0
       1218 |        67 |                          0
       1218 |        69 |                          0
       1219 |        24 |                          0
       1219 |        96 |                          0
       1220 |         3 |                          0
       1220 |        14 |                          0
       1220 |        49 |                          0
       1220 |        70 |                          0
       1220 |        79 |                          0
       1221 |         7 |                          0
       1221 |        13 |                          0
       1221 |        35 |                          0
       1221 |        44 |                          0
       1221 |        46 |                          0
       1221 |        96 |                          0
       1222 |         2 |                          0
       1222 |        10 |                          0
       1222 |        28 |                          0
       1223 |        96 |                          0
       1248 |        32 |                          0
       1248 |        44 |                          0
       1248 |        45 |                          0
       1248 |        53 |     0.00090000000000000000
       1248 |        78 |                          0
       1249 |        43 |                          0
       1250 |        12 |                          0
       1251 |        17 |                          0
       1251 |        35 |                          0
       1251 |        62 |                          0
       1251 |        81 |                          0
       1251 |        91 |                          0
       1252 |        47 |                          0
       1252 |        82 |                          0
       1252 |        89 |                          0
       1252 |        93 |                          0
       1252 |        99 |                          0
       1253 |         1 |                          0
       1253 |        27 |                          0
       1253 |        41 |                          0
       1253 |        77 |                          0
       1253 |        95 |                          0
       1254 |        46 |                          0
       1254 |        69 |                          0
       1254 |        84 |                          0
       1255 |        64 |                          0
       1255 |        71 |                          0
       1280 |        14 |                          0
       1280 |        16 |                          0
       1280 |        19 |                          0
       1280 |        51 |                          0
       1280 |        62 |                          0
       1280 |        75 |                          0
       1280 |        79 |                          0
       1281 |         6 |                          0
       1281 |        15 |                          0
       1281 |        18 |                          0
       1281 |        55 |                          0
       1281 |        72 |                          0
       1281 |        76 |                          0
       1281 |        81 |                          0
       1282 |        26 |                          0
       1282 |        47 |                          0
       1282 |        85 |                          0
       1282 |        97 |                          0
       1283 |        25 |                          0
       1283 |        30 |                          0
       1283 |        52 |                          0
       1283 |        64 |                          0
       1283 |        65 |                          0
       1283 |        73 |                          0
       1283 |        86 |                          0
       1284 |        27 |                          0
       1284 |        35 |                          0
       1284 |        55 |                          0
       1284 |        60 |                          0
       1284 |        84 |                          0
       1285 |         3 |                          0
       1285 |        12 |                          0
       1285 |        17 |                          0
       1285 |        19 |                          0
       1285 |        63 |                          0
       1286 |        13 |                          0
       1286 |        39 |                          0
       1286 |        65 |                          0
       1286 |        72 |                          0
       1286 |        73 |                          0
       1286 |        78 |                          0
       1287 |         4 |                          0
       1287 |        11 |                          0
       1287 |        15 |                          0
       1287 |        17 |                          0
       1287 |        60 |                          0
       1287 |        75 |                          0
       1312 |        57 |                          0
       1312 |        61 |                          0
       1312 |        74 |                          0
       1313 |         5 |                          0
       1314 |        11 |                          0
       1314 |        23 |                          0
       1314 |        65 |                          0
       1315 |        27 |                          0
       1315 |        34 |                          0
       1315 |        37 |                          0
       1315 |        91 |                          0
       1315 |        96 |                          0
       1316 |         9 |                          0
       1316 |        14 |                          0
       1316 |        15 |                          0
       1316 |        40 |                          0
       1316 |        45 |                          0
       1316 |        60 |                          0
       1316 |        74 |                          0
       1317 |        13 |                          0
       1317 |        17 |                          0
       1317 |        39 |                          0
       1317 |        58 |                          0
       1317 |        73 |                          0
       1318 |        22 |                          0
       1318 |        46 |                          0
       1318 |        89 |                          0
       1319 |        24 |                          0
       1319 |        73 |                          0
       1344 |        80 |                          0
       1344 |        86 |                          0
       1345 |        66 |                          0
       1345 |        68 |                          0
       1345 |        73 |                          0
       1346 |        30 |                          0
       1346 |        32 |                          0
       1346 |        37 |                          0
       1346 |        40 |                          0
       1346 |        46 |                          0
       1346 |        62 |                          0
       1347 |         2 |                          0
       1347 |         3 |                          0
       1347 |         5 |                          0
       1347 |        43 |                          0
       1347 |        50 |                          0
       1347 |        58 |                          0
       1347 |        94 |                          0
       1348 |         2 |                          0
       1348 |        45 |                          0
       1348 |        78 |                          0
       1348 |        84 |                          0
       1349 |        14 |                          0
       1349 |        50 |                          0
       1350 |        38 |                          0
       1350 |        98 |                          0
       1351 |        74 |                          0
       1376 |        28 |                          0
       1377 |         1 |                          0
       1377 |        13 |                          0
       1377 |        52 |                          0
       1377 |        55 |                          0
       1377 |        57 |                          0
       1377 |        59 |                          0
       1378 |         8 |                          0
       1378 |        30 |                          0
       1378 |        50 |                          0
       1378 |        54 |                          0
       1378 |        72 |                          0
       1378 |        80 |                          0
       1379 |         9 |                          0
       1379 |        51 |                          0
       1379 |        62 |                          0
       1380 |        40 |                          0
       1380 |        61 |                          0
       1380 |        79 |                          0
       1380 |        87 |                          0
       1381 |        61 |                          0
       1381 |        71 |                          0
       1382 |        10 |                          0
       1382 |        15 |                          0
       1382 |        29 |                          0
       1382 |        36 |                          0
       1382 |        50 |                          0
       1382 |        63 |                          0
       1382 |        64 |                          0
       1383 |        44 |                          0
       1383 |        62 |                          0
       1408 |         9 |                          0
       1408 |        11 |                          0
       1408 |        47 |                          0
       1408 |        50 |                          0
       1408 |        89 |                          0
       1408 |        98 | 0.000025000000000000000000
       1409 |         8 |                          0
       1409 |        24 |                          0
       1409 |        92 |                          0
       1410 |         6 |                          0
       1410 |        26 |                          0
       1410 |        53 |     0.00122500000000000000
       1410 |        78 |                          0
       1411 |        16 |                          0
       1411 |        27 |                          0
       1411 |        43 |                          0
       1411 |        66 |                          0
       1411 |        89 |                          0
       1411 |        96 |                          0
       1412 |        18 |                          0
       1412 |        32 |                          0
       1412 |        33 |                          0
       1412 |        63 |                          0
       1412 |        82 |                          0
       1413 |        46 |                          0
       1413 |        67 |                          0
       1413 |        81 |                          0
       1414 |        58 |                          0
       1414 |        66 |                          0
       1415 |        84 |                          0
       1440 |        12 |                          0
       1440 |        47 |                          0
       1441 |        10 |                          0
       1441 |        11 |     0.00062500000000000000
       1441 |        40 |                          0
       1441 |        51 |                          0
       1441 |        61 |                          0
       1441 |        99 |                          0
       1442 |         6 |                          0
       1443 |        66 |                          0
       1444 |        20 |                          0
       1444 |        21 |                          0
       1444 |        28 |                          0
       1444 |        61 |                          0
       1444 |        80 |                          0
       1444 |        89 |                          0
       1444 |        93 |                          0
       1445 |        57 |                          0
       1445 |        61 |                          0
       1445 |        70 |                          0
       1445 |        72 |                          0
       1445 |        84 |                          0
       1445 |        95 |                          0
       1446 |        20 |                          0
       1447 |        44 |                          0
       1447 |        68 |                          0
       1447 |        72 |                          0
       1447 |        85 |                          0
       1447 |        96 |                          0
       1447 |       100 |                          0
       1472 |        49 |                          0
       1472 |        82 |                          0
       1472 |        98 |                          0
       1473 |        69 |                          0
       1473 |        96 |                          0
       1474 |        29 |                          0
       1474 |        65 |                          0
       1474 |        80 |                          0
       1475 |         4 |                          0
       1475 |        19 |                          0
       1475 |        24 |                          0
       1475 |        71 |                          0
       1475 |        72 |                          0
       1475 |        74 |                          0
       1475 |        80 |                          0
       1476 |        35 |                          0
       1477 |         3 |                          0
       1477 |        28 |                          0
       1477 |        46 |                          0
       1477 |        50 |                          0
       1477 |        53 |                          0
       1477 |        64 |                          0
       1477 |        85 |                          0
       1478 |        38 |                          0
       1479 |        29 |                          0
       1504 |        14 |                          0
       1504 |        15 |                          0
       1504 |        30 |                          0
       1504 |        48 |                          0
       1504 |        77 |                          0
       1505 |        66 |                          0
       1505 |        72 |                          0
       1506 |        22 |                          0
       1506 |        33 |                          0
       1506 |        37 |                          0
       1506 |        48 |                          0
       1506 |        52 |                          0
       1506 |        55 |                          0
       1506 |        64 |                          0
       1507 |        29 |                          0
       1507 |        34 |                          0
       1507 |        92 |                          0
       1508 |         3 |                          0
       1508 |         4 |                          0
       1508 |        24 |                          0
       1508 |        25 |                          0
       1508 |        71 |                          0
       1508 |        90 |                          0
       1508 |        95 |                          0
       1509 |        10 |                          0
       1509 |        22 |                          0
       1509 |        27 |                          0
       1509 |        43 |                          0
       1509 |        64 |                          0
       1509 |        94 |                          0
       1509 |        96 |                          0
       1510 |        31 |                          0
       1510 |        38 |                          0
       1510 |        44 |                          0
       1510 |        45 |                          0
       1510 |        70 |                          0
       1510 |        78 |                          0
       1510 |        86 |                          0
       1511 |        75 |                          0
       1511 |        81 |                          0
       1536 |        39 |                          0
       1537 |         2 |                          0
       1537 |        26 |                          0
       1537 |        36 |                          0
       1537 |        69 |                          0
       1538 |        10 |                          0
       1538 |        11 |                          0
       1538 |        19 |                          0
       1538 |        44 |                          0
       1538 |        54 |                          0
       1538 |        59 |                          0
       1539 |        27 |                          0
       1539 |        38 |                          0
       1539 |        47 |                          0
       1540 |         4 |                          0
       1540 |        23 |                          0
       1540 |        29 |                          0
       1540 |        51 |                          0
       1540 |        91 |                          0
       1541 |        58 |                          0
       1541 |        66 |                          0
       1542 |        51 |                          0
       1542 |        57 |                          0
       1542 |        67 |                          0
       1542 |        71 |                          0
       1542 |        79 |                          0
       1543 |        10 |                          0
       1543 |        62 |                          0
       1543 |        73 |                          0
       1543 |        74 |                          0
       1543 |        76 |                          0
       1543 |        82 |                          0
       1543 |       100 |                          0
       1568 |        16 |                          0
       1568 |        28 |                          0
       1569 |        42 |                          0
       1569 |        89 |                          0
       1569 |        90 |                          0
       1569 |        93 |                          0
       1570 |        18 |                          0
       1570 |        71 |                          0
       1571 |        12 |                          0
       1571 |        15 |                          0
       1571 |        18 |                          0
       1571 |        40 |                          0
       1571 |        58 |                          0
       1571 |        75 |                          0
       1572 |        27 |                          0
       1572 |        38 |                          0
       1573 |         8 |                          0
       1573 |        24 |                          0
       1573 |        27 |                          0
       1573 |        46 |                          0
       1573 |        52 |                          0
       1573 |        55 |                          0
       1574 |        24 |                          0
       1574 |        35 |                          0
       1574 |        37 |                          0
       1574 |        55 |                          0
       1574 |        66 |                          0
       1574 |        72 |                          0
       1574 |        98 |                          0
       1575 |         4 |                          0
       1575 |         7 |                          0
       1575 |        10 |                          0
       1575 |        11 |                          0
       1575 |        45 |                          0
       1575 |        57 |                          0
       1575 |        86 |                          0
       1600 |        17 |                          0
       1600 |        20 |                          0
       1600 |        42 | 0.000100000000000000000000
       1600 |        62 |                          0
       1601 |        33 |                          0
       1601 |        63 |                          0
       1601 |        71 |                          0
       1602 |        30 |                          0
       1603 |        67 |                          0
       1603 |        85 |                          0
       1604 |        17 |                          0
       1604 |        28 |                          0
       1604 |        70 |                          0
       1604 |        83 |                          0
       1604 |        84 |                          0
       1605 |        24 |                          0
       1605 |        37 |                          0
       1605 |        56 |                          0
       1605 |        87 |                          0
       1606 |        21 |                          0
       1606 |        42 |                          0
       1606 |        67 |                          0
       1606 |        98 | 0.000100000000000000000000
       1607 |        22 |                          0
       1607 |        23 |                          0
       1607 |        27 |                          0
       1607 |        28 |                          0
       1607 |        89 |                          0
       1632 |        29 |                          0
       1632 |        39 |                          0
       1632 |        47 |                          0
       1632 |        53 |                          0
       1632 |        98 |                          0
       1633 |        43 |                          0
       1633 |        65 |                          0
       1634 |        18 |                          0
       1634 |        39 |                          0
       1634 |        52 |                          0
       1634 |        61 |                          0
       1634 |        69 |                          0
       1634 |        72 |                          0
       1634 |        87 |                          0
       1635 |        35 |                          0
       1635 |        39 |                          0
       1635 |        58 |                          0
       1635 |        92 |                          0
       1636 |         4 |                          0
       1636 |        15 |                          0
       1636 |        37 |                          0
       1636 |        41 |                          0
       1636 |        62 |                          0
       1636 |        65 |                          0
       1636 |        91 |                          0
       1637 |        49 |                          0
       1637 |        59 |                          0
       1637 |        62 |                          0
       1637 |        67 |                          0
       1637 |        72 |                          0
       1637 |        88 |                          0
       1638 |         8 |                          0
       1638 |        26 |                          0
       1638 |        31 |                          0
       1638 |        51 |                          0
       1638 |        60 |                          0
       1638 |        91 |                          0
       1639 |        66 |                          0
       1639 |        89 |     0.00022500000000000000
       1664 |         7 |                          0
       1664 |        10 |                          0
       1664 |        42 |                          0
       1664 |        47 |                          0
       1664 |        69 |                          0
       1664 |        84 |                          0
       1665 |        53 |                          0
       1665 |        68 |                          0
       1666 |         3 |                          0
       1666 |        31 |                          0
       1666 |        50 |                          0
       1666 |        74 |                          0
       1667 |        19 |                          0
       1667 |        29 |                          0
       1667 |        66 |                          0
       1667 |        67 |                          0
       1667 |        73 |                          0
       1667 |        77 |                          0
       1667 |        85 |                          0
       1668 |        26 |                          0
       1668 |        41 |                          0
       1668 |        56 |                          0
       1668 |        75 |                          0
       1668 |        81 |                          0
       1668 |        86 |                          0
       1669 |        85 |                          0
       1670 |        15 |                          0
       1670 |        40 |                          0
       1670 |        72 |                          0
       1671 |         8 |                          0
       1671 |        11 |                          0
       1671 |        55 |                          0
       1671 |        59 |                          0
       1671 |        67 |                          0
       1671 |        68 |                          0
       1696 |         7 |                          0
       1696 |         8 |                          0
       1696 |        23 |                          0
       1696 |        29 |                          0
       1696 |        38 |                          0
       1697 |        32 |                          0
       1697 |        71 |                          0
       1697 |        75 |                          0
       1697 |        78 | 0.000100000000000000000000
       1698 |        26 |                          0
       1698 |        34 |                          0
       1698 |        57 |     0.00160000000000000000
       1698 |        60 |                          0
       1698 |        67 |                          0
       1699 |        31 |                          0
       1699 |        50 |                          0
       1700 |        61 |                          0
       1700 |        75 |                          0
       1701 |        13 |                          0
       1701 |        32 |                          0
       1701 |        76 |                          0
       1702 |        22 |                          0
       1702 |        26 |                          0
       1702 |        46 |     0.00250000000000000000
       1702 |        64 |                          0
       1702 |        82 |                          0
       1703 |        36 |                          0
       1703 |        39 |                          0
       1703 |        97 |                          0
       1728 |        28 |                          0
       1728 |        65 |                          0
       1728 |        70 |                          0
       1728 |        80 |                          0
       1729 |        71 |                          0
       1730 |        15 |                          0
       1730 |        53 |                          0
       1730 |        71 |                          0
       1730 |        82 |                          0
       1730 |        97 |                          0
       1731 |        25 |                          0
       1731 |        41 |     0.00062500000000000000
       1731 |        47 |                          0
       1731 |        60 |                          0
       1731 |        92 |                          0
       1732 |        14 |                          0
       1732 |        27 |                          0
       1732 |        31 |                          0
       1732 |        45 |                          0
       1732 |        83 |                          0
       1732 |        92 |                          0
       1733 |         6 |                          0
       1733 |        22 |                          0
       1733 |        33 |                          0
       1733 |        38 |                          0
       1733 |        42 |                          0
       1733 |        56 |                          0
       1733 |        93 |                          0
       1734 |        15 |                          0
       1734 |        90 |                          0
       1735 |        25 |                          0
       1735 |        56 |                          0
       1760 |        24 |                          0
       1760 |        46 |                          0
       1760 |        74 |                          0
       1761 |         2 |                          0
       1761 |        10 |                          0
       1761 |        13 |                          0
       1761 |        17 |                          0
       1761 |        20 |                          0
       1761 |        23 |                          0
       1761 |        60 |                          0
       1762 |         4 |                          0
       1762 |         8 |                          0
       1762 |        48 |                          0
       1762 |        55 |                          0
       1762 |        63 |                          0
       1762 |        76 |                          0
       1762 |        82 |                          0
       1763 |         6 | 0.000025000000000000000000
       1763 |        22 |                          0
       1763 |        70 | 0.000025000000000000000000
       1763 |        71 |                          0
       1763 |        96 |                          0
       1764 |         4 |                          0
       1764 |        28 |                          0
       1764 |        69 |                          0
       1765 |         7 |                          0
       1766 |        17 |                          0
       1766 |        69 |     0.00022500000000000000
       1767 |         3 |                          0
       1767 |         5 |                          0
       1767 |        41 |                          0
       1767 |        47 |                          0
       1767 |        52 |                          0
       1792 |         8 |                          0
       1792 |        39 |                          0
       1792 |        47 |                          0
       1792 |        63 |                          0
       1792 |        77 |                          0
       1793 |         2 |                          0
       1793 |        40 |                          0
       1793 |        47 |                          0
       1793 |        64 |                          0
       1793 |        86 |                          0
       1794 |        14 |                          0
       1794 |        15 |                          0
       1794 |        37 |                          0
       1794 |        38 |                          0
       1794 |        63 |                          0
       1794 |        75 |                          0
       1795 |        33 |                          0
       1795 |        48 |                          0
       1795 |        61 |                          0
       1795 |        63 |                          0
       1795 |       100 |                          0
       1796 |        36 |                          0
       1796 |       100 |                          0
       1797 |        36 |                          0
       1797 |        71 |                          0
       1797 |        83 |                          0
       1798 |        90 |                          0
       1799 |        43 |                          0
       1799 |        46 |                          0
       1824 |         6 |                          0
       1824 |        76 |                          0
       1825 |        14 |                          0
       1825 |        17 |                          0
       1825 |        32 |                          0
       1825 |        78 |                          0
       1825 |        80 |                          0
       1826 |        45 |                          0
       1826 |        49 |                          0
       1826 |        62 |                          0
       1826 |        66 |                          0
       1826 |        80 |                          0
       1826 |        84 |                          0
       1827 |         6 |                          0
       1827 |        12 |                          0
       1827 |        29 |                          0
       1827 |        61 |                          0
       1827 |        77 |                          0
       1827 |        95 |                          0
       1827 |       100 |                          0
       1828 |         4 |                          0
       1828 |        29 |                          0
       1828 |        60 |                          0
       1828 |        79 |                          0
       1828 |        99 |                          0
       1829 |         7 |                          0
       1829 |        31 |                          0
       1829 |        40 |                          0
       1829 |        48 |                          0
       1829 |        56 |                          0
       1829 |       100 |                          0
       1830 |        33 |                          0
       1830 |        45 |                          0
       1830 |        73 |                          0
       1831 |        11 |                          0
       1831 |        59 |                          0
       1831 |        72 |                          0
       1831 |        91 |                          0
       1856 |         9 |                          0
       1856 |        11 | 0.000025000000000000000000
       1856 |        39 |                          0
       1856 |        75 |                          0
       1856 |        94 |                          0
       1856 |        98 |                          0
       1857 |         6 |                          0
       1857 |        27 |                          0
       1857 |        40 |                          0
       1857 |        66 |                          0
       1858 |        67 |                          0
       1859 |         8 |                          0
       1859 |        10 |                          0
       1859 |        51 |                          0
       1859 |        80 |                          0
       1859 |        84 |                          0
       1859 |        99 |                          0
       1860 |        31 |                          0
       1861 |         5 |                          0
       1861 |        34 |                          0
       1861 |        61 |                          0
       1861 |        65 |                          0
       1861 |        69 |                          0
       1862 |        25 |                          0
       1862 |        46 |                          0
       1862 |        56 |                          0
       1863 |        51 |                          0
       1863 |        57 |                          0
       1888 |         6 |                          0
       1888 |        12 |                          0
       1888 |        36 |                          0
       1888 |        87 |     0.00122500000000000000
       1888 |        97 |                          0
       1888 |        98 |                          0
       1889 |        18 |                          0
       1889 |        33 |                          0
       1889 |        49 |                          0
       1889 |        60 |                          0
       1890 |        13 |                          0
       1890 |        15 |                          0
       1890 |        43 |                          0
       1890 |        52 |                          0
       1890 |        74 |                          0
       1890 |        80 |                          0
       1890 |        96 |                          0
       1891 |        62 |                          0
       1891 |        73 |                          0
       1891 |        75 |                          0
       1892 |         9 |                          0
       1892 |        10 |                          0
       1892 |        15 |                          0
       1892 |        65 |                          0
       1893 |        18 |                          0
       1893 |        22 |                          0
       1893 |        43 |                          0
       1893 |        75 |                          0
       1893 |        78 |                          0
       1894 |        84 |                          0
       1895 |        26 |                          0
       1920 |        23 |                          0
       1920 |        35 |                          0
       1920 |        55 |                          0
       1920 |        69 |                          0
       1920 |        99 |                          0
       1921 |        10 |                          0
       1921 |        36 |                          0
       1921 |        62 |                          0
       1922 |        49 |                          0
       1923 |        17 |                          0
       1923 |        18 |                          0
       1923 |        63 |                          0
       1923 |        72 |                          0
       1923 |        98 |                          0
       1923 |        99 |                          0
       1924 |        12 |                          0
       1924 |        23 |                          0
       1924 |        53 |                          0
       1924 |        55 |                          0
       1924 |        69 |                          0
       1924 |        89 |                          0
       1924 |        97 |                          0
       1925 |        25 |                          0
       1925 |        26 |                          0
       1925 |        58 |                          0
       1925 |        88 |                          0
       1926 |         4 |                          0
       1926 |        35 |                          0
       1926 |        57 |                          0
       1926 |        79 |                          0
       1926 |        87 |                          0
       1927 |        42 |     0.00062500000000000000
       1927 |        90 |                          0
       1952 |        82 |                          0
       1952 |        96 |                          0
       1953 |        40 |                          0
       1953 |        89 |                          0
       1954 |        36 |                          0
       1954 |        64 | 0.000100000000000000000000
       1954 |        76 |                          0
       1954 |        81 |                          0
       1954 |        94 |                          0
       1954 |        99 |                          0
       1955 |        18 |                          0
       1955 |        34 |                          0
       1955 |        50 |                          0
       1955 |        86 |                          0
       1955 |       100 |                          0
       1956 |        29 |                          0
       1956 |        30 |                          0
       1956 |        65 |                          0
       1956 |        66 |                          0
       1956 |        84 |                          0
       1957 |        16 |                          0
       1957 |        18 |                          0
       1958 |        15 |                          0
       1958 |        16 |                          0
       1958 |        19 |                          0
       1958 |        52 |                          0
       1958 |        69 |                          0
       1958 |        86 |                          0
       1958 |        94 |                          0
       1959 |        68 |                          0
       1959 |        88 |                          0
       1984 |        12 |                          0
       1984 |        63 |                          0
       1985 |        32 |                          0
       1985 |        50 |                          0
       1985 |        54 |                          0
       1985 |        72 |                          0
       1985 |        77 |                          0
       1985 |        83 |                          0
       1986 |        16 |                          0
       1986 |        60 |                          0
       1986 |        83 |                          0
       1987 |        30 |                          0
       1988 |        18 |                          0
       1988 |        29 |                          0
       1988 |        47 |                          0
       1988 |        60 |                          0
       1988 |        76 |                          0
       1988 |        86 |                          0
       1989 |        75 |                          0
       1990 |        11 |                          0
       1991 |        25 |                          0
       1991 |        27 |                          0
       1991 |        37 |                          0
       1991 |        51 |                          0
       1991 |        60 |                          0
       2016 |         1 |                          0
       2016 |        21 |                          0
       2016 |        53 |                          0
       2017 |         2 | 0.000100000000000000000000
       2017 |        27 |                          0
       2018 |        44 |                          0
       2018 |        83 |                          0
       2019 |        80 |                          0
       2019 |        84 |                          0
       2020 |        18 |                          0
       2020 |        21 |                          0
       2020 |        72 |                          0
       2020 |        84 |                          0
       2021 |        36 |                          0
       2021 |        48 |                          0
       2022 |        15 |                          0
       2022 |        27 |                          0
       2022 |        73 |                          0
       2022 |        79 |                          0
       2022 |        90 |                          0
       2022 |        94 |                          0
       2022 |        96 |                          0
       2023 |        17 |                          0
       2023 |        36 |                          0
       2023 |        39 |                          0
       2023 |        63 |                          0
       2023 |        74 |                          0
       2023 |        75 |                          0
       2023 |        79 |                          0
       2048 |         7 |                          0
       2048 |        50 |                          0
       2048 |        66 |                          0
       2048 |        72 |                          0
       2049 |        56 |                          0
       2049 |        76 |                          0
       2049 |        82 |                          0
       2049 |        91 |                          0
       2049 |        98 | 0.000100000000000000000000
       2050 |         1 |                          0
       2050 |         3 |                          0
       2050 |        17 |                          0
       2050 |        22 |                          0
       2050 |        44 |                          0
       2050 |        80 |                          0
(2000 rows)

set enable_groupagg=off;
set enable_hashagg=on;
select l_suppkey, avg(l_discount) from heap_lineitem group by l_suppkey;
 l_suppkey |          avg           
-----------+------------------------
        30 | 0.05136915077989601386
        24 | 0.04888146911519198664
        26 | 0.04918461538461538462
        88 | 0.05073409461663947798
        50 | 0.04923344947735191638
        46 | 0.05092233009708737864
        90 | 0.05037650602409638554
        56 | 0.04950248756218905473
        16 | 0.04693086003372681282
        48 | 0.05199667221297836938
        60 | 0.04956656346749226006
        76 | 0.05022727272727272727
        98 | 0.05087314662273476112
        32 | 0.05015337423312883436
        28 | 0.04918110236220472441
        20 | 0.04966273187183811130
        12 | 0.05209702660406885759
        36 | 0.05189279731993299832
        74 | 0.04855284552845528455
         4 | 0.05078947368421052632
       100 | 0.04945000000000000000
        44 | 0.04892665474060822898
        18 | 0.05097913322632423756
        70 | 0.04981543624161073826
        40 | 0.04974402730375426621
        38 | 0.05109281437125748503
         8 | 0.04864093959731543624
        62 | 0.05044964028776978417
        10 | 0.05001706484641638225
        68 | 0.05027397260273972603
        92 | 0.04969849246231155779
         6 | 0.05039497307001795332
        22 | 0.04887459807073954984
        82 | 0.05189144736842105263
        34 | 0.05091695501730103806
        66 | 0.05005076142131979695
        14 | 0.05037156704361873990
        42 | 0.04882736156351791531
        72 | 0.05208261617900172117
        54 | 0.05091917591125198098
        86 | 0.04883561643835616438
         2 | 0.05168458781362007168
        64 | 0.04815331010452961672
        94 | 0.04888288288288288288
        78 | 0.04863716814159292035
        84 | 0.04885714285714285714
        52 | 0.04737676056338028169
        80 | 0.04927487352445193929
        58 | 0.05123239436619718310
        96 | 0.05035598705501618123
        55 | 0.05143872113676731794
        43 | 0.04752107925801011804
        11 | 0.04922033898305084746
        63 | 0.04851063829787234043
        17 | 0.05054817275747508306
        97 | 0.04915721231766612642
        31 | 0.04931637519872813990
        77 | 0.05031825795644891122
        41 | 0.04882736156351791531
        73 | 0.04911666666666666667
        49 | 0.04980263157894736842
        75 | 0.05018209408194233687
        65 | 0.04805414551607445008
        25 | 0.04877516778523489933
        89 | 0.05038834951456310680
        85 | 0.05064462809917355372
        99 | 0.05060937500000000000
        79 | 0.04789735099337748344
        91 | 0.04996683250414593698
        57 | 0.05217105263157894737
        51 | 0.04938775510204081633
        59 | 0.05274959083469721768
         1 | 0.04936585365853658537
        13 | 0.04978685612788632327
        37 | 0.05047385620915032680
         5 | 0.04746710526315789474
        21 | 0.05075235109717868339
        23 | 0.05074750830564784053
        45 | 0.04921005385996409336
         7 | 0.05100694444444444444
        93 | 0.05110108303249097473
        27 | 0.05145484949832775920
        33 | 0.05103610675039246468
        69 | 0.04862416107382550336
        39 | 0.04821428571428571429
        95 | 0.05078947368421052632
        87 | 0.04828947368421052632
        71 | 0.05020338983050847458
        35 | 0.04907742998352553542
        81 | 0.05029752066115702479
        67 | 0.05114963503649635036
        83 | 0.04958949096880131363
        47 | 0.05012216404886561955
        15 | 0.05018612521150592217
        19 | 0.04988562091503267974
         3 | 0.04984536082474226804
         9 | 0.04865996649916247906
        53 | 0.05031353135313531353
        29 | 0.05185000000000000000
        61 | 0.04991349480968858131
(100 rows)

set statement_mem= 7000;
set enable_groupagg=off;
set enable_hashagg=on;
select l_orderkey, covar_pop(l_partkey, l_suppkey) as covar_pop from heap_lineitem group by l_orderkey order by l_orderkey, covar_pop limit 2000;
 l_orderkey |     covar_pop     
------------+-------------------
          1 |  11704.0277777778
          2 |                 0
          3 |  7178.33333333333
          4 |                 0
          5 |  9137.77777777778
          6 |                 0
          7 |  3885.75510204082
         32 | -7006.83333333333
         33 |          -4234.75
         34 |              9967
         35 |  4982.55555555556
         36 |                 0
         37 | -3179.77777777778
         38 |                 0
         39 |  6665.13888888889
         64 |                 0
         65 |             -2586
         66 |          -7724.75
         67 | -8883.11111111111
         68 | -5638.71428571429
         69 |  10096.0833333333
         70 |  4252.66666666667
         71 |  2618.16666666667
         96 |               369
         97 |                14
         98 |          8082.375
         99 |        -1042.3125
        100 |            4665.8
        101 | -2686.22222222222
        102 |              5378
        103 |              9177
        128 |                 0
        129 | -2089.67346938776
        130 |           10695.8
        131 |  7907.44444444444
        132 |          -1045.75
        133 |          227.4375
        134 |  8465.77777777778
        135 |            1767.5
        160 |  11134.7777777778
        161 |                 0
        162 |                 0
        163 |  477.611111111111
        164 |  7862.10204081633
        165 |          -4694.76
        166 |          1433.875
        167 |              8096
        192 |  349.083333333333
        193 | -920.222222222222
        194 |  1312.77551020408
        195 |         -239.4375
        196 |               939
        197 |  2796.66666666667
        198 |          -1615.84
        199 |             23.75
        224 | -6429.58333333333
        225 | -1016.48979591837
        226 |  1292.63265306122
        227 |              -198
        228 |                 0
        229 | -726.555555555556
        230 |  11704.5833333333
        231 |             -2832
        256 |              3730
        257 |                 0
        258 |          -4640.75
        259 |            878.52
        260 |          11143.44
        261 | -10468.5555555556
        262 | -21487.6666666667
        263 | -4275.22222222222
        288 |         -13987.52
        289 |           2901.68
        290 |          7798.625
        291 | -1467.44444444444
        292 |          -7737.75
        293 |  695.111111111111
        294 |                 0
        295 |        -12578.875
        320 |           21585.5
        321 |              1401
        322 | -3127.69387755102
        323 | -4303.33333333333
        324 |                 0
        325 |  16594.6666666667
        326 |  11301.4489795918
        327 |              1527
        352 |                 0
        353 |  3172.41666666667
        354 |  3154.28571428571
        355 |          -2282.25
        356 |            483.88
        357 | -3157.44444444444
        358 | -7713.81632653061
        359 |            -10.75
        384 |          -8123.16
        385 |          -24097.5
        386 | -6804.44444444444
        387 |          -3889.32
        388 |             12272
        389 |                 0
        390 |  -1426.4693877551
        391 |                 0
        416 |  4947.33333333333
        417 |        -10903.125
        418 |  2250.33333333333
        419 |          -3262.92
        420 | -2013.69387755102
        421 |                 0
        422 |           757.125
        423 |                 0
        448 |           9388.16
        449 |          7543.875
        450 | -4241.94444444444
        451 |         -868.9375
        452 |                 0
        453 | -3215.66666666667
        454 |                 0
        455 |        -2274.0625
        480 |                 0
        481 |           7342.32
        482 | -221.555555555556
        483 | -1216.77777777778
        484 |  8671.16666666667
        485 |  14489.3333333333
        486 |  2498.94444444444
        487 |               -49
        512 |               806
        513 |           2545.75
        514 |           -3878.5
        515 | -2500.97222222222
        516 |                 0
        517 |            604.64
        518 |  3688.48979591837
        519 |  10106.1666666667
        544 |                 0
        545 |               -15
        546 |                 0
        547 | -13180.4444444444
        548 | -5820.16666666667
        549 |           4465.96
        550 |                 0
        551 |  4930.66666666667
        576 |        -7927.9375
        577 |              7667
        578 |             78.75
        579 | -7780.19444444444
        580 |  3504.33333333333
        581 |              -327
        582 |          13105.25
        583 |           -1536.2
        608 |               657
        609 |                 0
        610 |  1551.75510204082
        611 | -3466.66666666667
        612 |  9482.94444444445
        613 |           9598.25
        614 | -971.944444444444
        615 |                 0
        640 |          -568.125
        641 |           -4721.2
        642 |                 0
        643 |           21522.2
        644 | -2878.42857142857
        645 |  -3294.9387755102
        646 |  699.111111111111
        647 | -15703.1111111111
        672 |  3772.33333333333
        673 |                 0
        674 |             646.5
        675 |          -7920.16
        676 |  1288.48979591837
        677 |            9204.8
        678 |  7444.94444444444
        679 |                 0
        704 |         -18144.75
        705 |             -7931
        706 |                 0
        707 |             -2242
        708 |  10157.6388888889
        709 |         -5518.875
        710 |  -5216.4693877551
        711 |              -206
        736 |            -916.4
        737 |                 0
        738 |           2290.96
        739 |           -9305.6
        740 |  647.111111111111
        741 |          -5045.25
        742 |  1720.16666666667
        743 |                 0
        768 |  7073.97959183673
        769 |              2480
        770 |           -5710.5
        771 | -514.444444444444
        772 |          -1716.72
        773 | -2745.55555555556
        774 |  10955.1111111111
        775 | -3201.77777777778
        800 | -9736.88888888889
        801 |   7043.5306122449
        802 |            890.08
        803 |           -792.75
        804 |        -1714.3125
        805 |       -14873.4375
        806 |  4852.22222222222
        807 | -13146.5714285714
        832 |              4440
        833 |  15.6666666666667
        834 |             20923
        835 |           -585.75
        836 | -4262.66666666667
        837 |             -1771
        838 |         2979.6875
        839 |           -547.75
        864 |  408.666666666667
        865 |         -8709.625
        866 |                 0
        867 |                 0
        868 |  9360.66666666667
        869 |             -1458
        870 |             -6835
        871 |  -3750.4693877551
        896 |  -21416.693877551
        897 |        -2245.8125
        898 |        -14617.375
        899 | -2220.69387755102
        900 | -3018.44444444444
        901 |            -420.5
        902 |  2694.22222222222
        903 |  11241.1666666667
        928 |  10796.7959183673
        929 |          7166.625
        930 |  2511.44897959184
        931 |          2828.625
        932 |                 0
        933 | -176.444444444444
        934 |                 0
        935 |  6229.58333333333
        960 |              6075
        961 |           2231.25
        962 | -11276.8888888889
        963 |          13158.75
        964 |         -299.5625
        965 |           -3382.5
        966 |         -4739.875
        967 |   1632.9387755102
        992 | -822.666666666667
        993 |   15426.612244898
        994 |         -4479.375
        995 |           3028.08
        996 |                 0
        997 |            -13824
        998 |            3766.8
        999 | -8320.05555555555
       1024 |           2632.68
       1025 |  3309.77777777778
       1026 |                32
       1027 | -3025.38888888889
       1028 | -2500.40816326531
       1029 |                 0
       1030 |                 0
       1031 |           5733.68
       1056 |                 0
       1057 | -5004.88888888889
       1058 |           1900.75
       1059 | -47.8367346938776
       1060 |  4172.85714285714
       1061 |  1333.16666666667
       1062 |                 0
       1063 |                 0
       1088 |         -1619.625
       1089 |          -5840.75
       1090 |          18407.25
       1091 |                 0
       1092 |            -253.5
       1093 |  16979.5555555556
       1094 |                 0
       1095 |  1092.11111111111
       1120 |           -8535.6
       1121 | -1818.14285714286
       1122 | -5242.63265306122
       1123 | -20112.4444444444
       1124 | -1980.57142857143
       1125 |          2438.625
       1126 |  2459.11111111111
       1127 |          -8687.75
       1152 | -8192.66666666667
       1153 |  4708.10204081633
       1154 |           14955.5
       1155 |           1622.48
       1156 | -3409.71428571429
       1157 |           3652.16
       1158 |            2515.5
       1159 |  1628.88888888889
       1184 |        -9891.6875
       1185 |  2458.66666666667
       1186 |         3820.6875
       1187 |  84.8888888888889
       1188 |  5316.66666666667
       1189 |  1159.88888888889
       1190 |                 0
       1191 |                 0
       1216 |  4884.44444444444
       1217 |                 0
       1218 |             -3115
       1219 |               594
       1220 |            3868.2
       1221 |  4787.08333333333
       1222 |  6679.33333333333
       1223 |                 0
       1248 | -3586.11111111111
       1249 |                 0
       1250 |                 0
       1251 |            -11.24
       1252 |           -1477.4
       1253 |             -2196
       1254 |  4342.44444444444
       1255 |             33.25
       1280 | -1973.87755102041
       1281 |  2146.32653061224
       1282 |        13023.0625
       1283 |  4909.48979591837
       1284 |          -1324.88
       1285 |           2389.68
       1286 |  8203.22222222222
       1287 |  6071.44444444444
       1312 | -2706.66666666667
       1313 |                 0
       1314 |  2069.33333333333
       1315 |            1988.4
       1316 |  6981.28571428571
       1317 |           -1519.8
       1318 |             -9773
       1319 |           2976.75
       1344 |               747
       1345 |  2327.33333333333
       1346 |  3789.86111111111
       1347 | -5808.38775510204
       1348 |         17277.875
       1349 |              5661
       1350 |              1500
       1351 |                 0
       1376 |                 0
       1377 |  337.666666666667
       1378 |  2375.83333333333
       1379 |             -6760
       1380 |           3314.25
       1381 |            2747.5
       1382 | -1173.85714285714
       1383 |            1471.5
       1408 | -2090.71428571429
       1409 |  13989.3333333333
       1410 |          -8305.72
       1411 |  12382.1944444444
       1412 |          -6928.88
       1413 |  8380.55555555555
       1414 |              1384
       1415 |                 0
       1440 |          -6868.75
       1441 | -10164.8979591837
       1442 |                 0
       1443 |                 0
       1444 | -4821.71428571429
       1445 |              -350
       1446 |                 0
       1447 | -2815.66666666667
       1472 |  8886.77777777778
       1473 |              -945
       1474 |  8093.66666666667
       1475 | -42.2448979591837
       1476 |                 0
       1477 |             -2732
       1478 |                 0
       1479 |                 0
       1504 |         -10906.24
       1505 |             -43.5
       1506 |   1339.0612244898
       1507 |  4561.66666666667
       1508 |  9461.28571428571
       1509 |  15142.0816326531
       1510 |             -3428
       1511 |              -531
       1536 |                 0
       1537 |        15311.1875
       1538 |           -734.25
       1539 |  3496.88888888889
       1540 |           3141.64
       1541 |               754
       1542 |            3889.6
       1543 |  320.530612244898
       1568 |              2412
       1569 |          -1865.25
       1570 |             12932
       1571 |  4694.22222222222
       1572 |          -1889.25
       1573 |  7118.77777777778
       1574 |  4504.28571428571
       1575 | -10077.5102040816
       1600 |           5570.44
       1601 |              6184
       1602 |                 0
       1603 |            1219.5
       1604 |          -1271.64
       1605 |          -9539.75
       1606 |          -7543.28
       1607 |           -8481.4
       1632 |          -1188.84
       1633 |              9559
       1634 | -10506.3673469388
       1635 |            -122.5
       1636 |  5050.42857142857
       1637 | -734.224489795918
       1638 |          -1829.75
       1639 | -4078.66666666667
       1664 | -5297.27777777778
       1665 |            1147.5
       1666 |           9979.75
       1667 |   202.30612244898
       1668 | -1852.36111111111
       1669 |                 0
       1670 | -9387.11111111111
       1671 | -2551.11111111111
       1696 |             649.8
       1697 |          -1131.12
       1698 |  5085.05555555556
       1699 |           4631.25
       1700 |              -567
       1701 | -10970.6666666667
       1702 |  1193.38888888889
       1703 |  4777.22222222222
       1728 |             45.24
       1729 |                 0
       1730 |          -2744.36
       1731 |  8450.33333333333
       1732 |  861.833333333333
       1733 | -5142.65306122449
       1734 |           6956.25
       1735 |           1309.75
       1760 |             -7920
       1761 | -4219.04081632653
       1762 |  2041.42857142857
       1763 | -13145.0612244898
       1764 |             -4060
       1765 |                 0
       1766 |             -5824
       1767 |            3328.6
       1792 |          10368.84
       1793 |           6656.32
       1794 |              5396
       1795 |              3056
       1796 |            -28000
       1797 |  6964.11111111111
       1798 |                 0
       1799 |              -186
       1824 |           -9012.5
       1825 |           7290.36
       1826 |  5993.83333333333
       1827 |  8884.73469387755
       1828 |           13427.2
       1829 |  3637.33333333333
       1830 | -6500.88888888889
       1831 |         1776.8125
       1856 |  15418.2857142857
       1857 |         -4194.125
       1858 |                 0
       1859 | -11835.1111111111
       1860 |                 0
       1861 |            2335.8
       1862 |  7094.55555555556
       1863 |           -1417.5
       1888 |  -6943.9387755102
       1889 |            -617.5
       1890 | -5637.61224489796
       1891 |  2994.33333333333
       1892 |             -24.5
       1893 |           5660.72
       1894 |                 0
       1895 |                 0
       1920 |          -3236.64
       1921 | -4350.66666666667
       1922 |                 0
       1923 | -9277.08333333333
       1924 | -1302.61224489796
       1925 |          1213.125
       1926 |           -7707.4
       1927 |               656
       1952 |              3136
       1953 |           13940.5
       1954 |  -1220.9387755102
       1955 |           7402.56
       1956 |          -7296.96
       1957 |               199
       1958 |               105
       1959 |              2460
       1984 |           2282.25
       1985 |  11060.2777777778
       1986 |  650.333333333333
       1987 |                 0
       1988 | -8530.11111111111
       1989 |                 0
       1990 |                 0
       1991 |            -521.4
       2016 |             -1184
       2017 |  1433.33333333333
       2018 |          -6444.75
       2019 |              -486
       2020 |        15623.8125
       2021 |             -2415
       2022 | -11603.1224489796
       2023 |  1621.63265306122
       2048 |         -4330.375
       2049 |  4027.91666666667
       2050 |  5854.85714285714
       2051 |          13400.25
       2052 |        10893.4375
       2053 |         4176.3125
       2054 | -1879.63265306122
       2055 |           2323.75
       2080 |          -14257.5
       2081 | -3454.27777777778
       2082 |          -1881.25
       2083 |                 0
       2084 |  1039.20408163265
       2085 |                 0
       2086 |  1138.30612244898
       2087 |          8507.875
       2112 |                 0
       2113 |              1265
       2114 | -1211.33333333333
       2115 |         -10941.64
       2116 |  4516.33333333333
       2117 |           1163.25
       2118 | -2278.11111111111
       2119 |                 0
       2144 |        -2458.9375
       2145 |          10136.25
       2146 |             -9141
       2147 |        -6252.5625
       2148 |                 0
       2149 |           1928.56
       2150 | -9430.66666666667
       2151 |           4490.25
       2176 |        11697.0625
       2177 | -1779.44444444444
       2178 |             -1404
       2179 |           2709.48
       2180 |  4694.66666666667
       2181 |            9417.2
       2182 |          -3664.28
       2183 |              1372
       2208 |  12483.8571428571
       2209 | -7012.08333333333
       2210 |                 0
       2211 |  4774.69387755102
       2212 |                 0
       2213 | -1475.71428571429
       2214 |            1843.5
       2215 |          4617.125
       2240 |  5205.85714285714
       2241 |  59.0204081632653
       2242 |                 0
       2243 |                 0
       2244 |            -17088
       2245 |           5665.44
       2246 |              1330
       2247 |                 0
       2272 |          -4136.96
       2273 | -6667.30612244898
       2274 |  11404.6666666667
       2275 |             -2288
       2276 | -8573.77777777778
       2277 |         10094.125
       2278 |  2653.55555555556
       2279 |  3284.61224489796
       2304 | -10469.7777777778
       2305 |  12052.6388888889
       2306 |  695.244897959184
       2307 |           -3896.2
       2308 |           9130.25
       2309 |  7905.87755102041
       2310 | -15533.1111111111
       2311 |              1660
       2336 |                 0
       2337 |                 0
       2338 |                 0
       2339 | -2162.66666666667
       2340 |             -2484
       2341 |              -894
       2342 |         -21945.84
       2343 | -8448.33333333333
       2368 |          3425.875
       2369 |           23497.5
       2370 |           231.875
       2371 | -7054.79591836735
       2372 | -11546.1428571429
       2373 |          2639.125
       2374 |           -984.96
       2375 | -4068.33333333333
       2400 |         1442.6875
       2401 |           -5830.5
       2402 |           -9047.5
       2403 |          5369.125
       2404 |             -3104
       2405 |        -10861.125
       2406 |  -12662.612244898
       2407 | -2765.63265306122
       2432 |         -3718.875
       2433 |          -1476.36
       2434 |           2315.25
       2435 |              6554
       2436 |              -771
       2437 |  3134.66666666667
       2438 |              3836
       2439 |  5445.33333333333
       2464 |               521
       2465 | -1424.33333333333
       2466 | -5401.61224489796
       2467 |                 0
       2468 |           -2337.2
       2469 |  4241.83673469388
       2470 |         -6388.125
       2471 |                 0
       2496 |           6495.75
       2497 | -1625.66666666667
       2498 |                 0
       2499 |             -3865
       2500 |         -7618.625
       2501 |          -2317.75
       2502 |                 0
       2503 | -1789.55102040816
       2528 |          6541.875
       2529 |                 0
       2530 |  2525.55555555556
       2531 | -2405.44444444444
       2532 |  5365.44444444444
       2533 | -2975.85714285714
       2534 |  3924.32653061224
       2535 |          11432.96
       2560 |  5655.94444444444
       2561 |  5029.33333333333
       2562 |            4851.5
       2563 | -1841.47222222222
       2564 |                 0
       2565 |              6756
       2566 | -4115.38888888889
       2567 | -3248.69387755102
       2592 |              2820
       2593 | -5145.73469387755
       2594 |              2994
       2595 | -8015.30555555556
       2596 |           3464.25
       2597 |                 0
       2598 |              1889
       2599 |              -925
       2624 |                 0
       2625 |                 0
       2626 | -7734.66666666667
       2627 |                 0
       2628 |           3505.56
       2629 |        -2242.0625
       2630 |         5565.9375
       2631 |  4815.44444444444
       2656 |          4466.625
       2657 | -4025.66666666667
       2658 | -5605.58333333333
       2659 |            7755.4
       2660 |                 0
       2661 |         -5220.875
       2662 |         2098.4375
       2663 |                 0
       2688 |  3981.58333333333
       2689 |                 0
       2690 | -1877.77551020408
       2691 |         -7318.375
       2692 |            -19480
       2693 |            -15844
       2694 |           5537.36
       2695 |           -7721.4
       2720 |           -466.12
       2721 |           18429.5
       2722 | -2402.66666666667
       2723 |           1006.92
       2724 |            8323.2
       2725 | -20122.3333333333
       2726 |                 0
       2727 |                 0
       2752 |  7391.71428571429
       2753 |  6839.65306122449
       2754 |            5219.5
       2755 |           -8703.2
       2756 |              2117
       2757 |           -2639.4
       2758 |  10531.8888888889
       2759 |           2239.25
       2784 |       -10370.5625
       2785 |         -978.0625
       2786 |            -446.5
       2787 |                 0
       2788 |                 0
       2789 |  13633.4489795918
       2790 |  5545.69387755102
       2791 |  1364.30612244898
       2816 | -9854.77777777778
       2817 |          -3172.25
       2818 |  324.611111111111
       2819 |           5506.76
       2820 |          -3808.75
       2821 |            -10127
       2822 |                 0
       2823 |  2781.36734693878
       2848 |            320.68
       2849 |  3564.77777777778
       2850 |         -9763.875
       2851 |                 0
       2852 |          -5734.32
       2853 |           6688.32
       2854 |  8120.16666666667
       2855 |                 0
       2880 |             -2468
       2881 |         -17160.25
       2882 | -13488.8333333333
       2883 |          -2604.88
       2884 |              5213
       2885 | -7579.18367346939
       2886 |        -6893.5625
       2887 |              3910
       2912 |            120.75
       2913 | -8726.38888888889
       2914 |       -14675.1875
       2915 |         10928.875
       2916 |                 0
       2917 |            8928.5
       2918 |                 0
       2919 |           -1736.5
       2944 | -1048.51020408163
       2945 |  593.224489795918
       2946 |             -3328
       2947 |             42072
       2948 |           3662.25
       2949 |  10981.8888888889
       2950 |              6660
       2951 |  6900.77777777778
       2976 | -3740.38888888889
       2977 |                 0
       2978 | -7606.83333333333
       2979 |              3262
       2980 | -5223.83333333333
       2981 |  17628.8888888889
       2982 | -2642.33333333333
       2983 |          -13121.5
       3008 |           8647.76
       3009 |             17788
       3010 |  8188.33333333333
       3011 |             -1496
       3012 |              7140
       3013 |             -3749
       3014 |  1311.88888888889
       3015 |  7183.33333333333
       3040 |  2568.69444444444
       3041 | -164.444444444444
       3042 |          -3402.75
       3043 |             -1317
       3044 |  220.333333333333
       3045 |           1608.75
       3046 | -7833.77777777778
       3047 |            -11700
       3072 |           -322.72
       3073 |  -4615.0612244898
       3074 |          19068.75
       3075 |           -2426.5
       3076 |             -7414
       3077 |             459.5
       3078 |           1493.25
       3079 | -4981.44444444444
       3104 |        -1402.1875
       3105 |           -9841.5
       3106 |           7060.16
       3107 |         -7740.625
       3108 |           8108.25
       3109 |            5978.5
       3110 |         -13273.84
       3111 |  6034.69387755102
       3136 | -1043.91666666667
       3137 |                21
       3138 | -10491.5277777778
       3139 |                 0
       3140 |             -3535
       3141 |          -914.125
       3142 |                 0
       3143 |             -3332
       3168 |         4063.0625
       3169 |  1461.91666666667
       3170 |  857.591836734694
       3171 |             -2070
       3172 |           5653.68
       3173 |           6101.68
       3174 |  1227.33333333333
       3175 | -1847.63265306122
       3200 |  3878.22222222222
       3201 | -298.666666666667
       3202 |          -4479.75
       3203 |           3211.75
       3204 |               110
       3205 | -4210.59183673469
       3206 |              3176
       3207 |              4225
       3232 |  3857.66666666667
       3233 |          8089.125
       3234 |           -372.44
       3235 |          5269.125
       3236 |  329.333333333333
       3237 |                 0
       3238 | -3514.77777777778
       3239 |             230.4
       3264 |  6190.72222222222
       3265 |  23361.3333333333
       3266 |           5502.75
       3267 |                 0
       3268 |              1074
       3269 | -1076.63888888889
       3270 | -7929.14285714286
       3271 |          -34.8125
       3296 |  5182.40816326531
       3297 |                 0
       3298 |          -6249.25
       3299 |                 0
       3300 |              2702
       3301 |                 0
       3302 |                 0
       3303 |         6666.1875
       3328 |            7346.2
       3329 | -4131.22222222222
       3330 |                 0
       3331 |  2764.33333333333
       3332 |  814.666666666667
       3333 |             762.8
       3334 |               169
       3335 |           3247.25
       3360 |  9936.66666666667
       3361 | -39.3333333333333
       3362 | -3677.33333333333
       3363 |           7327.44
       3364 |          -5026.04
       3365 |  14528.1666666667
       3366 |             -1908
       3367 | -10218.6666666667
       3392 |          2567.875
       3393 |  4124.55555555556
       3394 |  4994.97222222222
       3395 |         3484.8125
       3396 | -7940.71428571429
       3397 |          -10481.6
       3398 |                 0
       3399 |        -3935.9375
       3424 |                 0
       3425 |  6968.88888888889
       3426 |           6266.84
       3427 |         6199.4375
       3428 |  1352.66666666667
       3429 |            608.24
       3430 |  5242.36734693878
       3431 |                 0
       3456 |                 0
       3457 |  12307.5714285714
       3458 | -12952.1111111111
       3459 |           -9420.2
       3460 | -1749.83673469388
       3461 |              8703
       3462 |          -5248.68
       3463 |               837
       3488 |           7260.72
       3489 |             -3152
       3490 | -445.666666666667
       3491 |           4517.25
       3492 |  4931.83333333333
       3493 |             -7289
       3494 |        -9574.3125
       3495 |  24845.3333333333
       3520 |          -5940.84
       3521 |              -950
       3522 | -13071.1666666667
       3523 |           3600.24
       3524 |              -918
       3525 |          -819.125
       3526 |  10515.3333333333
       3527 |         -1078.375
       3552 |              6081
       3553 |          -5281.84
       3554 |             -1196
       3555 |  23.6122448979592
       3556 | -1085.66666666667
       3557 |             -2270
       3558 | -2694.61111111111
       3559 |                 0
       3584 |           3834.72
       3585 |  475.367346938775
       3586 | -1345.81632653061
       3587 |  603.571428571429
       3588 |  6122.22448979592
       3589 |                 0
       3590 | -7613.67346938776
       3591 |          -320.375
       3616 |            -10255
       3617 |           -5562.4
       3618 |          -4070.75
       3619 | -4550.44444444444
       3620 |           8362.25
       3621 |            2505.5
       3622 |          9989.625
       3623 |  1628.91836734694
       3648 | -2944.89795918367
       3649 | -781.333333333333
       3650 | -273.387755102041
       3651 |           2103.25
       3652 |           -4376.5
       3653 | -327.285714285714
       3654 | -1694.79591836735
       3655 |           9868.25
       3680 |             -7218
       3681 |                 0
       3682 |           904.875
       3683 |             -2446
       3684 |           -320.75
       3685 |            -10676
       3686 |          -2954.75
       3687 |           4739.48
       3712 |          13778.25
       3713 |  158.448979591837
       3714 |          11646.25
       3715 |  14764.8888888889
       3716 |           -543.08
       3717 | -3411.38775510204
       3718 | -4462.33333333333
       3719 | -8386.16326530612
       3744 |                 0
       3745 |                 0
       3746 |         7659.4375
       3747 |  1662.34693877551
       3748 |           2492.88
       3749 |  6982.27777777778
       3750 |  2067.19444444444
       3751 |  8342.22222222222
       3776 |          -9062.25
       3777 |          -1341.24
       3778 | -5609.42857142857
       3779 |          -3006.75
       3780 |           -6013.5
       3781 |            6590.8
       3782 |            296.64
       3783 |           4041.25
       3808 |            6231.5
       3809 |         2447.1875
       3810 |          4010.625
       3811 | -9346.38888888889
       3812 |           -3822.5
       3813 |              7128
       3814 |             -3216
       3815 |           -7666.5
       3840 |  4221.61111111111
       3841 | -9252.44444444445
       3842 |           -7842.5
       3843 |             643.5
       3844 |              -489
       3845 |  6866.16666666667
       3846 |            1221.5
       3847 |                 0
       3872 |  7983.16666666667
       3873 | -6885.22222222222
       3874 |             12016
       3875 |            4372.5
       3876 |              -884
       3877 |  3906.16666666667
       3878 |           9014.25
       3879 |               612
       3904 |              2926
       3905 |  5867.11111111111
       3906 |            3790.5
       3907 |  5816.57142857143
       3908 |              2484
       3909 |           2934.75
       3910 |            2476.5
       3911 |  430.222222222222
       3936 | -767.666666666667
       3937 |  5180.95918367347
       3938 |                 0
       3939 |                 0
       3940 |          -7071.24
       3941 |         10374.375
       3942 |             -5280
       3943 |        -9857.8125
       3968 |           1151.25
       3969 | -1366.61111111111
       3970 | -1358.83673469388
       3971 |         -12574.25
       3972 |                 0
       3973 | -4106.44444444444
       3974 |               197
       3975 |                 0
       4000 |          -6357.75
       4001 |       -13530.3125
       4002 |              1104
       4003 |                 0
       4004 |  1484.75510204082
       4005 |           -3308.8
       4006 |            4832.5
       4007 |            6619.4
       4032 |          -5583.75
       4033 |             16967
       4034 |  3629.88888888889
       4035 |             -3700
       4036 |          5469.875
       4037 |           -1572.5
       4038 |  9595.69444444445
       4039 |          -11626.4
       4064 |  10024.2448979592
       4065 | -323.591836734694
       4066 |             -1921
       4067 |  3251.34693877551
       4068 |             12006
       4069 |  7029.44897959184
       4070 |           8737.25
       4071 |          -6822.25
       4096 |         -10822.25
       4097 |  3113.55555555556
       4098 |                 0
       4099 | -13349.5918367347
       4100 |                 0
       4101 |                 0
       4102 | -1060.91666666667
       4103 |                 0
       4128 |                 0
       4129 |           1344.25
       4130 |            -24725
       4131 |            2411.5
       4132 | -1448.66666666667
       4133 |                 0
       4134 |           -67.125
       4135 |        10768.1875
       4160 |              5468
       4161 |  522.361111111111
       4162 |               -81
       4163 |                 0
       4164 |                 0
       4165 |                 0
       4166 | -4503.77551020408
       4167 | -107.333333333333
       4192 | -14524.6734693878
       4193 |              5256
       4194 |             -9012
       4195 | -2388.33333333333
       4196 |  12516.7551020408
       4197 |           2040.25
       4198 |  229.888888888889
       4199 |               152
       4224 |           6233.68
       4225 |             -3049
       4226 |                 0
       4227 |           -338.84
       4228 |                 0
       4229 |            -11123
       4230 |  530.612244897959
       4231 |        -3930.9375
       4256 |                 0
       4257 |  9995.88888888889
       4258 |           -8840.4
       4259 |                 0
       4260 |                 0
       4261 |            7749.8
       4262 |  3720.18367346939
       4263 |              -786
       4288 |  2396.55555555556
       4289 |                 0
       4290 |             -4416
       4291 |  15873.2222222222
       4292 |           -6099.5
       4293 |          -7800.75
       4294 | -5072.85714285714
       4295 |         -5948.625
       4320 |  2798.11111111111
       4321 |            4050.8
       4322 |  8162.73469387755
       4323 |                 0
       4324 |  3408.16326530612
       4325 |                 0
       4326 |            -178.5
       4327 |  4913.30555555556
       4352 |                 0
       4353 |                 0
       4354 | -8864.36734693878
       4355 |  7202.08163265306
       4356 |                 0
       4357 |            2817.5
       4358 |                 0
       4359 |         -12054.24
       4384 | -3367.66666666667
       4385 |                 0
       4386 | -1433.48979591837
       4387 |            9392.5
       4388 |  5095.22222222222
       4389 |  5514.08163265306
       4390 |          7646.375
       4391 |              3120
       4416 | -3075.33333333333
       4417 |  3376.66666666667
       4418 |  5852.11111111111
       4419 |  8431.33333333333
       4420 |                 0
       4421 | -925.551020408163
       4422 |           2536.84
       4423 |          -10315.5
       4448 | -10953.9444444444
       4449 |             -6825
       4450 |          -3099.68
       4451 |              7362
       4452 |           -1699.5
       4453 |         3198.0625
       4454 |              7305
       4455 | -10426.4444444444
       4480 |                 0
       4481 |         -13620.75
       4482 |            668.25
       4483 |  761.111111111111
       4484 | -3427.79591836735
       4485 |          -2902.88
       4486 |              3624
       4487 |          2636.375
       4512 |          -5915.96
       4513 |           5270.25
       4514 |  3519.63265306122
       4515 |           -1765.5
       4516 |                 0
       4517 |                 0
       4518 |          -6231.25
       4519 |            -10832
       4544 |           2499.25
       4545 |  4114.14285714286
       4546 |          -123.125
       4547 |          -8951.75
       4548 |          -2275.68
       4549 |             -2275
       4550 |         -11898.75
       4551 |       -16046.8125
       4576 |  7106.66666666667
       4577 |              5833
       4578 |           6471.28
       4579 |         5908.9375
       4580 |         -18567.08
       4581 |  9424.11111111111
       4582 |                 0
       4583 |  3349.79591836735
       4608 |            4584.5
       4609 |  17452.5555555556
       4610 |           4182.16
       4611 |             -3574
       4612 |          2827.875
       4613 | -18175.8571428571
       4614 |  4254.59183673469
       4615 |                 0
       4640 |           -2944.4
       4641 | -8195.55555555555
       4642 |             13342
       4643 |                 0
       4644 |          -5154.92
       4645 |  2937.87755102041
       4646 |         -14179.68
       4647 |  6794.88888888889
       4672 |  878.040816326531
       4673 |  186.222222222222
       4674 |           -4576.5
       4675 | -1940.55555555556
       4676 |  3636.14285714286
       4677 |                 0
       4678 |           2645.44
       4679 |                 0
       4704 |              5831
       4705 |  3123.87755102041
       4706 |            6041.4
       4707 |            -15300
       4708 |  20108.6666666667
       4709 |          16307.75
       4710 |              6371
       4711 |  3161.40816326531
       4736 |           37959.5
       4737 |            5785.5
       4738 |  12561.5918367347
       4739 |             -1942
       4740 |              7500
       4741 |  5333.44444444444
       4742 |               728
       4743 |         3203.9375
       4768 |                 0
       4769 |            3028.8
       4770 |           -930.75
       4771 |              3775
       4772 |        -3998.9375
       4773 | -7236.30612244898
       4774 |          -2212.75
       4775 |           -2616.5
       4800 |           3687.12
       4801 |            -107.5
       4802 |                 0
       4803 | -10985.3333333333
       4804 |  12850.3333333333
       4805 |           -2163.5
       4806 |             -3593
       4807 | -7515.97222222222
       4832 |           -252.12
       4833 |           7735.64
       4834 |           -3598.5
       4835 |            4524.5
       4836 |           2967.12
       4837 |  16696.6666666667
       4838 |  32.6666666666667
       4839 |           -903.28
       4864 |           -7160.5
       4865 | -2858.86111111111
       4866 |             -5560
       4867 |              3900
       4868 |          -5563.92
       4869 | -1424.33333333333
       4870 |           -357.92
       4871 |   3499.5306122449
       4896 |            7230.8
       4897 |        -5825.8125
       4898 |                 0
       4899 |                 0
       4900 |  4450.66666666667
       4901 |            1001.6
       4902 |             -1692
       4903 |  3629.33333333333
       4928 |             -6423
       4929 |          -2217.76
       4930 |          -1314.32
       4931 | -3718.83333333333
       4932 |          -5173.75
       4933 |             -1518
       4934 |  6434.44897959184
       4935 | -10788.5833333333
       4960 |  15303.9795918367
       4961 |          -12627.5
       4962 |                 0
       4963 |           2543.75
       4964 | -7553.51020408163
       4965 |           -2839.5
       4966 |           5476.48
       4967 |        10956.4375
       4992 |          -3202.75
       4993 |             -1820
       4994 |  4508.71428571429
       4995 |  3383.61111111111
       4996 |            6025.5
       4997 |  2513.58333333333
       4998 | -8102.88888888889
       4999 | -20442.8888888889
       5024 |              4855
       5025 |             -1200
       5026 |                 0
       5027 | -1968.69387755102
       5028 |             -1848
       5029 |          -8993.25
       5030 |             -2592
       5031 |         9471.3125
       5056 |          9281.875
       5057 |           -3139.5
       5058 |                 0
       5059 | -9845.22222222222
       5060 | -9323.11111111111
       5061 |  6651.11111111111
       5062 |              4220
       5063 |             303.6
       5088 |              -441
       5089 |        -10156.875
       5090 |              3075
       5091 |                 0
       5092 | -58.1836734693878
       5093 |  3805.55555555556
       5094 |            351.25
       5095 |  3482.44897959184
       5120 |                 0
       5121 |           -1128.5
       5122 |  4440.33333333333
       5123 |                 0
       5124 |         3091.6875
       5125 |              4224
       5126 | -4026.66666666667
       5127 |            843.75
       5152 |              1207
       5153 | -3570.16666666667
       5154 |             114.5
       5155 |          -4068.25
       5156 |            838.75
       5157 | -439.285714285714
       5158 |  3103.42857142857
       5159 |         -10953.88
       5184 |  1197.88888888889
       5185 |  7937.38888888889
       5186 |  2838.38775510204
       5187 |         -10605.25
       5188 |  7075.11111111111
       5189 |  5947.91666666667
       5190 |  9370.88888888889
       5191 |           3727.75
       5216 |                 0
       5217 |          2946.625
       5218 |              -525
       5219 |             -1863
       5220 |                 0
       5221 | -16518.2222222222
       5222 |                 0
       5223 |          9907.625
       5248 |            6543.5
       5249 |            887.44
       5250 |              9250
       5251 |                 0
       5252 | -6254.72222222222
       5253 |         2103.5625
       5254 | -2607.08163265306
       5255 |  2015.11111111111
       5280 |         -10931.25
       5281 |           1002.36
       5282 | -6217.33333333333
       5283 |             -6363
       5284 |            -12293
       5285 |  10750.2222222222
       5286 | -2716.41666666667
       5287 |                 0
       5312 |             -5083
       5313 |  3035.63888888889
       5314 |           -468.75
       5315 |          20534.25
       5316 |            2671.5
       5317 |             -7115
       5318 |           1665.75
       5319 |          -1331.25
       5344 |         1728.0625
       5345 |           6384.12
       5346 | -295.612244897959
       5347 | -2366.59183673469
       5348 |  2480.27777777778
       5349 |             14200
       5350 |           -948.72
       5351 |  7208.22222222222
       5376 |  3643.44444444444
       5377 |           -288.32
       5378 |  3978.33333333333
       5379 |                 0
       5380 |           3395.68
       5381 |  2421.57142857143
       5382 | -2765.73469387755
       5383 |                 0
       5408 |         -10356.64
       5409 | -3611.88888888889
       5410 |         10593.625
       5411 |           3394.08
       5412 |          -3022.75
       5413 |  3539.67346938776
       5414 |  3281.55555555556
       5415 | -5862.38775510204
       5440 |                 0
       5441 |               178
       5442 | -572.972222222222
       5443 |           11009.8
       5444 | -1835.19444444444
       5445 |           -3427.2
       5446 |                 0
       5447 |                 0
       5472 |  1746.02040816327
       5473 |              5625
       5474 |            -734.5
       5475 |                 0
       5476 |               840
       5477 | -9997.22222222222
       5478 | -7136.88888888889
       5479 |             -2028
       5504 |              2244
       5505 |          -3631.72
       5506 |           -147.75
       5507 |           -589.84
       5508 |                 0
       5509 |            437.44
       5510 |         -8195.625
       5511 |  9455.20408163265
       5536 |          -17966.6
       5537 |         -8312.875
       5538 |             -2705
       5539 |                 0
       5540 |          -5894.75
       5541 |                 0
       5542 |                 0
       5543 |  8650.59183673469
       5568 |             12187
       5569 |            142.44
       5570 | -8032.11111111111
       5571 |  6707.11111111111
       5572 | -8468.65306122449
       5573 |          -3145.64
       5574 |           3697.72
       5575 |            2242.5
       5600 |         -19231.75
       5601 |         -8736.875
       5602 |             14815
       5603 |  11294.6666666667
       5604 |  8635.55555555555
       5605 | -8751.91666666667
       5606 |  5537.91836734694
       5607 |                 0
       5632 |  6831.11111111111
       5633 | -3363.71428571429
       5634 |          19630.92
       5635 |  4202.12244897959
       5636 |  5707.55102040816
       5637 |             -7655
       5638 | -4690.33333333333
       5639 |                 0
       5664 |  8.30612244897959
       5665 |            699.25
       5666 |             -36.4
       5667 |                 0
       5668 |                 0
       5669 |           -6887.2
       5670 |           3850.25
       5671 |  1366.16666666667
       5696 |  2429.16326530612
       5697 | -3531.33333333333
       5698 |  2089.16666666667
       5699 |  1083.14285714286
       5700 |  1398.33333333333
       5701 |                 0
       5702 |               609
       5703 |                 0
       5728 |            -16416
       5729 |  7785.33333333333
       5730 |             11904
       5731 |          -6808.08
       5732 |                 0
       5733 |                 0
       5734 |  995.444444444444
       5735 |                 0
       5760 |           -234.76
       5761 | -12535.6666666667
       5762 | -1160.33333333333
       5763 |  15246.2222222222
       5764 |  8466.11111111111
       5765 | -7587.32653061224
       5766 | -7913.88888888889
       5767 |           3312.64
       5792 |         -10668.32
       5793 |           8684.75
       5794 |             -6472
       5795 |                 0
       5796 |                 0
       5797 |                 0
       5798 | -1910.97959183673
       5799 |            278.25
       5824 |           5879.68
       5825 |                 0
       5826 |            8220.5
       5827 |              9367
       5828 |            -13650
       5829 |  6.63265306122449
       5830 |                 0
       5831 |            -13532
       5856 |  5924.88888888889
       5857 | -253.111111111111
       5858 |  1178.51020408163
       5859 | -9950.65306122449
       5860 |                 0
       5861 |              4734
       5862 |          -1937.25
       5863 |                39
       5888 |            1257.5
       5889 |                 0
       5890 |                 0
       5891 |  13730.3333333333
       5892 |            5875.5
       5893 |          -13849.5
       5894 |                 0
       5895 |  3342.72222222222
       5920 |           -8554.4
       5921 |            2997.5
       5922 | -3111.11111111111
       5923 |            4032.4
       5924 | -8641.77777777778
       5925 | -2255.83333333333
       5926 |         -10129.75
       5927 | -3516.11111111111
       5952 |            7540.5
       5953 |          3158.125
       5954 |  7316.77777777778
       5955 |  8967.77777777778
       5956 |              8167
       5957 | -130.734693877551
       5958 |         -17043.12
       5959 |  878.387755102041
       5984 |          13669.75
       5985 |                 0
       5986 |           9210.12
       5987 |        -6731.0625
       5988 |                 0
       5989 |  -189.34693877551
       5990 |  5252.44444444444
       5991 |               248
       6016 | -10764.4444444444
       6017 |          18653.52
       6018 |               975
       6019 |                 0
       6020 |  212.979591836735
       6021 | -1885.72222222222
       6022 | -3877.34693877551
       6023 | -851.326530612245
       6048 |  3213.55102040816
       6049 | -8786.28571428571
       6050 |              2346
       6051 |  5859.36111111111
       6052 |         -10368.25
       6053 |          -1225.25
       6054 |               384
       6055 |  -1278.5306122449
       6080 |                 0
       6081 |             -2930
       6082 |  4659.11111111111
       6083 |           4106.25
       6084 |  1512.69444444444
       6085 |  46.8888888888889
       6086 |          -1219.25
       6087 | -894.285714285714
       6112 |  5139.85714285714
       6113 | -8024.89795918367
       6114 | -8426.88888888889
       6115 |  1619.55555555556
       6116 |  8012.04081632653
       6117 |          -4288.25
       6118 |          -2454.04
       6119 |             -4204
       6144 |        11139.6875
       6145 |              4940
       6146 |             -3680
       6147 |  603.555555555556
       6148 |          -2232.75
       6149 |                 0
       6150 |  132.428571428571
       6151 |             -6104
       6176 | -1809.11111111111
       6177 | -3870.44444444444
       6178 |                 0
       6179 |  13781.7222222222
       6180 |              1185
       6181 |                 0
       6182 |  3654.77551020408
       6183 | -6052.52777777778
       6208 |              1168
       6209 |        -8301.3125
       6210 |  4438.95918367347
       6211 |         7997.0625
       6212 |                 0
       6213 |           -794.75
       6214 |                 0
       6215 |  926.527777777778
       6240 |          -1462.24
       6241 |          -3621.25
       6242 | -372.111111111111
       6243 |           -8461.5
       6244 |              7455
       6245 |             -6987
       6246 |  2708.30555555556
       6247 |              64.5
       6272 |   11492.612244898
       6273 |                 0
       6274 |  1400.42857142857
       6275 |               312
       6276 |            8246.4
       6277 |              2590
       6278 | -179.714285714286
       6279 |                 0
       6304 |         6884.9375
       6305 |           -9822.5
       6306 |                 0
       6307 |                 0
       6308 |                 0
       6309 |  12190.5306122449
       6310 |  982.714285714286
       6311 |                 0
       6336 |           -921.75
       6337 |  2826.08333333333
       6338 |           4697.75
       6339 |  10446.9444444444
       6340 |            9627.6
       6341 |          -5665.88
       6342 |  4025.11111111111
       6343 |  1253.66666666667
       6368 |  4406.44444444444
       6369 |          6673.875
       6370 |          -2517.75
       6371 |          -8985.44
       6372 | -3737.33333333333
       6373 |           8753.75
       6374 |  8782.61111111111
       6375 | -5542.27777777778
       6400 |             -3780
       6401 |           8920.32
       6402 |           -758.25
       6403 |  8295.55555555555
       6404 |                 0
       6405 |            201.75
       6406 |           4168.32
       6407 |              8476
       6432 | -4947.71428571429
       6433 |  902.938775510204
       6434 |  1606.44444444444
       6435 | -6015.28571428571
       6436 |           4893.75
       6437 |             -5858
       6438 |           8653.56
       6439 |           3329.44
       6464 |  1221.61111111111
       6465 |  1720.44897959184
       6466 |                 0
       6467 |                 0
       6468 |                 0
       6469 | -4213.85714285714
       6470 |  6150.81632653061
       6471 |  4653.71428571429
       6496 | -8206.19444444445
       6497 |                 0
       6498 |               990
       6499 |              -237
       6500 | -1610.66666666667
       6501 |          623.1875
       6502 | -8618.16666666667
       6503 |  5756.88888888889
       6528 |         -2854.125
       6529 | -8741.02040816327
       6530 |                 0
       6531 |  10407.4444444444
       6532 |           7604.75
       6533 |          10109.32
       6534 |              3789
       6535 |         -4322.875
       6560 | -1806.87755102041
       6561 |        -6904.4375
       6562 |  8204.91666666667
       6563 | -2130.55555555556
       6564 |             12398
       6565 | -6091.66666666667
       6566 | -4182.26530612245
       6567 |          -7726.96
       6592 |  1275.33333333333
       6593 |  9005.22222222222
       6594 |  246.836734693878
       6595 |                 0
       6596 |  2739.55102040816
       6597 |            -973.5
       6598 |           -1957.5
       6599 |           2090.72
       6624 |                 0
       6625 |                 0
       6626 |         8506.6875
       6627 |           9753.75
       6628 |              5392
       6629 | -5249.33333333333
       6630 |  807.877551020408
       6631 |           2665.52
       6656 | -607.775510204082
       6657 |           -7083.5
       6658 |                 0
       6659 | -2115.77777777778
       6660 |          10692.16
       6661 |               806
       6662 |           557.625
       6663 |         -3471.125
       6688 |          4506.375
       6689 | -4058.88888888889
       6690 | -11838.1388888889
       6691 |  4152.79591836735
       6692 | -6414.87755102041
       6693 |           -7296.5
       6694 | -1999.33333333333
       6695 | -5505.91836734694
       6720 |  1782.10204081633
       6721 |            2895.5
       6722 | -215.061224489796
       6723 |          -2898.72
       6724 | -5673.77777777778
       6725 |         -2731.375
       6726 | -6119.30555555556
       6727 |  2310.71428571429
       6752 |                 0
       6753 |           -2044.4
       6754 |             -3045
       6755 |                 0
       6756 |            6205.8
       6757 |  1930.85714285714
       6758 |                 0
       6759 | -2881.33333333333
       6784 |                 0
       6785 | -4221.33333333333
       6786 |  395.285714285714
       6787 |                 0
       6788 |            4554.6
       6789 | -3960.61224489796
       6790 |                 0
       6791 |            -11725
       6816 |              2968
       6817 |            915.52
       6818 | -1085.72222222222
       6819 | -4523.14285714286
       6820 |           7246.75
       6821 |             -2673
       6822 |  2164.44897959184
       6823 |  487.333333333333
       6848 |         8148.1875
       6849 |          794.3125
       6850 |        -5737.1875
       6851 | -7210.11111111111
       6852 |                 0
       6853 |          27175.25
       6854 |  737.163265306122
       6855 |             836.5
       6880 | -6319.55555555556
       6881 |           2147.25
       6882 |  -3447.0612244898
       6883 |          -10183.2
       6884 |            2162.5
       6885 | -8943.05555555555
       6886 | -991.305555555556
       6887 | -6729.26530612245
       6912 |                 0
       6913 |           3617.25
       6914 |                 0
       6915 | -4332.66666666667
       6916 |  313.333333333333
       6917 |  1578.61111111111
       6918 |  911.734693877551
       6919 | -4649.91666666667
       6944 |                 0
       6945 |                 0
       6946 |                 0
       6947 | -1616.66666666667
       6948 | -4253.22222222222
       6949 |         8628.3125
       6950 |               651
       6951 |                 0
       6976 |             -1253
       6977 |           -6702.6
       6978 |             -6407
       6979 |           2925.75
       6980 | -67.8571428571429
       6981 |        -9487.6875
       6982 | -9644.66666666667
       6983 |                 0
       7008 |                 0
       7009 | -5352.66666666667
       7010 |          -4116.75
       7011 |                 0
       7012 |                 0
       7013 |  198.444444444444
       7014 |           -1959.5
       7015 |  2949.33333333333
       7040 |              -260
       7041 |            1586.5
       7042 |             -3657
       7043 |                 0
       7044 | -8486.22222222222
       7045 |         2689.0625
       7046 |            9804.5
       7047 | -2839.47222222222
       7072 |         -14501.25
       7073 |            -11159
       7074 |                 0
       7075 | -6033.83333333333
       7076 |            -643.5
       7077 |  -608.69387755102
       7078 |          -1379.72
       7079 | -1352.16666666667
       7104 |                 0
       7105 |  6866.55555555556
       7106 |  2423.24489795918
       7107 |  5215.32653061224
       7108 |               912
       7109 |           7960.25
       7110 |              7786
       7111 |              -880
       7136 | -409.714285714286
       7137 |            3175.5
       7138 |          -1440.88
       7139 |                 0
       7140 |  8538.66666666667
       7141 |             11277
       7142 |          -9861.75
       7143 |                 0
       7168 | -5996.12244897959
       7169 |           -2991.2
       7170 |           -6416.5
       7171 | -8055.65306122449
       7172 |        -3856.4375
       7173 |              3600
       7174 |          2396.375
       7175 |                 0
       7200 |  6545.26530612245
       7201 |                 0
       7202 |          -6225.64
       7203 |             -1037
       7204 |              -212
       7205 | -211.555555555556
       7206 |                 0
       7207 |              5858
       7232 | -14366.1111111111
       7233 |             -4224
       7234 |                 0
       7235 | -2909.44444444444
       7236 |          5385.625
       7237 |             -5952
       7238 | -5139.55555555556
       7239 |             -7049
       7264 |          -6036.25
       7265 |           -208.25
       7266 |              3176
       7267 |            8850.4
       7268 |             -3575
       7269 |                 0
       7270 |            2718.5
       7271 | -506.333333333333
       7296 |                 0
       7297 |  2004.28571428571
       7298 |         -7165.375
       7299 |             -1131
       7300 |  -1581.0612244898
       7301 |                 0
       7302 |                 0
       7303 |         -14790.75
       7328 | -7684.02040816327
       7329 |              5247
       7330 |           -1695.2
       7331 | -6837.58333333333
       7332 |          14071.28
       7333 |            -321.5
       7334 |          1744.875
       7335 |           5580.44
       7360 |                 0
       7361 |              2940
       7362 |           -1627.5
       7363 |            4042.5
       7364 |  3878.66666666667
       7365 |          -3333.68
       7366 |             -6981
       7367 |        -8331.9375
       7392 |          -9616.56
       7393 |          11723.44
       7394 |         -1845.125
       7395 | -1923.66666666667
       7396 |              3960
       7397 |                 0
       7398 |  3739.02040816327
       7399 |            2593.5
       7424 |                 0
       7425 |  2157.33333333333
       7426 |                 0
       7427 |  -7917.9387755102
       7428 |              -190
       7429 |        -3693.3125
       7430 |              6160
       7431 | -13829.6666666667
       7456 | -1551.55555555556
       7457 |  726.861111111111
       7458 |            3232.5
       7459 | -3790.33333333333
       7460 |                 0
       7461 | -2509.91836734694
       7462 |         -14791.96
       7463 | -2804.16666666667
       7488 |            7213.5
       7489 |            581.25
       7490 |              7464
       7491 |              3110
       7492 |              -954
       7493 |              6289
       7494 |            263.25
       7495 |           4358.75
       7520 |          -2306.88
       7521 | -20596.8888888889
       7522 | -251.571428571429
       7523 |  2155.67346938776
       7524 |           -1701.5
       7525 |           -3533.5
       7526 |          -3132.25
       7527 |        -2507.9375
       7552 |               225
       7553 |           5321.44
       7554 |        -10189.875
       7555 | -8190.33333333333
       7556 |               -34
       7557 |                 0
       7558 |                 0
       7559 |          -2436.75
       7584 |           4397.36
       7585 |          -11460.5
       7586 |               895
       7587 |                 0
       7588 |             -3846
       7589 |           -1213.8
       7590 |          -1801.25
       7591 | -907.408163265306
       7616 | -14502.2222222222
       7617 |  6586.13888888889
       7618 |  256.285714285714
       7619 | -2682.22222222222
       7620 |                 0
       7621 |             -7565
       7622 |           15484.5
       7623 |          10383.25
       7648 |                 0
       7649 |           1725.75
       7650 |            -10692
       7651 |                 0
       7652 |                 0
       7653 |            427.25
       7654 | -13209.9444444444
       7655 |          -1686.75
       7680 |  484.714285714286
       7681 |              2408
       7682 |  738.555555555556
       7683 |          -232.125
       7684 |         2673.6875
       7685 |  -615.30612244898
       7686 |  4508.44444444444
       7687 |  176.489795918367
       7712 |                 0
       7713 |                 0
       7714 |           -4454.6
       7715 | -865.333333333333
       7716 |            4050.5
       7717 |           -3957.2
       7718 |           9166.96
       7719 |                 0
       7744 |  75.8163265306122
       7745 |              1986
       7746 |          3063.125
       7747 |                 0
       7748 |                 0
       7749 |          -3771.76
       7750 |          -2372.25
       7751 |  7985.66666666667
       7776 |           -1500.5
       7777 |            675.75
       7778 |            767.36
       7779 |           -138.68
       7780 |                 0
       7781 |                 0
       7782 |         5780.8125
       7783 | -4564.44444444444
       7808 |                 0
       7809 | -622.555555555556
       7810 |            978.96
       7811 |  2619.13888888889
       7812 |            1126.5
       7813 |              4440
       7814 |                 0
       7815 |                 0
       7840 |         1919.8125
       7841 | -7865.33333333333
       7842 |          14876.25
       7843 |              -958
       7844 |  834.444444444444
       7845 |            591.32
       7846 |           3575.68
       7847 |  12487.3333333333
       7872 |          -2487.28
       7873 |  1469.61111111111
       7874 |  1546.51020408163
       7875 |         2041.9375
       7876 |            -48.25
       7877 |  5699.12244897959
       7878 |           9806.16
       7879 |         15574.125
       7904 |             -3626
       7905 |           -6250.2
       7906 |           21484.5
       7907 |         -9167.375
       7908 | -2854.71428571429
       7909 |              2372
       7910 | -1440.20408163265
       7911 |              3064
       7936 |           -65.625
       7937 |           5244.75
       7938 |  6389.11111111111
       7939 |          -7785.25
       7940 |                 0
       7941 |  13225.5555555556
       7942 |          -7968.24
       7943 |                 0
       7968 |          -5886.36
       7969 | -2094.33333333333
       7970 |              4890
       7971 |  8663.55555555555
       7972 | -11337.4285714286
       7973 |                 0
       7974 |                 0
       7975 |                 0
       8000 |  4408.41666666667
(2000 rows)

set enable_hashagg=on;
create table agg_zoo(x bigint, y int) distributed by (x);
insert into agg_zoo select random() * 12345678, 1 from generate_series(1,100000);
analyze agg_zoo;
set statement_mem="1600";
select sum(y) from agg_zoo;
  sum   
--------
 100000
(1 row)

select sum(y) from (select sum(y) as y from agg_zoo group by x) a;
  sum   
--------
 100000
(1 row)

reset all;
SET SEARCH_PATH to rpt_tpch;
-- opperf
create table opperfscale(nseg int, nscale int, nscaleperseg int); 
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'nseg' as the Greenplum Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
insert into opperfscale
 	select case when lc < 7000000 then 1 else seg end as nseg, 
	       case when lc < 7000000 then 1 else lc / 6000000 end as nscale,
	       case when lc < 7000000 or lc / 6000000 < seg 
	       		then 2 
			else lc / 6000000 / seg + 1 end as nscaleperseg
	from
	(
 		select max(content)+1 as seg from gp_segment_configuration where preferred_role = 'p'
	) S,
	(
	 select count(*) as lc from heap_lineitem 
	) L;
select * from opperfscale;
 nseg | nscale | nscaleperseg 
------+--------+--------------
    1 |      1 |            2
(1 row)

-- Sort test 2:
select count(*) from (select count(*) from
(
select l_linenumber, l_shipdate, l_linestatus  from heap_lineitem
where l_orderkey % (
	select max(nscaleperseg) from opperfscale
	) = 0 
order by l_linenumber, l_shipdate, l_linestatus
limit 1000000
) tmpt) tmp;
 count 
-------
     1
(1 row)

-- Sort test 3: 
set gp_enable_sort_limit = off;
select count(*) from (select l_linenumber, l_shipdate, l_tax from heap_lineitem order by l_linenumber, l_shipdate, l_tax
limit 100) q;
 count 
-------
   100
(1 row)

set gp_enable_sort_limit = on;
-- Hashagg 1: yahoo
select count(*) from (select count(*) from (
select avg(l_quantity) as c1, max(l_discount) as c2 
from heap_lineitem
group by 
l_orderkey, l_linenumber, l_linestatus, l_comment
) tmpt) tmp;
 count 
-------
     1
(1 row)

-- Hashagg 2: easy
select count(*) from (select count(*) from
(
select avg(l_quantity), max(l_discount) 
from heap_lineitem
group by 
l_linenumber, l_linestatus, l_returnflag
) tmpt) tmp;
 count 
-------
     1
(1 row)

-- Sort agg 1: yahoo
set enable_hashagg = off;
select count(*) from (select count(*) from (
select avg(l_quantity), max(l_discount) 
from heap_lineitem
where l_orderkey % (select max(nscaleperseg) from opperfscale) = 0 
group by 
l_orderkey, l_linenumber, l_linestatus, l_comment
) tmpt) tmp;
 count 
-------
     1
(1 row)

set enable_hashagg = on;
-- Sort agg 2: easy
set enable_hashagg = off;
select count(*) from (select count(*) from (
select avg(l_quantity), max(l_discount) 
from heap_lineitem
where l_orderkey % (select max(nscaleperseg) from opperfscale) = 0
group by 
l_linenumber, l_linestatus, l_returnflag
) tmpt) tmp;
 count 
-------
     1
(1 row)

set enable_hashagg = on;
-- scan test with selection
-- Select one column from heap_lineitem
select max(l_partkey) from heap_lineitem where l_quantity > 20 and l_discount < 0.9 ;
 max  
------
 2000
(1 row)

-- Hash join
select count(*) from heap_lineitem l1, heap_lineitem l2
where 
l1.l_orderkey % (select max(nscaleperseg) from opperfscale) = 0 and
l2.l_orderkey % (select max(nscaleperseg) from opperfscale) = 0 and
l1.l_partkey = l2.l_partkey and l1.l_returnflag = l2.l_returnflag
;
 count  
--------
 200794
(1 row)

-- Hash join, lots of fields
select count(*) from heap_lineitem l1, heap_lineitem l2
where 
l1.l_orderkey % (
		select max(nscaleperseg) from opperfscale 
		) = 0 and
l2.l_orderkey % (
		select max(nscaleperseg) from opperfscale 
		) = 0 and
-- l1.l_orderkey = l2.l_orderkey and 
l1.l_partkey = l2.l_partkey
and l1.l_suppkey = l2.l_suppkey
and l1.l_linenumber = l2.l_linenumber
and l1.l_extendedprice = l2.l_extendedprice
and l1.l_returnflag = l2.l_returnflag
and l1.l_shipdate = l2.l_shipdate
and l1.l_commitdate = l2.l_commitdate
and l1.l_shipmode = l2.l_shipmode
and l1.l_comment = l2.l_comment
;
 count 
-------
 30050
(1 row)

-- scan test
-- Merge join
set enable_hashjoin = off;
set enable_mergejoin=on;
select count(*) from heap_lineitem l1, heap_lineitem l2
where 
l1.l_orderkey % (select max(nscaleperseg * 4) from opperfscale) = 0 and
l2.l_orderkey % (select max(nscaleperseg * 4) from opperfscale) = 0 and
l1.l_partkey = l2.l_partkey and l1.l_returnflag = l2.l_returnflag
;
 count 
-------
 17785
(1 row)

set enable_hashjoin = on;
set enable_mergejoin=off;
-- Merge join, lots of fields
set enable_mergejoin=on;
set enable_hashjoin = off;
select count(*) from heap_lineitem l1, heap_lineitem l2
where 
l1.l_orderkey % (select max(nscaleperseg * 4) from opperfscale) = 0 and
l2.l_orderkey % (select max(nscaleperseg * 4) from opperfscale) = 0 and
l1.l_partkey = l2.l_partkey
and l1.l_suppkey = l2.l_suppkey
and l1.l_linenumber = l2.l_linenumber
and l1.l_extendedprice = l2.l_extendedprice
and l1.l_returnflag = l2.l_returnflag
and l1.l_shipdate = l2.l_shipdate
and l1.l_commitdate = l2.l_commitdate
and l1.l_shipmode = l2.l_shipmode
and l1.l_comment = l2.l_comment
;
 count 
-------
  7461
(1 row)

set enable_mergejoin=off;
set enable_hashjoin = on;
-- Nested loop join
select count(*) from heap_part p1, heap_part p2
where 
p1.p_partkey % (select max(nscale * 10) from opperfscale) = 0 and 
p2.p_partkey % (select max(nscale * 10) from opperfscale) = 0 and 
p1.p_size < p2.p_size 
and p1.p_retailprice > p2.p_retailprice
and p1.p_brand > p2.p_brand
;
 count 
-------
  4950
(1 row)

-- Left outer join, with hash join
select count(*) from heap_lineitem l left outer join heap_partsupp p
on l.l_partkey = p.ps_partkey and l.l_suppkey = p.ps_suppkey
and l.l_quantity > (p.ps_availqty / 10)
where l.l_orderkey % (select max(nscaleperseg) from opperfscale) = 0
;
 count 
-------
 30050
(1 row)

-- Full outer join, merge join
set enable_hashjoin = off;
select count(*) from (select count(*) from heap_lineitem l left outer join heap_partsupp p
on l.l_partkey = p.ps_partkey and l.l_suppkey = p.ps_suppkey
and l.l_quantity > (p.ps_availqty / 10)
where l.l_orderkey % (select max(nscaleperseg) from opperfscale) = 0) tmp
;
 count 
-------
     1
(1 row)

set enable_hashjoin = on;
-- nested loop outer join
select count(*) from heap_part p left outer join heap_supplier s 
on p.p_partkey > s.s_suppkey and p.p_size < s.s_nationkey
where
p.p_partkey % (select max(nscale * 4) from opperfscale) = 1
and s.s_suppkey % (select max(nscale * 4) from opperfscale) = 1
;
 count 
-------
  2430
(1 row)

-- Full outer join, merge join
-- set enable_hashjoin = off;
select count(*) from (select count(*) from heap_lineitem l full outer join heap_partsupp p
on l.l_partkey = p.ps_partkey and l.l_suppkey = p.ps_suppkey) tmp
-- and l.l_quantity > (p.ps_availqty / 10)
;
 count 
-------
     1
(1 row)

-- distinct
select count(*) from (select count(*) from
(
select distinct l_partkey, l_suppkey, l_shipmode from heap_lineitem 
where l_orderkey % (select max(nscaleperseg) from opperfscale) = 0 
) tmpt) tmp;
 count 
-------
     1
(1 row)

-- distinct using group by
select count(*) from 
(select count(1) from heap_lineitem
 where l_orderkey % (select max(nscaleperseg) from opperfscale) = 0
 group by l_partkey, l_suppkey, l_shipmode
) tmpt;
 count 
-------
 23309
(1 row)

-- count distinct
select count(distinct l_partkey), count(distinct l_suppkey), count(distinct l_shipmode) 
	from heap_lineitem 
where l_orderkey % (select max(nscale * 4) from opperfscale) = 0;
 count | count | count 
-------+-------+-------
  2000 |   100 |     7
(1 row)

-- Union
select count(*) from (select count(*) from
(
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg) * 20 from opperfscale) = 1
  union
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg) * 20 from opperfscale) = 2
  union
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg) * 20 from opperfscale) = 3
  union
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem  where
  l_orderkey % (select max(nscaleperseg) * 20 from opperfscale) = 4
  union
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg) * 20 from opperfscale) = 5
) tmpt) tmp;
 count 
-------
     1
(1 row)

-- Union all
select count(*) from
(
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg * 10) from opperfscale) = 1
  union all
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg * 10) from opperfscale) = 2
  union all
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg * 10) from opperfscale) = 3
  union all
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg * 10) from opperfscale) = 4
  union all
  select l_suppkey, l_partkey, l_shipmode from heap_lineitem where
  l_orderkey % (select max(nscaleperseg * 10) from opperfscale) = 5
) tmpt;
 count 
-------
 15061
(1 row)

DROP SCHEMA rpt_tpch cascade;
NOTICE:  drop cascades to 26 other objects
DETAIL:  drop cascades to table heap_customer
drop cascades to table heap_lineitem
drop cascades to table heap_nation
drop cascades to table heap_orders
drop cascades to table heap_part
drop cascades to table heap_partsupp
drop cascades to table heap_region
drop cascades to table heap_supplier
drop cascades to append only table ao_customer
drop cascades to append only table ao_lineitem
drop cascades to table ao_nation
drop cascades to append only table ao_orders
drop cascades to append only table ao_part
drop cascades to append only table ao_partsupp
drop cascades to append only table ao_region
drop cascades to append only table ao_supplier
drop cascades to append only columnar table co_customer
drop cascades to append only columnar table co_lineitem
drop cascades to append only columnar table co_nation
drop cascades to append only columnar table co_orders
drop cascades to append only columnar table co_part
drop cascades to append only columnar table co_partsupp
drop cascades to append only columnar table co_region
drop cascades to append only columnar table co_supplier
drop cascades to table agg_zoo
drop cascades to table opperfscale
