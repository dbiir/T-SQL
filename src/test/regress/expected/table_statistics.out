\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap1 cascade;
ERROR:  schema "stat_heap1" does not exist
create schema stat_heap1;
set search_path=stat_heap1,"$user",public;
\echo '-- end_ignore'
-- end_ignore
set optimizer_print_missing_stats = off;
-- Regular Table
Drop table if exists stat_heap_t1;
NOTICE:  table "stat_heap_t1" does not exist, skipping
Create table stat_heap_t1 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i);
Insert into stat_heap_t1 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Create index stat_idx_heap_t1 on stat_heap_t1(i);
Analyze stat_heap_t1;
select count(*) from pg_class where relname like 'stat_heap_t1%';
 count 
-------
     1
(1 row)

-- Alter table without a default value
Alter table stat_heap_t1 add column new_col varchar;
 
select  count(*) from pg_class where relname like 'stat_heap_t1%';
 count 
-------
     1
(1 row)

-- Alter table with a default value
Alter table stat_heap_t1 add column new_col2 text default 'new column with new value';
select  count(*) from pg_class where relname like 'stat_heap_t1%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t1;
NOTICE:  table "stat_part_heap_t1" does not exist, skipping
Create table stat_part_heap_t1 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_others" for table "stat_part_heap_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_2" for table "stat_part_heap_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_3" for table "stat_part_heap_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_others_2_prt_subothers" for table "stat_part_heap_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_others_2_prt_sub1" for table "stat_part_heap_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_others_2_prt_sub2" for table "stat_part_heap_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_2_2_prt_subothers" for table "stat_part_heap_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_2_2_prt_sub1" for table "stat_part_heap_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_2_2_prt_sub2" for table "stat_part_heap_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_3_2_prt_subothers" for table "stat_part_heap_t1_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_3_2_prt_sub1" for table "stat_part_heap_t1_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t1_1_prt_3_2_prt_sub2" for table "stat_part_heap_t1_1_prt_3"
Insert into stat_part_heap_t1 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_heap_t1;
select  count(*) from pg_class where relname like 'stat_part_heap_t1';
 count 
-------
     1
(1 row)

-- Alter table without a default value
Alter table stat_part_heap_t1 add column new_col varchar;
select  count(*) from pg_class where relname like 'stat_part_heap_t1';
 count 
-------
     1
(1 row)

-- Alter table with a default value
Alter table stat_part_heap_t1 add column new_col2 text default 'new column with new value';
select  count(*) from pg_class where relname like 'stat_part_heap_t1';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_ao1 cascade;
ERROR:  schema "stat_ao1" does not exist
create schema stat_ao1;
set search_path=stat_ao1,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_ao_t1;
NOTICE:  table "stat_ao_t1" does not exist, skipping
Create table stat_ao_t1 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5) distributed by (i) ;
Insert into stat_ao_t1 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_ao_t1;
select  count(*) from pg_class where relname like 'stat_ao_t1%';
 count 
-------
     1
(1 row)

-- Alter table with a default value
Alter table stat_ao_t1 add column new_col2 text default 'new column with new value';
select  count(*) from pg_class where relname like 'stat_ao_t1%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_ao_t1;
NOTICE:  table "stat_part_ao_t1" does not exist, skipping
Create table stat_part_ao_t1 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5) distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_others" for table "stat_part_ao_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_2" for table "stat_part_ao_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_3" for table "stat_part_ao_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_others_2_prt_subothers" for table "stat_part_ao_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_others_2_prt_sub1" for table "stat_part_ao_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_others_2_prt_sub2" for table "stat_part_ao_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_2_2_prt_subothers" for table "stat_part_ao_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_2_2_prt_sub1" for table "stat_part_ao_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_2_2_prt_sub2" for table "stat_part_ao_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_3_2_prt_subothers" for table "stat_part_ao_t1_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_3_2_prt_sub1" for table "stat_part_ao_t1_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t1_1_prt_3_2_prt_sub2" for table "stat_part_ao_t1_1_prt_3"
Insert into stat_part_ao_t1 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Create index stat_part_idx_ao_t1 on stat_part_ao_t1(d);
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_2"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_others"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_3"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_2_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_2_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_2_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_others_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_others_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_others_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_3_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_3_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_ao_t1_1_prt_3_2_prt_sub2"
Analyze stat_part_ao_t1;
select  count(*) from pg_class where relname like 'stat_part_ao_t1';
 count 
-------
     1
(1 row)

-- Alter table with a default value
Alter table stat_part_ao_t1 add column new_col2 text default 'new column with new value';
select  count(*) from pg_class where relname like 'stat_part_ao_t1';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_co1 cascade;
ERROR:  schema "stat_co1" does not exist
create schema stat_co1;
set search_path=stat_co1,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_co_t1;
NOTICE:  table "stat_co_t1" does not exist, skipping
Create table stat_co_t1 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) ;
Insert into stat_co_t1 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_co_t1;
select  count(*) from pg_class where relname like 'stat_co_t1%';
 count 
-------
     1
(1 row)

-- Alter table with a default value
Alter table stat_co_t1 add column new_col2 text default 'new column with new value';
select  count(*) from pg_class where relname like 'stat_co_t1%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_co_t1;
NOTICE:  table "stat_part_co_t1" does not exist, skipping
Create table stat_part_co_t1 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5, orientation=column) distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_others" for table "stat_part_co_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_2" for table "stat_part_co_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_3" for table "stat_part_co_t1"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_others_2_prt_subothers" for table "stat_part_co_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_others_2_prt_sub1" for table "stat_part_co_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_others_2_prt_sub2" for table "stat_part_co_t1_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_2_2_prt_subothers" for table "stat_part_co_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_2_2_prt_sub1" for table "stat_part_co_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_2_2_prt_sub2" for table "stat_part_co_t1_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_3_2_prt_subothers" for table "stat_part_co_t1_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_3_2_prt_sub1" for table "stat_part_co_t1_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t1_1_prt_3_2_prt_sub2" for table "stat_part_co_t1_1_prt_3"
Insert into stat_part_co_t1 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_co_t1;
select  count(*) from pg_class where relname like 'stat_part_co_t1';
 count 
-------
     1
(1 row)

-- Alter table with a default value
Alter table stat_part_co_t1 add column new_col2 text default 'new column with new value';
select  count(*) from pg_class where relname like 'stat_part_co_t1';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap2 cascade;
ERROR:  schema "stat_heap2" does not exist
create schema stat_heap2;
set search_path=stat_heap2,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_heap_t2;
NOTICE:  table "stat_heap_t2" does not exist, skipping
Create table stat_heap_t2 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i);
Insert into stat_heap_t2 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_heap_t2;
select  count(*) from pg_class where relname like 'stat_heap_t2%';
 count 
-------
     1
(1 row)

-- Alter table drop column
Alter table stat_heap_t2 drop column d;
 
select  count(*) from pg_class where relname like 'stat_heap_t2%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t2;
NOTICE:  table "stat_part_heap_t2" does not exist, skipping
Create table stat_part_heap_t2 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_others" for table "stat_part_heap_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_2" for table "stat_part_heap_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_3" for table "stat_part_heap_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_others_2_prt_subothers" for table "stat_part_heap_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_others_2_prt_sub1" for table "stat_part_heap_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_others_2_prt_sub2" for table "stat_part_heap_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_2_2_prt_subothers" for table "stat_part_heap_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_2_2_prt_sub1" for table "stat_part_heap_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_2_2_prt_sub2" for table "stat_part_heap_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_3_2_prt_subothers" for table "stat_part_heap_t2_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_3_2_prt_sub1" for table "stat_part_heap_t2_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t2_1_prt_3_2_prt_sub2" for table "stat_part_heap_t2_1_prt_3"
Insert into stat_part_heap_t2 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_heap_t2;
select  count(*) from pg_class where relname like 'stat_part_heap_t2';
 count 
-------
     1
(1 row)

-- Alter table drop column
Alter table stat_part_heap_t2 drop column d;
select  count(*) from pg_class where relname like 'stat_part_heap_t2';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_ao2 cascade;
ERROR:  schema "stat_ao2" does not exist
create schema stat_ao2;
set search_path=stat_ao2,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_ao_t2;
NOTICE:  table "stat_ao_t2" does not exist, skipping
Create table stat_ao_t2 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5) distributed by (i) ;
Insert into stat_ao_t2 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_ao_t2;
select  count(*) from pg_class where relname like 'stat_ao_t2%';
 count 
-------
     1
(1 row)

-- Alter table drop column
Alter table stat_ao_t2 drop column t;
select  count(*) from pg_class where relname like 'stat_ao_t2%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_ao_t2;
NOTICE:  table "stat_part_ao_t2" does not exist, skipping
Create table stat_part_ao_t2 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5) distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_others" for table "stat_part_ao_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_2" for table "stat_part_ao_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_3" for table "stat_part_ao_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_others_2_prt_subothers" for table "stat_part_ao_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_others_2_prt_sub1" for table "stat_part_ao_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_others_2_prt_sub2" for table "stat_part_ao_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_2_2_prt_subothers" for table "stat_part_ao_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_2_2_prt_sub1" for table "stat_part_ao_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_2_2_prt_sub2" for table "stat_part_ao_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_3_2_prt_subothers" for table "stat_part_ao_t2_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_3_2_prt_sub1" for table "stat_part_ao_t2_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t2_1_prt_3_2_prt_sub2" for table "stat_part_ao_t2_1_prt_3"
Insert into stat_part_ao_t2 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_ao_t2;
select  count(*) from pg_class where relname like 'stat_part_ao_t2';
 count 
-------
     1
(1 row)

-- Alter table drop column
Alter table stat_part_ao_t2 drop column t;
select  count(*) from pg_class where relname like 'stat_part_ao_t2';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_co2 cascade;
ERROR:  schema "stat_co2" does not exist
create schema stat_co2;
set search_path=stat_co2,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_co_t2;
NOTICE:  table "stat_co_t2" does not exist, skipping
Create table stat_co_t2 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) ;
Insert into stat_co_t2 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_co_t2;
select  count(*) from pg_class where relname like 'stat_co_t2%';
 count 
-------
     1
(1 row)

-- Alter table drop column
Alter table stat_co_t2 drop column t;
select  count(*) from pg_class where relname like 'stat_co_t2%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_co_t2;
NOTICE:  table "stat_part_co_t2" does not exist, skipping
Create table stat_part_co_t2 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5, orientation=column) distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_others" for table "stat_part_co_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_2" for table "stat_part_co_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_3" for table "stat_part_co_t2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_others_2_prt_subothers" for table "stat_part_co_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_others_2_prt_sub1" for table "stat_part_co_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_others_2_prt_sub2" for table "stat_part_co_t2_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_2_2_prt_subothers" for table "stat_part_co_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_2_2_prt_sub1" for table "stat_part_co_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_2_2_prt_sub2" for table "stat_part_co_t2_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_3_2_prt_subothers" for table "stat_part_co_t2_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_3_2_prt_sub1" for table "stat_part_co_t2_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t2_1_prt_3_2_prt_sub2" for table "stat_part_co_t2_1_prt_3"
Insert into stat_part_co_t2 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_co_t2;
select  count(*) from pg_class where relname like 'stat_part_co_t2';
 count 
-------
     1
(1 row)

-- Alter table drop column
Alter table stat_part_co_t2 drop column t;
select  count(*) from pg_class where relname like 'stat_part_co_t2';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap3 cascade;
ERROR:  schema "stat_heap3" does not exist
create schema stat_heap3;
set search_path=stat_heap3,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_heap_t3;
NOTICE:  table "stat_heap_t3" does not exist, skipping
Create table stat_heap_t3 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i);
Insert into stat_heap_t3 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_heap_t3;
select  count(*) from pg_class where relname like 'stat_heap_t3%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_heap_t3 set distributed by (j);
 
select  count(*) from pg_class where relname like 'stat_heap_t3%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t3;
NOTICE:  table "stat_part_heap_t3" does not exist, skipping
Create table stat_part_heap_t3 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed by (i)  partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_others" for table "stat_part_heap_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_2" for table "stat_part_heap_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_3" for table "stat_part_heap_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_others_2_prt_subothers" for table "stat_part_heap_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_others_2_prt_sub1" for table "stat_part_heap_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_others_2_prt_sub2" for table "stat_part_heap_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_2_2_prt_subothers" for table "stat_part_heap_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_2_2_prt_sub1" for table "stat_part_heap_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_2_2_prt_sub2" for table "stat_part_heap_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_3_2_prt_subothers" for table "stat_part_heap_t3_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_3_2_prt_sub1" for table "stat_part_heap_t3_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t3_1_prt_3_2_prt_sub2" for table "stat_part_heap_t3_1_prt_3"
Insert into stat_part_heap_t3 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Create index stat_part_idx_heap_t3 on stat_part_heap_t3(d);
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_2"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_others"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_3"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_2_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_2_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_2_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_others_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_others_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_others_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_3_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_3_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t3_1_prt_3_2_prt_sub2"
Analyze stat_part_heap_t3;
select  count(*) from pg_class where relname like 'stat_part_heap_t3';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_heap_t3 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_part_heap_t3';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_ao3 cascade;
ERROR:  schema "stat_ao3" does not exist
create schema stat_ao3;
set search_path=stat_ao3,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_ao_t3;
NOTICE:  table "stat_ao_t3" does not exist, skipping
Create table stat_ao_t3 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5) distributed by (i) ;
Insert into stat_ao_t3 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_ao_t3;
select  count(*) from pg_class where relname like 'stat_ao_t3%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_ao_t3 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_ao_t3%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_ao_t3;
NOTICE:  table "stat_part_ao_t3" does not exist, skipping
Create table stat_part_ao_t3 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5) distributed by (i) partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_others" for table "stat_part_ao_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_2" for table "stat_part_ao_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_3" for table "stat_part_ao_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_others_2_prt_subothers" for table "stat_part_ao_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_others_2_prt_sub1" for table "stat_part_ao_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_others_2_prt_sub2" for table "stat_part_ao_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_2_2_prt_subothers" for table "stat_part_ao_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_2_2_prt_sub1" for table "stat_part_ao_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_2_2_prt_sub2" for table "stat_part_ao_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_3_2_prt_subothers" for table "stat_part_ao_t3_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_3_2_prt_sub1" for table "stat_part_ao_t3_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t3_1_prt_3_2_prt_sub2" for table "stat_part_ao_t3_1_prt_3"
Insert into stat_part_ao_t3 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_ao_t3;
select  count(*) from pg_class where relname like 'stat_part_ao_t3';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_ao_t3 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_part_ao_t3';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_co3 cascade;
ERROR:  schema "stat_co3" does not exist
create schema stat_co3;
set search_path=stat_co3,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_co_t3;
NOTICE:  table "stat_co_t3" does not exist, skipping
Create table stat_co_t3 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) ;
Insert into stat_co_t3 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_co_t3;
select  count(*) from pg_class where relname like 'stat_co_t3%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_co_t3 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_co_t3%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_co_t3;
NOTICE:  table "stat_part_co_t3" does not exist, skipping
Create table stat_part_co_t3 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_others" for table "stat_part_co_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_2" for table "stat_part_co_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_3" for table "stat_part_co_t3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_others_2_prt_subothers" for table "stat_part_co_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_others_2_prt_sub1" for table "stat_part_co_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_others_2_prt_sub2" for table "stat_part_co_t3_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_2_2_prt_subothers" for table "stat_part_co_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_2_2_prt_sub1" for table "stat_part_co_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_2_2_prt_sub2" for table "stat_part_co_t3_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_3_2_prt_subothers" for table "stat_part_co_t3_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_3_2_prt_sub1" for table "stat_part_co_t3_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t3_1_prt_3_2_prt_sub2" for table "stat_part_co_t3_1_prt_3"
Insert into stat_part_co_t3 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_co_t3;
select  count(*) from pg_class where relname like 'stat_part_co_t3';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_co_t3 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_part_co_t3';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap4 cascade;
ERROR:  schema "stat_heap4" does not exist
create schema stat_heap4;
set search_path=stat_heap4,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_heap_t4;
NOTICE:  table "stat_heap_t4" does not exist, skipping
Create table stat_heap_t4 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i);
Insert into stat_heap_t4 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_heap_t4;
select  count(*) from pg_class where relname like 'stat_heap_t4%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_heap_t4 set distributed randomly;
 
select  count(*) from pg_class where relname like 'stat_heap_t4%';
 count 
-------
     1
(1 row)

Alter table stat_heap_t4 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_heap_t4%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t4;
NOTICE:  table "stat_part_heap_t4" does not exist, skipping
Create table stat_part_heap_t4 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed by (i)  partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_others" for table "stat_part_heap_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_2" for table "stat_part_heap_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_3" for table "stat_part_heap_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_others_2_prt_subothers" for table "stat_part_heap_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_others_2_prt_sub1" for table "stat_part_heap_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_others_2_prt_sub2" for table "stat_part_heap_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_2_2_prt_subothers" for table "stat_part_heap_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_2_2_prt_sub1" for table "stat_part_heap_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_2_2_prt_sub2" for table "stat_part_heap_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_3_2_prt_subothers" for table "stat_part_heap_t4_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_3_2_prt_sub1" for table "stat_part_heap_t4_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t4_1_prt_3_2_prt_sub2" for table "stat_part_heap_t4_1_prt_3"
Insert into stat_part_heap_t4 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_heap_t4;
select  count(*) from pg_class where relname like 'stat_part_heap_t4';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_heap_t4 set distributed randomly;
select  count(*) from pg_class where relname like 'stat_part_heap_t4';
 count 
-------
     1
(1 row)

Alter table stat_part_heap_t4 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_part_heap_t4';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_ao4 cascade;
ERROR:  schema "stat_ao4" does not exist
create schema stat_ao4;
set search_path=stat_ao4,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_ao_t4;
NOTICE:  table "stat_ao_t4" does not exist, skipping
Create table stat_ao_t4 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5) distributed by (i) ;
Insert into stat_ao_t4 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_ao_t4;
select  count(*) from pg_class where relname like 'stat_ao_t4%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_ao_t4 set distributed randomly;
select  count(*) from pg_class where relname like 'stat_ao_t4%';
 count 
-------
     1
(1 row)

Alter table stat_ao_t4 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_ao_t4%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_ao_t4;
NOTICE:  table "stat_part_ao_t4" does not exist, skipping
Create table stat_part_ao_t4 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5) distributed by (i) partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_others" for table "stat_part_ao_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_2" for table "stat_part_ao_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_3" for table "stat_part_ao_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_others_2_prt_subothers" for table "stat_part_ao_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_others_2_prt_sub1" for table "stat_part_ao_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_others_2_prt_sub2" for table "stat_part_ao_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_2_2_prt_subothers" for table "stat_part_ao_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_2_2_prt_sub1" for table "stat_part_ao_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_2_2_prt_sub2" for table "stat_part_ao_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_3_2_prt_subothers" for table "stat_part_ao_t4_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_3_2_prt_sub1" for table "stat_part_ao_t4_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t4_1_prt_3_2_prt_sub2" for table "stat_part_ao_t4_1_prt_3"
Insert into stat_part_ao_t4 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_ao_t4;
select  count(*) from pg_class where relname like 'stat_part_ao_t4';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_ao_t4 set distributed randomly;
select  count(*) from pg_class where relname like 'stat_part_ao_t4';
 count 
-------
     1
(1 row)

Alter table stat_part_ao_t4 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_part_ao_t4';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_co4 cascade;
ERROR:  schema "stat_co4" does not exist
create schema stat_co4;
set search_path=stat_co4,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_co_t4;
NOTICE:  table "stat_co_t4" does not exist, skipping
Create table stat_co_t4 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) ;
Insert into stat_co_t4 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_co_t4;
select  count(*) from pg_class where relname like 'stat_co_t4%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_co_t4 set distributed randomly;
select  count(*) from pg_class where relname like 'stat_co_t4%';
 count 
-------
     1
(1 row)

Alter table stat_co_t4 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_co_t4%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_co_t4;
NOTICE:  table "stat_part_co_t4" does not exist, skipping
Create table stat_part_co_t4 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_others" for table "stat_part_co_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_2" for table "stat_part_co_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_3" for table "stat_part_co_t4"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_others_2_prt_subothers" for table "stat_part_co_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_others_2_prt_sub1" for table "stat_part_co_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_others_2_prt_sub2" for table "stat_part_co_t4_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_2_2_prt_subothers" for table "stat_part_co_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_2_2_prt_sub1" for table "stat_part_co_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_2_2_prt_sub2" for table "stat_part_co_t4_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_3_2_prt_subothers" for table "stat_part_co_t4_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_3_2_prt_sub1" for table "stat_part_co_t4_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t4_1_prt_3_2_prt_sub2" for table "stat_part_co_t4_1_prt_3"
Insert into stat_part_co_t4 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_co_t4;
select  count(*) from pg_class where relname like 'stat_part_co_t4';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_co_t4 set distributed randomly;
select  count(*) from pg_class where relname like 'stat_part_co_t4';
 count 
-------
     1
(1 row)

Alter table stat_part_co_t4 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_part_co_t4';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap5 cascade;
ERROR:  schema "stat_heap5" does not exist
create schema stat_heap5;
set search_path=stat_heap5,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_heap_t5;
NOTICE:  table "stat_heap_t5" does not exist, skipping
Create table stat_heap_t5 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed randomly;
Insert into stat_heap_t5 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_heap_t5;
select  count(*) from pg_class where relname like 'stat_heap_t5%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_heap_t5 set distributed by (j);
 
select  count(*) from pg_class where relname like 'stat_heap_t5%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t5;
NOTICE:  table "stat_part_heap_t5" does not exist, skipping
Create table stat_part_heap_t5 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed randomly  partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_others" for table "stat_part_heap_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_2" for table "stat_part_heap_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_3" for table "stat_part_heap_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_others_2_prt_subothers" for table "stat_part_heap_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_others_2_prt_sub1" for table "stat_part_heap_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_others_2_prt_sub2" for table "stat_part_heap_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_2_2_prt_subothers" for table "stat_part_heap_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_2_2_prt_sub1" for table "stat_part_heap_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_2_2_prt_sub2" for table "stat_part_heap_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_3_2_prt_subothers" for table "stat_part_heap_t5_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_3_2_prt_sub1" for table "stat_part_heap_t5_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t5_1_prt_3_2_prt_sub2" for table "stat_part_heap_t5_1_prt_3"
Insert into stat_part_heap_t5 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_heap_t5;
select  count(*) from pg_class where relname like 'stat_part_heap_t5';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_heap_t5 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_part_heap_t5';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_ao5 cascade;
ERROR:  schema "stat_ao5" does not exist
create schema stat_ao5;
set search_path=stat_ao5,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_ao_t5;
NOTICE:  table "stat_ao_t5" does not exist, skipping
Create table stat_ao_t5 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5) distributed randomly ;
Insert into stat_ao_t5 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_ao_t5;
select  count(*) from pg_class where relname like 'stat_ao_t5%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_ao_t5 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_ao_t5%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_ao_t5;
NOTICE:  table "stat_part_ao_t5" does not exist, skipping
Create table stat_part_ao_t5 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5) distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_others" for table "stat_part_ao_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_2" for table "stat_part_ao_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_3" for table "stat_part_ao_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_others_2_prt_subothers" for table "stat_part_ao_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_others_2_prt_sub1" for table "stat_part_ao_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_others_2_prt_sub2" for table "stat_part_ao_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_2_2_prt_subothers" for table "stat_part_ao_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_2_2_prt_sub1" for table "stat_part_ao_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_2_2_prt_sub2" for table "stat_part_ao_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_3_2_prt_subothers" for table "stat_part_ao_t5_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_3_2_prt_sub1" for table "stat_part_ao_t5_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t5_1_prt_3_2_prt_sub2" for table "stat_part_ao_t5_1_prt_3"
Insert into stat_part_ao_t5 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_ao_t5;
select  count(*) from pg_class where relname like 'stat_part_ao_t5';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_ao_t5 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_part_ao_t5';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_co5 cascade;
ERROR:  schema "stat_co5" does not exist
create schema stat_co5;
set search_path=stat_co5,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_co_t5;
NOTICE:  table "stat_co_t5" does not exist, skipping
Create table stat_co_t5 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5, orientation=column) distributed randomly;
Insert into stat_co_t5 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_co_t5;
select  count(*) from pg_class where relname like 'stat_co_t5%';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_co_t5 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_co_t5%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_co_t5;
NOTICE:  table "stat_part_co_t5" does not exist, skipping
Create table stat_part_co_t5 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5, orientation=column) distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_others" for table "stat_part_co_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_2" for table "stat_part_co_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_3" for table "stat_part_co_t5"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_others_2_prt_subothers" for table "stat_part_co_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_others_2_prt_sub1" for table "stat_part_co_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_others_2_prt_sub2" for table "stat_part_co_t5_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_2_2_prt_subothers" for table "stat_part_co_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_2_2_prt_sub1" for table "stat_part_co_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_2_2_prt_sub2" for table "stat_part_co_t5_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_3_2_prt_subothers" for table "stat_part_co_t5_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_3_2_prt_sub1" for table "stat_part_co_t5_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t5_1_prt_3_2_prt_sub2" for table "stat_part_co_t5_1_prt_3"
Insert into stat_part_co_t5 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_co_t5;
select  count(*) from pg_class where relname like 'stat_part_co_t5';
 count 
-------
     1
(1 row)

-- Alter distribution
Alter table stat_part_co_t5 set distributed by (j);
select  count(*) from pg_class where relname like 'stat_part_co_t5';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap6 cascade;
ERROR:  schema "stat_heap6" does not exist
create schema stat_heap6;
set search_path=stat_heap6,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_heap_t6;
NOTICE:  table "stat_heap_t6" does not exist, skipping
Create table stat_heap_t6 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i);
Insert into stat_heap_t6 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_heap_t6;
select  count(*) from pg_class where relname like 'stat_heap_t6%';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = true
Alter table stat_heap_t6 set with (reorganize=true);
 
select  count(*) from pg_class where relname like 'stat_heap_t6%';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = false
Alter table stat_heap_t6 set with (reorganize=false);
select  count(*) from pg_class where relname like 'stat_heap_t6%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t6;
NOTICE:  table "stat_part_heap_t6" does not exist, skipping
Create table stat_part_heap_t6 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed by (i)  partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_others" for table "stat_part_heap_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_2" for table "stat_part_heap_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_3" for table "stat_part_heap_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_others_2_prt_subothers" for table "stat_part_heap_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_others_2_prt_sub1" for table "stat_part_heap_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_others_2_prt_sub2" for table "stat_part_heap_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_2_2_prt_subothers" for table "stat_part_heap_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_2_2_prt_sub1" for table "stat_part_heap_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_2_2_prt_sub2" for table "stat_part_heap_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_3_2_prt_subothers" for table "stat_part_heap_t6_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_3_2_prt_sub1" for table "stat_part_heap_t6_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t6_1_prt_3_2_prt_sub2" for table "stat_part_heap_t6_1_prt_3"
Insert into stat_part_heap_t6 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Create index stat_part_idx_heap_t6 on stat_part_heap_t6(d);
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_2"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_others"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_3"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_2_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_2_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_2_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_others_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_others_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_others_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_3_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_3_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t6_1_prt_3_2_prt_sub2"
Analyze stat_part_heap_t6;
select  count(*) from pg_class where relname like 'stat_part_heap_t6';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = true
Alter table stat_part_heap_t6 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_part_heap_t6';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = false
Alter table stat_part_heap_t6 set with (reorganize=false);
select  count(*) from pg_class where relname like 'stat_part_heap_t6';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_ao6 cascade;
ERROR:  schema "stat_ao6" does not exist
create schema stat_ao6;
set search_path=stat_ao6,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_ao_t6;
NOTICE:  table "stat_ao_t6" does not exist, skipping
Create table stat_ao_t6 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5) distributed by (i) ;
Insert into stat_ao_t6 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_ao_t6;
select  count(*) from pg_class where relname like 'stat_ao_t6%';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = true
Alter table stat_ao_t6 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_ao_t6%';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = false
Alter table stat_ao_t6 set with (reorganize=false);
select  count(*) from pg_class where relname like 'stat_ao_t6%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_ao_t6;
NOTICE:  table "stat_part_ao_t6" does not exist, skipping
Create table stat_part_ao_t6 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5) distributed by (i) partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_others" for table "stat_part_ao_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_2" for table "stat_part_ao_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_3" for table "stat_part_ao_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_others_2_prt_subothers" for table "stat_part_ao_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_others_2_prt_sub1" for table "stat_part_ao_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_others_2_prt_sub2" for table "stat_part_ao_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_2_2_prt_subothers" for table "stat_part_ao_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_2_2_prt_sub1" for table "stat_part_ao_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_2_2_prt_sub2" for table "stat_part_ao_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_3_2_prt_subothers" for table "stat_part_ao_t6_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_3_2_prt_sub1" for table "stat_part_ao_t6_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t6_1_prt_3_2_prt_sub2" for table "stat_part_ao_t6_1_prt_3"
Insert into stat_part_ao_t6 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_ao_t6;
select  count(*) from pg_class where relname like 'stat_part_ao_t6';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = true
Alter table stat_part_ao_t6 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_part_ao_t6';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = false
Alter table stat_part_ao_t6 set with (reorganize=false);
select  count(*) from pg_class where relname like 'stat_part_ao_t6';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_co6 cascade;
ERROR:  schema "stat_co6" does not exist
create schema stat_co6;
set search_path=stat_co6,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_co_t6;
NOTICE:  table "stat_co_t6" does not exist, skipping
Create table stat_co_t6 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) ;
Insert into stat_co_t6 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_co_t6;
select  count(*) from pg_class where relname like 'stat_co_t6%';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = true
Alter table stat_co_t6 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_co_t6%';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = false
Alter table stat_co_t6 set with (reorganize=false);
select  count(*) from pg_class where relname like 'stat_co_t6%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_co_t6;
NOTICE:  table "stat_part_co_t6" does not exist, skipping
Create table stat_part_co_t6 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_others" for table "stat_part_co_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_2" for table "stat_part_co_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_3" for table "stat_part_co_t6"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_others_2_prt_subothers" for table "stat_part_co_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_others_2_prt_sub1" for table "stat_part_co_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_others_2_prt_sub2" for table "stat_part_co_t6_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_2_2_prt_subothers" for table "stat_part_co_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_2_2_prt_sub1" for table "stat_part_co_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_2_2_prt_sub2" for table "stat_part_co_t6_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_3_2_prt_subothers" for table "stat_part_co_t6_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_3_2_prt_sub1" for table "stat_part_co_t6_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t6_1_prt_3_2_prt_sub2" for table "stat_part_co_t6_1_prt_3"
Insert into stat_part_co_t6 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_co_t6;
select  count(*) from pg_class where relname like 'stat_part_co_t6';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = true
Alter table stat_part_co_t6 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_part_co_t6';
 count 
-------
     1
(1 row)

-- Alter table to reorganize = false
Alter table stat_part_co_t6 set with (reorganize=true);
select  count(*) from pg_class where relname like 'stat_part_co_t6';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap7 cascade;
ERROR:  schema "stat_heap7" does not exist
create schema stat_heap7;
set search_path=stat_heap7,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_heap_t7;
NOTICE:  table "stat_heap_t7" does not exist, skipping
Create table stat_heap_t7 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i);
Insert into stat_heap_t7 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_heap_t7;
select  count(*) from pg_class where relname like 'stat_heap_t7%';
 count 
-------
     1
(1 row)

-- Alter table alter column type
Alter table stat_heap_t7 alter column c type varchar;
 
select  count(*) from pg_class where relname like 'stat_heap_t7%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t7;
NOTICE:  table "stat_part_heap_t7" does not exist, skipping
Create table stat_part_heap_t7 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_others" for table "stat_part_heap_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_2" for table "stat_part_heap_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_3" for table "stat_part_heap_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_others_2_prt_subothers" for table "stat_part_heap_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_others_2_prt_sub1" for table "stat_part_heap_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_others_2_prt_sub2" for table "stat_part_heap_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_2_2_prt_subothers" for table "stat_part_heap_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_2_2_prt_sub1" for table "stat_part_heap_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_2_2_prt_sub2" for table "stat_part_heap_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_3_2_prt_subothers" for table "stat_part_heap_t7_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_3_2_prt_sub1" for table "stat_part_heap_t7_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t7_1_prt_3_2_prt_sub2" for table "stat_part_heap_t7_1_prt_3"
Insert into stat_part_heap_t7 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_heap_t7;
select  count(*) from pg_class where relname like 'stat_part_heap_t7';
 count 
-------
     1
(1 row)

-- Alter table alter type of a column
Alter table stat_part_heap_t7 alter column j type numeric;
ERROR:  cannot alter type of a column used in a partitioning key
select  count(*) from pg_class where relname like 'stat_part_heap_t7';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_ao7 cascade;
ERROR:  schema "stat_ao7" does not exist
create schema stat_ao7;
set search_path=stat_ao7,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_ao_t7;
NOTICE:  table "stat_ao_t7" does not exist, skipping
Create table stat_ao_t7 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5) distributed by (i) ;
Insert into stat_ao_t7 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_ao_t7;
select  count(*) from pg_class where relname like 'stat_ao_t7%';
 count 
-------
     1
(1 row)

-- Alter table alter column type
Alter table stat_ao_t7 alter column j type numeric;
select  count(*) from pg_class where relname like 'stat_ao_t7%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_ao_t7;
NOTICE:  table "stat_part_ao_t7" does not exist, skipping
Create table stat_part_ao_t7 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5) distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_others" for table "stat_part_ao_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_2" for table "stat_part_ao_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_3" for table "stat_part_ao_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_others_2_prt_subothers" for table "stat_part_ao_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_others_2_prt_sub1" for table "stat_part_ao_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_others_2_prt_sub2" for table "stat_part_ao_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_2_2_prt_subothers" for table "stat_part_ao_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_2_2_prt_sub1" for table "stat_part_ao_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_2_2_prt_sub2" for table "stat_part_ao_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_3_2_prt_subothers" for table "stat_part_ao_t7_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_3_2_prt_sub1" for table "stat_part_ao_t7_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_ao_t7_1_prt_3_2_prt_sub2" for table "stat_part_ao_t7_1_prt_3"
Insert into stat_part_ao_t7 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_ao_t7;
select  count(*) from pg_class where relname like 'stat_part_ao_t7';
 count 
-------
     1
(1 row)

-- Alter table alter column type
Alter table stat_part_ao_t7 alter column c type varchar;
select  count(*) from pg_class where relname like 'stat_part_ao_t7';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_co7 cascade;
ERROR:  schema "stat_co7" does not exist
create schema stat_co7;
set search_path=stat_co7,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_co_t7;
NOTICE:  table "stat_co_t7" does not exist, skipping
Create table stat_co_t7 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,compresslevel=5, orientation=column) distributed by (i) ;
Insert into stat_co_t7 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_co_t7;
select  count(*) from pg_class where relname like 'stat_co_t7%';
 count 
-------
     1
(1 row)

-- Alter table alter type
Alter table stat_co_t7 alter column j type float;
select  count(*) from pg_class where relname like 'stat_co_t7%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_co_t7;
NOTICE:  table "stat_part_co_t7" does not exist, skipping
Create table stat_part_co_t7 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
with(appendonly=true,compresslevel=5, orientation=column) distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_others" for table "stat_part_co_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_2" for table "stat_part_co_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_3" for table "stat_part_co_t7"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_others_2_prt_subothers" for table "stat_part_co_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_others_2_prt_sub1" for table "stat_part_co_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_others_2_prt_sub2" for table "stat_part_co_t7_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_2_2_prt_subothers" for table "stat_part_co_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_2_2_prt_sub1" for table "stat_part_co_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_2_2_prt_sub2" for table "stat_part_co_t7_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_3_2_prt_subothers" for table "stat_part_co_t7_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_3_2_prt_sub1" for table "stat_part_co_t7_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_co_t7_1_prt_3_2_prt_sub2" for table "stat_part_co_t7_1_prt_3"
Insert into stat_part_co_t7 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_co_t7;
select  count(*) from pg_class where relname like 'stat_part_co_t7';
 count 
-------
     1
(1 row)

-- Alter table alter type
Alter table stat_part_co_t7 alter column i type numeric;
ERROR:  cannot alter type of a column used in a partitioning key
select  count(*) from pg_class where relname like 'stat_part_co_t7';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap8 cascade;
ERROR:  schema "stat_heap8" does not exist
create schema stat_heap8;
set search_path=stat_heap8,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_heap_t8;
NOTICE:  table "stat_heap_t8" does not exist, skipping
Create table stat_heap_t8 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i);
Insert into stat_heap_t8 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_heap_t8;
select  count(*) from pg_class where relname like 'stat_heap_t8%';
 count 
-------
     1
(1 row)

-- Create Index
Create index stat_idx_heap_t8 on stat_heap_t8(n);
-- Cluster on index
Cluster stat_idx_heap_t8 on stat_heap_t8;
select  count(*) from pg_class where relname like 'stat_heap_t8%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t8;
NOTICE:  table "stat_part_heap_t8" does not exist, skipping
Create table stat_part_heap_t8 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_others" for table "stat_part_heap_t8"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_2" for table "stat_part_heap_t8"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_3" for table "stat_part_heap_t8"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_others_2_prt_subothers" for table "stat_part_heap_t8_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_others_2_prt_sub1" for table "stat_part_heap_t8_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_others_2_prt_sub2" for table "stat_part_heap_t8_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_2_2_prt_subothers" for table "stat_part_heap_t8_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_2_2_prt_sub1" for table "stat_part_heap_t8_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_2_2_prt_sub2" for table "stat_part_heap_t8_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_3_2_prt_subothers" for table "stat_part_heap_t8_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_3_2_prt_sub1" for table "stat_part_heap_t8_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t8_1_prt_3_2_prt_sub2" for table "stat_part_heap_t8_1_prt_3"
Insert into stat_part_heap_t8 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_heap_t8;
select  count(*) from pg_class where relname like 'stat_part_heap_t8';
 count 
-------
     1
(1 row)

-- Create Index
Create index stat_part_idx_heap_t8 on stat_part_heap_t8(d);
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_2"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_others"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_3"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_2_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_2_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_2_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_others_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_others_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_others_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_3_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_3_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t8_1_prt_3_2_prt_sub2"
-- Cluster on index
Cluster stat_part_idx_heap_t8 on stat_part_heap_t8;
select  count(*) from pg_class where relname like 'stat_part_heap_t8';
 count 
-------
     1
(1 row)

\echo '-- start_ignore'
-- start_ignore
drop schema stat_heap9 cascade;
ERROR:  schema "stat_heap9" does not exist
create schema stat_heap9;
set search_path=stat_heap9,"$user",public;
\echo '-- end_ignore'
-- end_ignore
-- Regular Table
Drop table if exists stat_heap_t9;
NOTICE:  table "stat_heap_t9" does not exist, skipping
Create table stat_heap_t9 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i);
Insert into stat_heap_t9 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_heap_t9;
select  count(*) from pg_class where relname like 'stat_heap_t9%';
 count 
-------
     1
(1 row)

-- Create Index
Create index stat_idx_heap_t9 on stat_heap_t9(i);
-- Cluster on index
Cluster stat_idx_heap_t9 on stat_heap_t9;
select  count(*) from pg_class where relname like 'stat_heap_t9%';
 count 
-------
     1
(1 row)

Insert into stat_heap_t9 values(generate_series(1,10),500,'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
-- Cluster again 
Cluster stat_heap_t9;
select  count(*) from pg_class where relname like 'stat_heap_t9%';
 count 
-------
     1
(1 row)

-- Partiiton Table
Drop table if exists stat_part_heap_t9;
NOTICE:  table "stat_part_heap_t9" does not exist, skipping
Create table stat_part_heap_t9 (i int,j int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone)  
distributed randomly partition by range (i) 
subpartition by list (j) subpartition template 
(
default subpartition subothers,
subpartition sub1 values(1,2,3), 
subpartition sub2 values(4,5,6)
) 
(default partition others, start (0) inclusive end (10) exclusive every (5) );
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_others" for table "stat_part_heap_t9"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_2" for table "stat_part_heap_t9"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_3" for table "stat_part_heap_t9"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_others_2_prt_subothers" for table "stat_part_heap_t9_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_others_2_prt_sub1" for table "stat_part_heap_t9_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_others_2_prt_sub2" for table "stat_part_heap_t9_1_prt_others"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_2_2_prt_subothers" for table "stat_part_heap_t9_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_2_2_prt_sub1" for table "stat_part_heap_t9_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_2_2_prt_sub2" for table "stat_part_heap_t9_1_prt_2"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_3_2_prt_subothers" for table "stat_part_heap_t9_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_3_2_prt_sub1" for table "stat_part_heap_t9_1_prt_3"
NOTICE:  CREATE TABLE will create partition "stat_part_heap_t9_1_prt_3_2_prt_sub2" for table "stat_part_heap_t9_1_prt_3"
Insert into stat_part_heap_t9 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Analyze stat_part_heap_t9;
select  count(*) from pg_class where relname like 'stat_part_heap_t9';
 count 
-------
     1
(1 row)

-- Create Index
Create index stat_part_idx_heap_t9 on stat_part_heap_t9(j);
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_2"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_others"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_3"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_2_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_2_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_2_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_others_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_others_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_others_2_prt_sub2"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_3_2_prt_subothers"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_3_2_prt_sub1"
NOTICE:  building index for child partition "stat_part_heap_t9_1_prt_3_2_prt_sub2"
-- Cluster on index
Cluster stat_part_idx_heap_t9 on stat_part_heap_t9;
select  count(*) from pg_class where relname like 'stat_part_heap_t9';
 count 
-------
     1
(1 row)

Insert into stat_part_heap_t9 values(generate_series(1,10),generate_series(1,5),'table statistics should be kept after alter','s', 'regular table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
-- Cluster again
Cluster stat_part_heap_t9;
select  count(*) from pg_class where relname like 'stat_part_heap_t9';
 count 
-------
     1
(1 row)

